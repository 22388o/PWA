(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[13],{489:function(e,t,n){"use strict";n(3),n(499);var a=n(8);t.a=function(e){var t=e.tipCounter,n=e.tipValue,c=e.zoomed;return n>0?Object(a.jsxs)("div",{className:"ribbon-container",style:{opacity:c?0:1},children:[Object(a.jsx)("p",{className:"ribbon-title",children:"Total Tips"}),Object(a.jsxs)("p",{className:"ribbon-value",children:[t," ",1===t?"Tip":"Tips"]})]}):null}},494:function(e,t,n){"use strict";var a=n(3),c=n(78),r=n.n(c),i=(n(495),n(8));t.a=function(e){var t=e.pageTitle,n=e.drawerVisible,c=Object(a.useCallback)((function(){window.history.back()}),[]);return Object(i.jsxs)("div",{className:"dialog-nav-container",children:[Object(i.jsx)("div",{className:"dialog-nav-back",onClick:c,children:Object(i.jsx)("i",{className:"icon icon-thin-back"})}),Object(i.jsx)("p",{className:"dialog-nav-title",children:t}),Object(i.jsxs)("div",{className:r()({"dialog-nav-menu-btn":!0,"dialog-nav-hidden":!n}),children:[Object(i.jsx)("div",{className:"dialog-nav-menu-dash"}),Object(i.jsx)("div",{className:"dialog-nav-menu-dash"}),Object(i.jsx)("div",{className:"dialog-nav-menu-dash"})]})]})}},495:function(e,t,n){},499:function(e,t,n){},504:function(e,t,n){},512:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(19),c=n(2),r=n.n(c),i=n(6),o=n(0),s=n(21),l=n(537),u=n.n(l),d=n(566),p=n.n(d),b=function(){var e=Object(i.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,p.a._init){e.next=4;break}return e.next=4,new Promise((function(e,t){p.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),p.a.persist()})).then((function(n){n.persistent?e(n):t(n)}))}));case 4:return e.next=6,p.a.load(t);case 6:return n=e.sent,e.abrupt("return",n.createURL());case 10:return e.prev=10,e.t0=e.catch(0),console.warn(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),f=function(e,t){var n=document.querySelectorAll(t);return n&&n.length&&n.forEach((function(t){t.src||(t.src=e,t.muted=!0,t.autoplay=!0)})),!!(null===n||void 0===n?void 0:n.length)},j=function(e,t){return p.a.save(e,t)},m=function(e){var t=Promise.resolve();return e.forEach((function(e){t=t.then((function(){return e()}))})),t},v={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!0,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},h=function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(v).filter((function(e){var t=Object(s.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];if(c){var r=Object(s.a)(c,2),i=r[0],l=r[1];return Object(o.a)({name:i},l)}return null},O=new u.a,g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=e.map((function(e){var a=e.contentItems,c=e.id;return Object.entries(a).filter((function(e){var t=Object(s.a)(e,2),n=(t[0],t[1]);return v[n.type]})).map((function(e){var a=Object(s.a)(e,2),o=a[0],l=a[1];return function(){return new Promise((function(e){!O.get(l.magnetURI)||n?O.add(l.magnetURI,function(){var n=Object(i.a)(r.a.mark((function n(a){var u;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e(!0),(u=a.files.filter((function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(v).filter((function(e){var t=Object(s.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];return!!c&&Object(s.a)(c,2)[1].formats.includes(a)}))).map(function(){var e=Object(i.a)(r.a.mark((function e(n){var a,i,u,d,p,j;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=h(n)){e.next=3;break}return e.abrupt("return");case 3:return i="".concat(c,"-").concat(o,"-").concat(n.name),u=a.element,d="".concat(u,'[data-torrent="').concat(l.magnetURI,'"]'),e.next=8,b(i);case 8:if(!(p=e.sent)){e.next=14;break}return(j=O.get(l.magnetURI))&&j.destroy(),f(p,d),e.abrupt("return");case 14:document.querySelectorAll(d).forEach((function(e){var c=decodeURIComponent(l.magnetURI.replace(/.*(ws=)/gi,"")),r=a.formats.filter((function(e){return c.toLowerCase().endsWith(".".concat(e.toLowerCase()))})),i=Object(s.a)(r,1)[0],o=e.getAttribute("src");!t&&i||o?e.setAttribute("src",c):n.renderTo(e,a.options)}));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.on("done",(function(){u.map((function(e){var t=h(e),n="".concat(c,"-").concat(o,"-").concat(e.name),a=t.element,s="".concat(a,'[data-torrent="').concat(l.magnetURI,'"]');return e.getBlob(function(){var e=Object(i.a)(r.a.mark((function e(t,a){var c,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return console.warn(t),e.abrupt("return");case 3:return e.next=5,j(n,a);case 5:if("false"!==(null===(c=document.querySelector(s))||void 0===c?void 0:c.dataset.played)||(null===c||void 0===c?void 0:c.getAttribute("src"))){e.next=11;break}return e.next=9,b(n);case 9:i=e.sent,f(i,s);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e}))}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()):e(!0)}))}}))})).reduce((function(e,t){return[].concat(Object(a.a)(e),Object(a.a)(t))}),[]);m(c)}},518:function(e,t,n){},538:function(e,t){},540:function(e,t){},541:function(e,t){},542:function(e,t){},543:function(e,t){},545:function(e,t){},546:function(e,t){},547:function(e,t){},551:function(e,t){},552:function(e,t){},553:function(e,t){},554:function(e,t){},555:function(e,t){},556:function(e,t){},557:function(e,t){},558:function(e,t){},559:function(e,t){},560:function(e,t){},561:function(e,t){},562:function(e,t){},563:function(e,t){},564:function(e,t){},716:function(e,t,n){},717:function(e,t,n){},755:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),r=n(6),i=n(21),o=n(3),s=n(41),l=(n(504),n(156)),u=n(494),d=n(18),p=n(512),b=n(0),f=(n(489),n(518),n(716),n(8)),j=function(e){var t=e.id,n=e.item,a=e.index,c=e.postId,r=e.width,i=e.selected,s=e.updateSelection,l=decodeURIComponent(n.magnetURI.replace(/.*(ws=)/gi,"")),u={opacity:1};r&&(u.width=r);var d=Object(o.useCallback)((function(){i!==t&&s(t)}),[t,s]);return Object(f.jsxs)("div",{className:"media-container",onClick:d,style:{position:"relative"},children:[Object(f.jsx)("img",{className:"torrent-img torrent-img-".concat(c,"-").concat(t),alt:"Post Media","data-torrent":n.magnetURI,"data-file-key":a,style:u,src:l}),i===t&&Object(f.jsx)("div",{style:Object(b.a)(Object(b.a)({},u),{},{opacity:1,position:"absolute",top:0,backgroundColor:"rgb(255,255,255,0.2)",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),children:Object(f.jsx)("i",{class:"far fa-check-circle fa-3x",style:{opacity:1}})})]})},m=(n(717),function(e){var t=e.id,n=e.item,a=e.index,c=e.postId,r=e.width,i=e.selected,s=e.updateSelection,l=decodeURIComponent(n.magnetURI.replace(/.*(ws=)/gi,"")),u={};r&&(u.width=r);var d=Object(o.useCallback)((function(){i!==t&&s(t)}),[t,s]);return Object(f.jsxs)("div",{className:"media-container",style:{position:"relative"},children:[Object(f.jsx)("div",{className:"video-container",style:{cursor:"pointer"},children:Object(f.jsx)("video",{style:u,className:"torrent-video torrent-video-".concat(c,"-").concat(t),"data-torrent":n.magnetURI,"data-file-key":a,controls:!0,"data-played":"false",src:l})}),Object(f.jsx)("div",{onClick:d,style:Object(b.a)(Object(b.a)({},u),{},{opacity:i===t?1:0,position:"absolute",top:0,backgroundColor:"rgb(255,255,255,0.2)",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),children:Object(f.jsx)("i",{class:"far fa-check-circle fa-3x",style:{opacity:1}})})]})}),v=n(26);t.default=function(){Object(s.c)();var e=Object(v.g)(),t=Object(s.d)((function(e){return e.content.publishedContent})),n=Object(s.d)((function(e){return e.node.avatar})),a=Object(o.useState)(!1),b=Object(i.a)(a,2),h=b[0],O=b[1],g=Object(o.useState)(null),x=Object(i.a)(g,2),y=x[0],w=x[1],k=Object(o.useState)(""),C=Object(i.a)(k,2),I=C[0],N=C[1],S=Object(o.useState)("public"),R=Object(i.a)(S,2),U=R[0],T=R[1],P=Object(o.useState)(!1),A=Object(i.a)(P,2),E=A[0],L=(A[1],Object(o.useState)("")),q=Object(i.a)(L,2),W=q[0],D=q[1],M=(Object(o.useMemo)((function(){Object(p.a)([{id:"content",contentItems:t}])}),[t]),Object(o.useCallback)(function(){var n=Object(r.a)(c.a.mark((function n(a){var r,i,o,s;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a.preventDefault(),console.log("submitting"),""!==W||""!==I){n.next=5;break}return w("at least one paragraph or one media is required"),n.abrupt("return");case 5:return O(!0),r=[],""!==I&&r.push({type:"text/paragraph",text:I}),i="private"===U,""!==W&&(o=t[W])&&r.push({type:o.type,width:o.width,height:o.height,magnetURI:o.magnetURI,isPreview:E,isPrivate:i}),n.prev=10,n.next=13,d.a.post("/api/gun/wall",{tags:[],title:"Post",contentItems:r});case 13:200===n.sent.status?(console.log("post created successfully"),O(!1),e.push("/profile")):(w("invalid response status"),O(!1)),n.next=22;break;case 17:n.prev=17,n.t0=n.catch(10),console.log(n.t0),w(null!==(s=null===n.t0||void 0===n.t0?void 0:n.t0.errorMessage)&&void 0!==s?s:null===n.t0||void 0===n.t0?void 0:n.t0.message),O(!1);case 22:case"end":return n.stop()}}),n,null,[[10,17]])})));return function(e){return n.apply(this,arguments)}}(),[W,I,t,E,U,e,O,w])),V=Object(o.useCallback)(function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),w(null),N("");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),z=Object(o.useCallback)((function(e){var t=e.target,n=t.value;switch(t.name){case"paragraph":return void N(n);case"postType":return console.log(n),void T(n);default:return}}),[N]);Object(o.useCallback)((function(e){e.preventDefault(),D(e.target.getAttribute("propid"))}),[W,D]);return console.log(W),Object(f.jsxs)("div",{className:"publish-content-form-container m-1",children:[h?Object(f.jsx)(l.a,{overlay:!0,fullScreen:!0,text:"Unlocking Wallet..."}):null,Object(f.jsx)(u.a,{drawerVisible:!1,pageTitle:"CREATE POST"}),Object(f.jsxs)("form",{className:"publish-content-form",onSubmit:M,onReset:V,children:[Object(f.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:[Object(f.jsx)("div",{className:"profile-avatar",style:{backgroundImage:"url(".concat(n,")")}}),Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{children:"Say Something"}),Object(f.jsx)("div",{className:"line"})]}),Object(f.jsx)("div",{style:{width:"122px"}})]}),Object(f.jsx)("textarea",{className:"input-field",name:"paragraph",value:I,onChange:z,placeholder:"What's up?",rows:4}),Object(f.jsxs)("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center"},children:[Object(f.jsxs)("strong",{children:["Audience: ",Object(f.jsx)("i",{className:"fas ".concat("public"===U?"fa-globe-europe":"fa-credit-card")})]}),Object(f.jsxs)("select",{name:"postType",id:"postType",onChange:z,style:{appearance:"none",backgroundColor:"rgba(0,0,0,0)",color:"var(--main-blue)",marginLeft:"0.3rem"},children:[Object(f.jsx)("option",{value:"public",style:{backgroundColor:"rgba(0,0,0,0)",color:"var(--main-blue)"},children:"Public"}),Object(f.jsx)("option",{value:"private",children:"Paywall"})]})]}),Object(f.jsx)("div",{style:{display:"flex",alignItems:"center",overflow:"auto",whiteSpace:"nowrap"},children:Object.entries(t).map((function(e,t){var n=Object(i.a)(e,2),a=n[0],c=n[1];return"image/embedded"===c.type?Object(f.jsx)("div",{style:{width:100,margin:"1em"},children:Object(f.jsx)(j,{id:a,item:c,index:t,postId:"content",width:"100px",selected:W,updateSelection:D},"".concat(t))}):"video/embedded"===c.type?Object(f.jsx)("div",{style:{width:100},children:Object(f.jsx)(m,{id:a,item:c,index:t,postId:"content",width:"100px",selected:W,updateSelection:D},"".concat(t))}):null}))}),y?Object(f.jsx)("p",{className:"error-container",children:y}):null,Object(f.jsxs)("div",{className:"flex-center",children:[Object(f.jsx)("input",{type:"reset",value:"reset",className:"shock-form-button m-1"}),Object(f.jsx)("input",{type:"submit",value:"submit",className:"shock-form-button-confirm m-1"})]})]})]})}}}]);
//# sourceMappingURL=13.f1da753b.chunk.js.map