(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[26],{533:function(e,t,n){"use strict";t.a=n.p+"static/media/bitcoin-lightning.2d73b74b.svg"},577:function(e,t,n){"use strict";var c=n(3),r=c.useLayoutEffect;t.a=function(e){var t=Object(c.useRef)(e);return r((function(){t.current=e})),t}},632:function(e,t,n){},633:function(e,t,n){},752:function(e,t,n){"use strict";n.r(t);var c=n(2),r=n.n(c),a=n(6),i=n(21),s=n(3),o=n(26),u=n(41),l=n(15),d=n(32),b=n(577),h=function(e,t){"function"!==typeof e?e.current=t:e(t)},p=function(e,t){var n=Object(s.useRef)();return Object(s.useCallback)((function(c){e.current=c,n.current&&h(n.current,null),n.current=t,t&&h(t,c)}),[t])},j={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},f=function(e){Object.keys(j).forEach((function(t){e.style.setProperty(t,j[t],"important")}))},m=null;var v=function(){},g=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width"],O=!!document.documentElement.currentStyle,x=function(e,t){var n=e.cacheMeasurements,c=e.maxRows,r=e.minRows,a=e.onChange,i=void 0===a?v:a,o=e.onHeightChange,u=void 0===o?v:o,h=Object(d.a)(e,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]);var j=void 0!==h.value,x=Object(s.useRef)(null),y=p(x,t),S=Object(s.useRef)(0),w=Object(s.useRef)(),N=function(){var e=x.current,t=n&&w.current?w.current:function(e){var t=window.getComputedStyle(e);if(null===t)return null;var n,c=(n=t,g.reduce((function(e,t){return e[t]=n[t],e}),{})),r=c.boxSizing;return""===r?null:(O&&"border-box"===r&&(c.width=parseFloat(c.width)+parseFloat(c.borderRightWidth)+parseFloat(c.borderLeftWidth)+parseFloat(c.paddingRight)+parseFloat(c.paddingLeft)+"px"),{sizingStyle:c,paddingSize:parseFloat(c.paddingBottom)+parseFloat(c.paddingTop),borderSize:parseFloat(c.borderBottomWidth)+parseFloat(c.borderTopWidth)})}(e);if(t){w.current=t;var a=function(e,t,n,c){void 0===n&&(n=1),void 0===c&&(c=1/0),m||((m=document.createElement("textarea")).setAttribute("tab-index","-1"),m.setAttribute("aria-hidden","true"),f(m)),null===m.parentNode&&document.body.appendChild(m);var r=e.paddingSize,a=e.borderSize,i=e.sizingStyle,s=i.boxSizing;Object.keys(i).forEach((function(e){var t=e;m.style[t]=i[t]})),f(m),m.value=t;var o=function(e,t){var n=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?n+t.borderSize:n-t.paddingSize}(m,e);m.value="x";var u=m.scrollHeight-r,l=u*n;"border-box"===s&&(l=l+r+a),o=Math.max(l,o);var d=u*c;return"border-box"===s&&(d=d+r+a),[o=Math.min(d,o),u]}(t,e.value||e.placeholder||"x",r,c),i=a[0],s=a[1];S.current!==i&&(S.current=i,e.style.setProperty("height",i+"px","important"),u(i,{rowHeight:s}))}};return Object(s.useLayoutEffect)(N),function(e){var t=Object(b.a)(e);Object(s.useLayoutEffect)((function(){var e=function(e){t.current(e)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[])}(N),Object(s.createElement)("textarea",Object(l.a)({},h,{onChange:function(e){j||N(),i(e)},ref:y}))},y=Object(s.forwardRef)(x),S=n(515),w=n(78),N=n.n(w),R=n(119),z=n(24),k=n(500),C=n(509),E=n(510),F=(n(632),n(8)),K=function(e){var t=e.text,n=void 0===t?"":t,c=e.receivedMessage,r=void 0!==c&&c,a=e.publicKey,i=void 0===a?"":a,s=e.timestamp;return Object(F.jsxs)("div",{className:N()({"chat-message":!0,"chat-message-received":r}),children:[r&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(C.a,{height:48,publicKey:i}),Object(F.jsx)(k.a,{amt:16,insideRow:!0})]}),Object(F.jsx)("p",{className:"chat-message-text",children:n}),function(){try{var e=z.h(s),t=R.DateTime.fromMillis(e).toRelative();return Object(F.jsx)("div",{className:N()(E.m),children:Object(F.jsx)("p",{children:t})})}catch(n){return console.log(n),null}}()]})},L=n(28),W=n(533),M=(n(633),n(25)),H=n(16);t.default=function(){var e=Object(u.c)(),t=Object(o.i)().publicKey,n=M.useSelector(M.selectUser(t)),c=Object(s.useState)(""),l=Object(i.a)(c,2),d=l[0],b=l[1],h=M.useSelector((function(e){return e.chat.messages[t]})),p=M.useSelector((function(e){var n=e.chat;return Object(H.b)(n.contacts,t)})),j=M.useSelector((function(e){var n=e.chat;return Object(H.b)(n.sentRequests,t)})),f=M.useSelector((function(e){var n=e.chat;return Object(H.b)(n.receivedRequests,t)})),m=M.useSelector((function(e){return e.node.publicKey})),v=!p&&j,g=!p&&f,O=Object(s.useCallback)((function(e){b(e.target.value)}),[]),x=Object(s.useCallback)((function(){console.log(f),f&&Object(L.b)(f.id)(e)}),[f,e]),w=Object(s.useCallback)((function(n){if("Enter"!==n.key||!n.ctrlKey)return"Enter"===n.key?(n.preventDefault(),e(Object(L.g)({message:d,publicKey:t})),void b("")):void 0;b(d+"\r\n")}),[d,t,e]),N=Object(s.useCallback)((function(){var n=e(Object(L.h)(m,t));return Object(a.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:null===(t=e.sent)||void 0===t||t.close();case 4:case"end":return e.stop()}}),e)})))}),[e,m,t]);Object(s.useEffect)((function(){var e=N();return function(){e()}}),[N]);var R=n.displayName;return Object(F.jsxs)("div",{className:"page-container chat-page",children:[Object(F.jsx)(S.a,{solid:!0,pageTitle:R,enableBackButton:!0}),Object(F.jsx)("div",{className:"chat-messages-container",children:null===h||void 0===h?void 0:h.map((function(e){return Object(F.jsx)(K,{text:e.body,receivedMessage:!e.outgoing,publicKey:e.recipientPublicKey})}))}),g?Object(F.jsxs)("div",{className:"chat-permission-bar",children:[Object(F.jsxs)("p",{className:"chat-permission-bar-title unselectable",children:[R," has sent you a chat request!"]}),Object(F.jsxs)("p",{className:"chat-permission-bar-text",children:["Once you accept the request, you'll be able to chat and send invoices to ",R]}),Object(F.jsxs)("div",{className:"chat-permission-bar-actions unselectable",children:[Object(F.jsx)("div",{className:"chat-permission-bar-action chat-permission-bar-action-accept",onClick:x,children:"Accept"}),Object(F.jsx)("div",{className:"chat-permission-bar-action chat-permission-bar-action-decline",children:"Decline"})]})]}):v?Object(F.jsxs)("div",{className:"chat-permission-bar",children:[Object(F.jsxs)("p",{className:"chat-permission-bar-title",children:["Your request has been sent to ",R," successfully"]}),Object(F.jsxs)("p",{className:"chat-permission-bar-text unselectable",children:["Once ",R," accepts the request, you'll be able to chat with them"]})]}):Object(F.jsx)("div",{className:"chat-bottom-bar",children:Object(F.jsxs)("div",{className:"chat-input-container",children:[Object(F.jsx)("div",{className:"chat-input-btn unselectable",children:Object(F.jsx)("img",{src:W.a,alt:"Menu"})}),Object(F.jsx)(y,{className:"chat-input",type:"text",enterKeyHint:"send",onKeyPress:w,onChange:O,value:d,height:20})]})})]})}}}]);
//# sourceMappingURL=26.3b7fee6a.chunk.js.map