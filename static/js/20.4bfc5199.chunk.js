(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[20],{635:function(n,t,e){"use strict";e.d(t,"a",(function(){return j}));var r=e(27),c=e(3),a=e.n(c),o=e(6),u=e(2),i=e(17),s=e(646),f=e.n(s),l=e(675),p=e.n(l),d=function(){var n=Object(o.a)(a.a.mark((function n(t){var e;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,p.a._init){n.next=4;break}return n.next=4,new Promise((function(n,t){p.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),p.a.persist()})).then((function(e){e.persistent?n(e):t(e)}))}));case 4:return n.next=6,p.a.load(t);case 6:return e=n.sent,n.abrupt("return",e.createURL());case 10:return n.prev=10,n.t0=n.catch(0),console.warn(n.t0),n.abrupt("return",!1);case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(t){return n.apply(this,arguments)}}(),v=function(n,t){var e=document.querySelectorAll(t);return e&&e.length&&e.forEach((function(t){t.src||(t.src=n,t.muted=!0,t.autoplay=!0)})),!!(null===e||void 0===e?void 0:e.length)},m=function(n,t){return p.a.save(n,t)},b=function(n){var t=Promise.resolve();return n.forEach((function(n){t=t.then((function(){return n()}))})),t},h={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!0,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},g=function(n){var t,e,r=null===(t=n.name)||void 0===t||null===(e=t.split("."))||void 0===e?void 0:e.slice(-1)[0],c=Object.entries(h).filter((function(n){var t=Object(i.a)(n,2);t[0];return t[1].formats.includes(r)}))[0];if(c){var a=Object(i.a)(c,2),o=a[0],s=a[1];return Object(u.a)({name:o},s)}return null},w=new f.a,j=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=n.map((function(n){var r=n.contentItems,c=n.id;return Object.entries(null!==r&&void 0!==r?r:{}).filter((function(n){var t=Object(i.a)(n,2),e=(t[0],t[1]);return h[e.type]})).map((function(n){var r=Object(i.a)(n,2),u=r[0],s=r[1];return function(){return new Promise((function(n){!w.get(s.magnetURI)||e?w.add(s.magnetURI,function(){var e=Object(o.a)(a.a.mark((function e(r){var f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(!0),(f=r.files.filter((function(n){var t,e,r=null===(t=n.name)||void 0===t||null===(e=t.split("."))||void 0===e?void 0:e.slice(-1)[0],c=Object.entries(h).filter((function(n){var t=Object(i.a)(n,2);t[0];return t[1].formats.includes(r)}))[0];return!!c&&Object(i.a)(c,2)[1].formats.includes(r)}))).map(function(){var n=Object(o.a)(a.a.mark((function n(e){var r,o,f,l,p,m;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=g(e)){n.next=3;break}return n.abrupt("return");case 3:return o="".concat(c,"-").concat(u,"-").concat(e.name),f=r.element,l="".concat(f,'[data-torrent="').concat(s.magnetURI,'"]'),n.next=8,d(o);case 8:if(!(p=n.sent)){n.next=14;break}return(m=w.get(s.magnetURI))&&m.destroy(),v(p,l),n.abrupt("return");case 14:document.querySelectorAll(l).forEach((function(n){var c=decodeURIComponent(s.magnetURI.replace(/.*(ws=)/gi,"")),a=r.formats.filter((function(n){return c.toLowerCase().endsWith(".".concat(n.toLowerCase()))})),o=Object(i.a)(a,1)[0],u=n.getAttribute("src");!t&&o||u?n.setAttribute("src",c):e.renderTo(n,r.options)}));case 16:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()),r.on("done",(function(){f.map((function(n){var t=g(n),e="".concat(c,"-").concat(u,"-").concat(n.name),r=t.element,i="".concat(r,'[data-torrent="').concat(s.magnetURI,'"]');return n.getBlob(function(){var n=Object(o.a)(a.a.mark((function n(t,r){var c,o;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=3;break}return console.warn(t),n.abrupt("return");case 3:return n.next=5,m(e,r);case 5:if("false"!==(null===(c=document.querySelector(i))||void 0===c?void 0:c.dataset.played)||(null===c||void 0===c?void 0:c.getAttribute("src"))){n.next=11;break}return n.next=9,d(e);case 9:o=n.sent,v(o,i);case 11:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()),n}))}));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()):n(!0)}))}}))})).reduce((function(n,t){return[].concat(Object(r.a)(n),Object(r.a)(t))}),[]);b(c)}},647:function(n,t){},649:function(n,t){},650:function(n,t){},651:function(n,t){},652:function(n,t){},654:function(n,t){},655:function(n,t){},656:function(n,t){},660:function(n,t){},661:function(n,t){},662:function(n,t){},663:function(n,t){},664:function(n,t){},665:function(n,t){},666:function(n,t){},667:function(n,t){},668:function(n,t){},669:function(n,t){},670:function(n,t){},671:function(n,t){},672:function(n,t){},673:function(n,t){}}]);
//# sourceMappingURL=20.4bfc5199.chunk.js.map