(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[13],{483:function(e,t,n){"use strict";var a=n(3),c=n(72),o=n.n(c),r=(n(489),n(7)),s=function(e){var t=e.children,n=e.style;return Object(r.jsx)("div",{className:"modal-content",style:n,children:t})},i=(n(490),function(e){var t=e.title,n=e.toggleModal;return t?Object(r.jsxs)("div",{className:"modal-head",children:[Object(r.jsx)("p",{className:"modal-head-title",children:t}),Object(r.jsx)("div",{className:"modal-head-close",onClick:n,children:Object(r.jsx)("i",{className:"fas fa-times"})})]}):null});n(491),t.a=function(e){var t=e.modalOpen,n=void 0!==t&&t,c=e.toggleModal,l=e.modalTitle,u=void 0===l?"":l,d=e.children,b=e.contentStyle,f=void 0===b?{}:b,j=Object(a.useCallback)((function(){c()}),[c]);return Object(r.jsxs)("div",{className:o()({modal:!0,"modal-open":n}),children:[Object(r.jsx)("div",{className:"modal-backdrop",onClick:j}),Object(r.jsxs)("div",{className:"modal-container",children:[Object(r.jsx)(i,{title:u,toggleModal:j}),Object(r.jsx)(s,{style:f,children:d})]})]})}},489:function(e,t,n){},490:function(e,t,n){},491:function(e,t,n){},492:function(e,t,n){"use strict";var a=n(26),c=n(72),o=n.n(c),r=(n(494),n(7));t.a=function(e){var t=e.label,n=e.name,c=e.onChange,s=e.inputAction,i=e.actionIcon,l=e.value,u=e.inputMode,d=void 0===u?"text":u,b=e.type,f=void 0===b?"text":b,j=e.element,m=void 0===j?"input":j,p=e.small,v=void 0!==p&&p,O=e.disabled;return Object(r.jsxs)("div",{className:o()({group:!0,"group-disabled":O,"group-small":v}),children:[t?Object(r.jsx)("p",{className:"group-label",children:t}):null,Object(r.jsxs)("div",{className:o()({"group-input-container":!0,"group-input-textarea-container":"textarea"===m}),children:["textarea"===m?Object(r.jsx)("textarea",{className:"group-input group-input-textarea",name:n,onChange:c,inputMode:d,value:l,disabled:O}):Object(r.jsx)("input",{className:"group-input",type:f,name:n,onChange:c,inputMode:d,value:l,disabled:O}),s&&i?Object(r.jsx)("div",{className:"group-input-action",onClick:s,children:Object(r.jsx)("i",{className:o()(Object(a.a)({"group-input-action-icon":!0,fas:!0},i,!0)),onClick:s})}):null]})]})}},494:function(e,t,n){},496:function(e,t,n){"use strict";var a=n(52),c=n(7);t.a=function(){return Object(c.jsxs)("div",{className:"bottom-nav-container",children:[Object(c.jsx)(a.c,{className:"bottom-nav-btn",to:"/overview",activeClassName:"active-nav-btn",children:Object(c.jsx)("i",{className:"bottom-nav-btn-icon icon-thin-wallet"})}),Object(c.jsx)(a.c,{className:"bottom-nav-btn",to:"/chat",activeClassName:"active-nav-btn",children:Object(c.jsx)("i",{className:"bottom-nav-btn-icon icon-thin-chat"})}),Object(c.jsx)(a.c,{className:"bottom-nav-btn",to:"/profile",activeClassName:"active-nav-btn",children:Object(c.jsx)("i",{className:"bottom-nav-btn-icon icon-thin-profile"})}),Object(c.jsx)(a.c,{className:"bottom-nav-btn",to:"/feed",activeClassName:"active-nav-btn",children:Object(c.jsx)("i",{className:"bottom-nav-btn-icon icon-thin-feed"})})]})}},507:function(e,t,n){"use strict";n(3),n(562);var a=n(7);t.a=function(e){var t=e.text,n=void 0===t?"Submit":t,c=e.onClick;return Object(a.jsx)("div",{className:"modal-submit-btn",onClick:c,children:Object(a.jsx)("p",{className:"modal-submit-btn-text",children:n})})}},508:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(21),c=n(2),o=n.n(c),r=n(6),s=n(0),i=n(16),l=n(531),u=n.n(l),d=n(560),b=n.n(d),f=function(){var e=Object(r.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,b.a._init){e.next=4;break}return e.next=4,new Promise((function(e,t){b.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),b.a.persist()})).then((function(n){n.persistent?e(n):t(n)}))}));case 4:return e.next=6,b.a.load(t);case 6:return n=e.sent,e.abrupt("return",n.createURL());case 10:return e.prev=10,e.t0=e.catch(0),console.warn(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),j=function(e,t){var n=document.querySelectorAll(t);return n&&n.length&&n.forEach((function(t){t.src||(t.src=e,t.muted=!0,t.autoplay=!0)})),!!(null===n||void 0===n?void 0:n.length)},m=function(e,t){return b.a.save(e,t)},p=function(e){var t=Promise.resolve();return e.forEach((function(e){t=t.then((function(){return e()}))})),t},v={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!0,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},O=function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(v).filter((function(e){var t=Object(i.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];if(c){var o=Object(i.a)(c,2),r=o[0],l=o[1];return Object(s.a)({name:r},l)}return null},h=new u.a,x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=e.map((function(e){var a=e.contentItems,c=e.id;return Object.entries(a).filter((function(e){var t=Object(i.a)(e,2),n=(t[0],t[1]);return v[n.type]})).map((function(e){var a=Object(i.a)(e,2),s=a[0],l=a[1];return function(){return new Promise((function(e){!h.get(l.magnetURI)||n?h.add(l.magnetURI,function(){var n=Object(r.a)(o.a.mark((function n(a){var u;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e(!0),(u=a.files.filter((function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(v).filter((function(e){var t=Object(i.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];return!!c&&Object(i.a)(c,2)[1].formats.includes(a)}))).map(function(){var e=Object(r.a)(o.a.mark((function e(n){var a,r,u,d,b,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=O(n)){e.next=3;break}return e.abrupt("return");case 3:return r="".concat(c,"-").concat(s,"-").concat(n.name),u=a.element,d="".concat(u,'[data-torrent="').concat(l.magnetURI,'"]'),e.next=8,f(r);case 8:if(!(b=e.sent)){e.next=14;break}return(m=h.get(l.magnetURI))&&m.destroy(),j(b,d),e.abrupt("return");case 14:document.querySelectorAll(d).forEach((function(e){var c=decodeURIComponent(l.magnetURI.replace(/.*(ws=)/gi,"")),o=a.formats.filter((function(e){return c.toLowerCase().endsWith(".".concat(e.toLowerCase()))})),r=Object(i.a)(o,1)[0],s=e.getAttribute("src");!t&&r||s?e.setAttribute("src",c):n.renderTo(e,a.options)}));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.on("done",(function(){u.map((function(e){var t=O(e),n="".concat(c,"-").concat(s,"-").concat(e.name),a=t.element,i="".concat(a,'[data-torrent="').concat(l.magnetURI,'"]');return e.getBlob(function(){var e=Object(r.a)(o.a.mark((function e(t,a){var c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return console.warn(t),e.abrupt("return");case 3:return e.next=5,m(n,a);case 5:if("false"!==(null===(c=document.querySelector(i))||void 0===c?void 0:c.dataset.played)||(null===c||void 0===c?void 0:c.getAttribute("src"))){e.next=11;break}return e.next=9,f(n);case 9:r=e.sent,j(r,i);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e}))}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()):e(!0)}))}}))})).reduce((function(e,t){return[].concat(Object(a.a)(e),Object(a.a)(t))}),[]);p(c)}},532:function(e,t){},534:function(e,t){},535:function(e,t){},536:function(e,t){},537:function(e,t){},539:function(e,t){},540:function(e,t){},541:function(e,t){},545:function(e,t){},546:function(e,t){},547:function(e,t){},548:function(e,t){},549:function(e,t){},550:function(e,t){},551:function(e,t){},552:function(e,t){},553:function(e,t){},554:function(e,t){},555:function(e,t){},556:function(e,t){},557:function(e,t){},558:function(e,t){},561:function(e,t,n){"use strict";var a=n(2),c=n.n(a),o=n(6),r=n(16),s=n(3),i=n(40),l=n(483),u=n(507),d=n(492),b=n(49),f=n(150),j=(n(563),n(7));t.a=function(e){var t=e.tipData,n=e.toggleOpen,a=Object(i.b)(),m=Object(s.useState)(""),p=Object(r.a)(m,2),v=p[0],O=p[1],h=Object(s.useState)(!1),x=Object(r.a)(h,2),g=x[0],N=x[1],k=Object(s.useState)(0),w=Object(r.a)(k,2),y=w[0],S=w[1],C=Object(s.useState)(!1),I=Object(r.a)(C,2),M=I[0],P=I[1],U=Object(s.useCallback)((function(e){"amount"===e.target.name&&S(e.target.value)}),[]),D=Object(s.useCallback)(function(){var e=Object(o.a)(c.a.mark((function e(n){var o,r,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,N(!0),e.next=5,a(Object(b.c)({amount:y,publicKey:t.publicKey,postId:t.postID}));case 5:P(!0),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0),t&&(s=e.t0.message,i=null===(o=e.t0.response)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.errorMessage,O(null!==i&&void 0!==i?i:s));case 12:return e.prev=12,N(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})));return function(t){return e.apply(this,arguments)}}(),[a,y,t]);return Object(s.useEffect)((function(){t||(N(!1),O(null),P(!1))}),[t]),Object(j.jsx)(l.a,{toggleModal:n,modalOpen:!!t,modalTitle:"Send Tip",children:M?Object(j.jsxs)("div",{className:"tip-modal-success",children:[Object(j.jsx)("i",{className:"tip-success-icon fas fa-check-circle"}),Object(j.jsx)("p",{className:"tip-success-title",children:"Post tipped successfully!"}),Object(j.jsx)("p",{className:"tip-success-desc"})]}):Object(j.jsxs)("form",{className:"modal-form tip-form",onSubmit:D,children:[v?Object(j.jsx)("div",{className:"form-error",children:v}):null,g?Object(j.jsx)(f.a,{overlay:!0,text:"Sending Tip..."}):null,Object(j.jsx)("p",{className:"tip-modal-desc",children:"Please specify the amount of sats you'd like to tip this user with below."}),Object(j.jsx)(d.a,{name:"amount",onChange:U,value:y,inputMode:"decimal",small:!0}),Object(j.jsx)(u.a,{text:"SEND TIP",onClick:D})]})})}},562:function(e,t,n){},563:function(e,t,n){},564:function(e,t,n){"use strict";var a=n(2),c=n.n(a),o=n(6),r=n(16),s=n(3),i=n(40),l=n(483),u=n(507),d=n(39),b=n(150),f=(n(565),n(7));t.a=function(e){var t=e.unlockData,n=e.toggleOpen,a=Object(i.b)(),j=Object(s.useState)(""),m=Object(r.a)(j,2),p=m[0],v=m[1],O=Object(s.useState)(!1),h=Object(r.a)(O,2),x=h[0],g=h[1],N=Object(s.useState)(!1),k=Object(r.a)(N,2),w=k[0],y=k[1],S=Object(s.useCallback)(function(){var e=Object(o.a)(c.a.mark((function e(n){var o,r,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,g(!0),e.next=5,Object(d.j)(100,t.publicKey,t.postID)(a);case 5:y(!0),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0),t&&(s=e.t0.message,i=null===(o=e.t0.response)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.errorMessage,v(null!==i&&void 0!==i?i:s));case 12:return e.prev=12,g(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})));return function(t){return e.apply(this,arguments)}}(),[a,t]);return Object(s.useEffect)((function(){t||(g(!1),v(null),y(!1))}),[t]),Object(f.jsx)(l.a,{toggleModal:n,modalOpen:!!t,modalTitle:"Unlock content",children:w?Object(f.jsxs)("div",{className:"tip-modal-success",children:[Object(f.jsx)("i",{className:"tip-success-icon fas fa-check-circle"}),Object(f.jsx)("p",{className:"tip-success-title",children:"Content unlocked successfully!"})]}):Object(f.jsxs)("form",{className:"modal-form tip-form",onSubmit:S,children:[p?Object(f.jsx)("div",{className:"form-error",children:p}):null,x?Object(f.jsx)(b.a,{overlay:!0,text:"Sending Tip..."}):null,Object(f.jsx)("p",{className:"tip-modal-desc",children:"100 sats will be sent to the owner of the post to unlock the content"}),Object(f.jsx)(u.a,{text:"UNLOCK",onClick:S})]})})}},565:function(e,t,n){},717:function(e,t,n){},718:function(e,t,n){},766:function(e,t,n){"use strict";n.r(t);var a=n(21),c=n(16),o=n(3),r=n.n(o),s=n(25),i=n(91),l=n(508),u=n(18),d=n(496),b=n(72),f=n.n(b),j=(n(717),n(7)),m=function(e){var t=e.username,n=e.avatar,a=e.addButton,c=void 0!==a&&a,o=e.large,r=void 0!==o&&o,s=e.main,i=void 0!==s&&s;return Object(j.jsxs)("div",{className:f()({"followed-user":!0,"followed-user-large":r,"followed-user-main":i}),children:[Object(j.jsx)("div",{className:"followed-user-avatar",style:{backgroundImage:"url(".concat(n,")")},children:c?Object(j.jsx)("div",{className:"user-add-btn",children:Object(j.jsx)("i",{className:"fas fa-plus"})}):null}),t?Object(j.jsx)("p",{className:"followed-user-name",children:t}):null]})},p=n(561),v=n(150),O=n(55),h=(n(718),n(564)),x=n(40),g=n(49),N=n(48),k=n(20),w=r.a.lazy((function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,522))})),y=r.a.lazy((function(){return Promise.all([n.e(0),n.e(22)]).then(n.bind(null,749))}));t.default=function(){var e=Object(x.b)(),t=u.useSelector(u.selectFollows);Object(o.useEffect)((function(){console.info("follows in feed just updated:"),console.info(t)}),[t]);var n=u.useSelector((function(e){return e.feed.posts}));Object(o.useEffect)((function(){console.info("posts in feed just updated:"),console.info(n)}),[n]);var r=u.useSelector((function(e){return e.userProfiles}));Object(o.useEffect)((function(){console.info("userProfiles in feed just updated:"),console.info(r)}),[r]);var b=Object(o.useState)(null),f=Object(c.a)(b,2),S=f[0],C=f[1],I=Object(o.useState)(null),M=Object(c.a)(I,2),P=M[0],U=M[1],D=u.useSelector(u.selectSelfUser).avatar,E=Object(o.useMemo)((function(){return n?Object.values(n).reduce((function(e,t){return[].concat(Object(a.a)(e),Object(a.a)(t))}),[]).filter((function(e){return Object(O.b)(e)?!!t.find((function(t){return t.user===e.sharerId})):!!t.find((function(t){return t.user===e.authorId}))})).sort((function(e,t){var n=Object(O.b)(e)?e.shareDate:e.date;return(Object(O.b)(t)?t.shareDate:t.date)-n})):[]}),[t,n]),T=Object(o.useCallback)((function(e){console.log(e),!S&&e||C(null),C(e)}),[S]),R=Object(o.useCallback)((function(e){console.log(e),!P&&e||U(null),U(e)}),[P]);return Object(o.useLayoutEffect)((function(){Object(l.a)(E.filter((function(e){return"post"===e.type})),!1)}),[E]),Object(o.useEffect)((function(){var n=t.map((function(t){var n=e(Object(N.b)(t.user)),a=e(Object(g.e)(t.user)),c=e(Object(g.d)(t.user));return function(){n(),Object(k.f)(a,c)()}}));return function(){n.map((function(e){return e()}))}}),[t,e]),Object(j.jsxs)("div",{className:"page-container feed-page",children:[Object(j.jsxs)("div",{className:"following-bar-container",children:[Object(j.jsx)(m,{addButton:!0,large:!0,main:!0,avatar:D?"data:image/jpeg;base64,".concat(D):null,username:null}),Object(j.jsx)("div",{className:"following-bar-list",children:null===t||void 0===t?void 0:t.map((function(e){var t,n=e.user,a=null!==(t=r[n])&&void 0!==t?t:s.e(n);return console.log(n),console.log(a.displayName),Object(j.jsx)(m,{username:Object(i.c)(n,a.displayName),avatar:"data:image/jpeg;base64,".concat(a.avatar)},n)}))})]}),Object(j.jsxs)("div",{className:"tabs-holder",children:[Object(j.jsx)("p",{className:"tab active",children:"Feed"}),Object(j.jsx)("p",{className:"tab",children:"Saved"}),Object(j.jsx)("p",{className:"tab",children:"Videos"})]}),Object(j.jsx)("div",{className:"posts-holder",children:E.map((function(e,t){if("shared"===e.type){var n=r[e.sharerId]||s.e(e.sharerId),a=e.originalAuthor,c=r[a]||s.e(a);return Object(j.jsx)(o.Suspense,{fallback:Object(j.jsx)(v.a,{}),children:Object(j.jsx)(y,{originalPost:e.originalPost,originalPostProfile:c,sharedTimestamp:e.shareDate,sharerProfile:n,postPublicKey:a,openTipModal:T,openUnlockModal:R})},t)}var l=r[e.authorId]||s.e(e.authorId);return Object(j.jsx)(o.Suspense,{fallback:Object(j.jsx)(v.a,{}),children:Object(j.jsx)(w,{id:e.id,timestamp:e.date,contentItems:e.contentItems,avatar:"data:image/jpeg;base64,".concat(null===l||void 0===l?void 0:l.avatar),username:Object(i.c)(null===l||void 0===l?void 0:l.publicKey,null===l||void 0===l?void 0:l.displayName),publicKey:e.authorId,openTipModal:T,openUnlockModal:R,tipCounter:void 0,tipValue:void 0})},t)}))}),Object(j.jsx)(p.a,{tipData:S,toggleOpen:T}),Object(j.jsx)(h.a,{unlockData:P,toggleOpen:R}),Object(j.jsx)(d.a,{})]})}}}]);
//# sourceMappingURL=13.f60e7f99.chunk.js.map