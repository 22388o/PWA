(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[22],{434:function(e,t,a){"use strict";var n=a(3),c=a(72),r=a.n(c),s=(a(436),a(7)),o=function(e){var t=e.children,a=e.style;return Object(s.jsx)("div",{className:"content",style:a,"data-v-40a9975a":"",children:t})},i=(a(437),function(e){var t=e.title,a=e.toggleModal;return t?Object(s.jsxs)("div",{className:"head","data-v-2ed500c9":"",children:[Object(s.jsx)("p",{className:"head-title","data-v-2ed500c9":"",children:t}),Object(s.jsx)("div",{className:"head-close",onClick:a,"data-v-2ed500c9":"",children:Object(s.jsx)("i",{className:"fas fa-times","data-v-2ed500c9":""})})]}):null});a(438),t.a=function(e){var t=e.modalOpen,a=void 0!==t&&t,c=e.toggleModal,l=e.modalTitle,d=void 0===l?"":l,u=e.children,b=e.contentStyle,v=void 0===b?{}:b,j=Object(n.useCallback)((function(){c()}),[c]);return Object(s.jsxs)("div",{className:r()({modal:!0,open:a}),"data-v-f13c32fb":"",children:[Object(s.jsx)("div",{className:"backdrop",onClick:j,"data-v-f13c32fb":""}),Object(s.jsxs)("div",{className:"container","data-v-f13c32fb":"",children:[Object(s.jsx)(i,{title:d,toggleModal:j,"data-v-f13c32fb":""}),Object(s.jsx)(o,{style:v,"data-v-f13c32fb":"",children:u})]})]})}},436:function(e,t,a){},437:function(e,t,a){},438:function(e,t,a){},439:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(3),c=a(72),r=a.n(c),s=a(88),o=(a(440),a(7)),i=73,l={minHeight:i};t.b=function(e){var t=e.pageTitle,a=e.drawerVisible,c=void 0!==a&&a,i=e.onHeight,d=void 0===i?s.a:i,u=Object(n.useCallback)((function(){window.history.back()}),[]),b=Object(n.useCallback)((function(e){if(e)try{d(e.getBoundingClientRect().height)}catch(t){console.log("Error inside onHeight mechanism in DialogNav:"),console.log(t)}}),[d]);return Object(o.jsxs)("div",{className:"dialog-nav-container",ref:b,style:l,"data-v-fd5e0786":"",children:[Object(o.jsx)("div",{className:"dialog-nav-back",onClick:u,"data-v-fd5e0786":"",children:Object(o.jsx)("i",{className:"icon icon-thin-back","data-v-fd5e0786":""})}),Object(o.jsx)("p",{className:"dialog-nav-title","data-v-fd5e0786":"",children:t}),Object(o.jsxs)("div",{className:r()({"dialog-nav-menu-btn":!0,"dialog-nav-hidden":!c}),"data-v-fd5e0786":"",children:[Object(o.jsx)("div",{className:"dialog-nav-menu-dash","data-v-fd5e0786":""}),Object(o.jsx)("div",{className:"dialog-nav-menu-dash","data-v-fd5e0786":""}),Object(o.jsx)("div",{className:"dialog-nav-menu-dash","data-v-fd5e0786":""})]})]})}},440:function(e,t,a){},515:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(0),c=a(2),r=a.n(c),s=a(6),o=a(14),i=function(){var e=Object(s.a)(r.a.mark((function e(t,a){var n,c,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Uint8Array(32),window.crypto.getRandomValues(n),c=Array.prototype.map.call(n,(function(e){return("00"+e.toString(16)).slice(-2)})).join(""),s={seed_token:a,wallet_token:c},e.next=6,fetch("".concat(t,"/api/enroll_token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});case 6:if(200===e.sent.status){e.next=9;break}throw new Error("torrentSeed service currently not available");case 9:return e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),l=function(){var e=Object(s.a)(r.a.mark((function e(t){var a,c,s,l,d,u,b,v,j,f,p,h,m,O,x;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.availableTokens,c=t.seedUrl,s=t.seedToken,l=t.seedProviderPub,d=t.serviceID,u=t.servicePrice,b=null,v=!1,j=null,e.t0=r.a.keys(a);case 5:if((e.t1=e.t0()).done){e.next=14;break}if(f=e.t1.value,!Object.prototype.hasOwnProperty.call(a,f)){e.next=12;break}if(!(p=a[f])[0]){e.next=12;break}return j={seedUrl:f,tokens:p},e.abrupt("break",14);case 12:e.next=5;break;case 14:if(console.log(l),console.log(d),console.log(u),!c||!s){e.next=27;break}return console.log("USING SELF SEED TOKEN"),e.next=21,i(c,s);case 21:h=e.sent,console.log("token"),console.log(h),b={seedUrl:c,tokens:[h]},e.next=48;break;case 27:if(!j){e.next=33;break}console.log("USING AVAILABLE TOKEN"),b=j,v=!0,e.next=48;break;case 33:if(!(l&&d&&u)){e.next=47;break}return console.log("USING DEFAULT TOKEN PROVIDER"),e.next=37,o.a.post("/api/lnd/unifiedTrx",{type:"service",amt:u,to:l,memo:"",feeLimit:500,ackInfo:d});case 37:if(m=e.sent,O=m.data,200===m.status){e.next=42;break}throw new Error("seed token request failed");case 42:console.log(O),x=O.orderAck,b=JSON.parse(x.response),e.next=48;break;case 47:throw new Error("provide the token data or use default seed provider");case 48:return e.abrupt("return",Object(n.a)(Object(n.a)({},b),{},{deleteToken:v}));case 49:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},666:function(e,t,a){},703:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a.n(n),r=a(6),s=a(16),o=a(3),i=a(40),l=(a(666),a(145)),d=a(439),u=a(14),b=a(39),v=a(515),j=a(22),f=a(18),p=a(434),h=a(7);t.default=function(){var e=Object(i.b)(),t=Object(j.g)(),a=f.useSelector((function(e){return e.content.seedProviderPub})),n=f.useSelector((function(e){return e.content.seedInfo})),m=n.seedUrl,O=n.seedToken,x=f.useSelector((function(e){return e.content.availableTokens})),g=f.useSelector((function(e){return e.userProfiles})),k=Object(o.useState)(null),y=Object(s.a)(k,2),N=y[0],w=y[1],S=Object(o.useState)(!1),C=Object(s.a)(S,2),P=C[0],T=C[1],I=Object(o.useState)([]),D=Object(s.a)(I,2),E=D[0],U=D[1],A=Object(o.useState)(""),L=Object(s.a)(A,2),R=L[0],F=L[1],B=Object(o.useState)(""),H=Object(s.a)(B,2),M=H[0],V=H[1],J=Object(o.useState)("public"),W=Object(s.a)(J,2),_=W[0],G=W[1],K=Object(o.useState)(!1),q=Object(s.a)(K,2),z=(q[0],q[1]),Q=Object(o.useRef)(null),X=Object(o.useRef)(null),Y=Object(o.useState)(null),Z=Object(s.a)(Y,2),$=Z[0],ee=Z[1],te=Object(o.useState)([]),ae=Object(s.a)(te,2),ne=ae[0],ce=ae[1],re=Object(o.useCallback)(function(){var n=Object(r.a)(c.a.mark((function n(r,o){var i,l,d,u,j,f,p,h,g,k,y,N,S,C,P,I;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log([R,M,ne]),0!==ne.length){n.next=4;break}return w("no selected files"),n.abrupt("return");case 4:return T(!0),n.prev=5,n.next=8,Object(v.a)({availableTokens:x,seedProviderPub:a,seedToken:O,seedUrl:m,serviceID:o,servicePrice:r});case 8:return i=n.sent,l=i.seedUrl,d=i.tokens,u=i.deleteToken,j=new FormData,Array.from(ne).forEach((function(e){return j.append("files",e)})),j.append("info","extraInfo"),j.append("comment","comment"),n.next=18,fetch("".concat(l,"/api/put_file"),{method:"POST",headers:{Authorization:"Bearer ".concat(d[0])},body:j});case 18:return f=n.sent,n.next=21,f.json();case 21:if(p=n.sent,console.log(p),!p.error||!p.error.message){n.next=28;break}return"The provided token has already been used"===(h=p.error.message)?(w("An error occurred, please try again"),Object(b.g)(l,d[0])(e)):w(h),T(!1),n.abrupt("return");case 28:return g=p.data.torrent,k=g.magnet,y=Object(s.a)(E,1),N=y[0],console.log(N),S="image/embedded","video"===N.type&&(S="video/embedded"),C={type:S,magnetURI:k,width:0,height:0},n.next=37,Object(b.c)(C)(e);case 37:P=n.sent,console.log("content publish complete"),console.log(P),T(!1),u&&Object(b.g)(l,d[0])(e),t.push("/profile"),n.next=50;break;case 45:n.prev=45,n.t0=n.catch(5),console.log(n.t0),w(null!==(I=null===n.t0||void 0===n.t0?void 0:n.t0.errorMessage)&&void 0!==I?I:null===n.t0||void 0===n.t0?void 0:n.t0.message),T(!1);case 50:case"end":return n.stop()}}),n,null,[[5,45]])})));return function(e,t){return n.apply(this,arguments)}}(),[R,M,ne,E,x,m,O,t,e,w]),se=Object(o.useCallback)((function(){ee(null)}),[ee]),oe=Object(o.useCallback)((function(){var e=$.servicePrice,t=$.serviceID;re(e,t),ee(null)}),[$,re,ee]),ie=Object(o.useCallback)(function(){var e=Object(r.a)(c.a.mark((function e(t){var n,r,s,o,i,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=!1,e.t0=c.a.keys(x);case 3:if((e.t1=e.t0()).done){e.next=12;break}if(r=e.t1.value,!Object.prototype.hasOwnProperty.call(x,r)){e.next=10;break}if(!x[r][0]){e.next=10;break}return n=!0,e.abrupt("break",12);case 10:e.next=3;break;case 12:if(s="",g[a]&&(s=g[a].SeedServiceProvided),!(n||m&&O)){e.next=18;break}re(),e.next=29;break;case 18:if(!s||!a){e.next=28;break}return e.next=21,u.a.get("/api/gun/otheruser/".concat(a,"/load/offeredServices>").concat(s));case 21:o=e.sent,i=o.data,l=i.data.servicePrice,console.log(i),ee({servicePrice:l,serviceID:s}),e.next=29;break;case 28:w("No way found to publish content");case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[x,ee,w,re]),le=Object(o.useCallback)(function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),F(""),V(""),w(null),ee(null),ce([]),U([]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[V,F,w,ee,ce,U]),de=Object(o.useCallback)((function(e){var t=e.target,a=t.value,n=t.name;t.checked;switch(n){case"title":return void F(a);case"description":return void V(a);case"postType":return void G(a);case"createPost":return void console.log("create post");default:return}}),[F,V,z]),ue=Object(o.useCallback)((function(e){e.preventDefault(),console.log(e.target.files),ce(e.target.files);var t=Array.from(e.target.files).map((function(e,t){return console.log("doing file..."),new Promise((function(a){var n=e.type,c=new FileReader;c.onload=function(e){n.startsWith("image/")&&a({type:"image",uri:e.target.result,index:t}),n.startsWith("video/")&&a({type:"video",uri:e.target.result,index:t})},c.readAsDataURL(e)}))}));Promise.allSettled(t).then((function(e){var t=[];e.forEach((function(e){"fulfilled"===e.status&&t.push(e.value)})),console.log(t),U(t)}))}),[ce,U]),be=Object(o.useCallback)((function(e){e.preventDefault(),Q.current.click()}),[Q]),ve=Object(o.useCallback)((function(e){e.preventDefault(),X.current.click()}),[X]);return Object(h.jsxs)("div",{className:"publish-content-form-container m-1","data-v-97a8edec":"",children:[P?Object(h.jsx)(l.a,{overlay:!0,fullScreen:!0,text:"Creating content...","data-v-97a8edec":""}):null,Object(h.jsx)(d.b,{drawerVisible:!1,pageTitle:"PUBLISH CONTENT","data-v-97a8edec":""}),Object(h.jsxs)("form",{className:"publish-content-form",onSubmit:ie,onReset:le,"data-v-97a8edec":"",children:[Object(h.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},"data-v-97a8edec":"",children:Object(h.jsxs)("h2",{"data-v-97a8edec":"",children:["Say Something",Object(h.jsx)("div",{className:"line","data-v-97a8edec":""})]})}),Object(h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},"data-v-97a8edec":"",children:[Object(h.jsx)("div",{className:"publish-content-title","data-v-97a8edec":"",children:Object(h.jsx)("label",{htmlFor:"title","data-v-97a8edec":"",children:Object(h.jsx)("strong",{"data-v-97a8edec":"",children:"Title"})})}),Object(h.jsxs)("div",{"data-v-97a8edec":"",children:[Object(h.jsxs)("strong",{"data-v-97a8edec":"",children:["Audience:"," ",Object(h.jsx)("i",{className:"fas ".concat("public"===_?"fa-globe-europe":"fa-credit-card"),"data-v-97a8edec":""})]}),Object(h.jsxs)("select",{name:"postType",id:"postType",onChange:de,style:{appearance:"none",backgroundColor:"rgba(0,0,0,0)",color:"var(--main-blue)",marginLeft:"0.3rem"},"data-v-97a8edec":"",children:[Object(h.jsx)("option",{value:"public",style:{backgroundColor:"rgba(0,0,0,0)",color:"var(--main-blue)"},"data-v-97a8edec":"",children:"Public"}),Object(h.jsx)("option",{value:"private","data-v-97a8edec":"",children:"Paywall"})]})]})]}),Object(h.jsx)("input",{type:"text",name:"title",placeholder:"How I monetized my content with ShockWallet",value:R,onChange:de,className:"input-field","data-v-97a8edec":""}),Object(h.jsx)("div",{className:"publish-content-title","data-v-97a8edec":"",children:Object(h.jsx)("label",{htmlFor:"contents","data-v-97a8edec":"",children:Object(h.jsx)("strong",{"data-v-97a8edec":"",children:"Contents"})})}),Object(h.jsxs)("div",{className:"m-b-1","data-v-97a8edec":"",children:[Object(h.jsx)("input",{type:"file",id:"file",ref:Q,style:{display:"none"},accept:"image/*",multiple:!0,onChange:ue,"data-v-97a8edec":""}),Object(h.jsx)("input",{type:"file",id:"file",ref:X,style:{display:"none"},accept:"video/*",multiple:!0,onChange:ue,"data-v-97a8edec":""}),Object(h.jsx)("i",{className:"fas fa-images publish-content-icon",onClick:be,"data-v-97a8edec":""}),Object(h.jsx)("i",{className:"fas fa-video publish-content-icon",onClick:ve,"data-v-97a8edec":""}),Object(h.jsx)("div",{"data-v-97a8edec":"",children:E.length>0&&E.map((function(e){return"image"===e.type?Object(h.jsx)("img",{src:e.uri,width:100,className:"m-1","data-v-97a8edec":""},e.index.toString()):"video"===e.type?Object(h.jsx)("video",{src:e.uri,controls:!0,width:100,className:"m-1","data-v-97a8edec":""},e.index.toString()):void 0}))})]}),Object(h.jsx)("div",{className:"publish-content-title","data-v-97a8edec":"",children:Object(h.jsx)("label",{htmlFor:"description","data-v-97a8edec":"",children:Object(h.jsx)("strong",{"data-v-97a8edec":"",children:"Description"})})}),Object(h.jsx)("textarea",{name:"description",placeholder:"I made a quick video to show you guys how easy it is to run your own social platform on ShockWallet, and start earning Bitcoin",rows:3,value:M,onChange:de,className:"input-field","data-v-97a8edec":""}),Object(h.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:"auto"},"data-v-97a8edec":"",children:[Object(h.jsx)("label",{htmlFor:"createPost","data-v-97a8edec":"",children:"Create Post/Teaser?"}),Object(h.jsx)("input",{type:"checkbox",name:"createPost",style:{marginLeft:"0.2em"},"data-v-97a8edec":""})]}),N?Object(h.jsx)("p",{className:"error-container","data-v-97a8edec":"",children:N}):null,Object(h.jsxs)("div",{className:"flex-center","data-v-97a8edec":"",children:[Object(h.jsx)("input",{type:"reset",value:"reset",className:"shock-form-button m-1","data-v-97a8edec":""}),Object(h.jsx)("input",{type:"submit",value:"submit",className:"shock-form-button-confirm m-1","data-v-97a8edec":""})]})]}),$&&Object(h.jsx)(p.a,{modalOpen:$&&!P,toggleModal:se,"data-v-97a8edec":"",children:Object(h.jsxs)("div",{style:{padding:"1rem"},"data-v-97a8edec":"",children:[Object(h.jsxs)("p",{"data-v-97a8edec":"",children:["The service from the default service provider will cost:"," ",Object(h.jsxs)("strong",{"data-v-97a8edec":"",children:[$.servicePrice," sats"]})]}),Object(h.jsx)("button",{className:"shock-form-button m-1",onClick:le,"data-v-97a8edec":"",children:"cancel"}),Object(h.jsx)("button",{className:"shock-form-button-confirm m-1",onClick:oe,"data-v-97a8edec":"",children:"confirm"})]})})]})}}}]);
//# sourceMappingURL=22.b185dede.chunk.js.map