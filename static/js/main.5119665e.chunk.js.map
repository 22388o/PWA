{"version":3,"sources":["actions/OrdersActions.js","common/Loader/index.js","utils/Http.js","common/Post/components/TipRibbon/index.js","common/Post/components/Stream/index.tsx","reducers/NodeReducer.js","reducers/AuthReducer.js","reducers/WalletReducer.js","reducers/ChatReducer.js","reducers/DrawerReducer.js","reducers/ContentReducer.ts","reducers/FeesReducer.js","reducers/FeedReducer.js","reducers/EncryptionReducer.js","reducers/UserProfilesReducer.js","reducers/OrdersReducer.js","reducers/index.ts","store/Migrations/index.js","store/Migrations/PeerMigration.js","store/selectors/auth.ts","store/selectors/users.ts","store/selectors/follows.ts","store/selectors/publishedContent.ts","store/selectors/index.ts","store/index.ts","utils/WebSocket.js","actions/AuthActions.ts","actions/ChatActions.js","actions/ContentActions.ts","actions/WalletActions.js","utils/JSON.ts","utils/Encryption.ts","actions/NodeActions.js","utils/Date.ts","utils/index.ts","common/Drawer/index.js","App.js","utils/ui.tsx","serviceWorkerRegistration.js","reportWebVitals.js","index.js","actions/UserProfilesActions.ts","actions/FeedActions.js","schema/index.ts","utils/FieldError.ts","utils/Error.ts","actions/EncryptionActions.js","actions/DrawerActions.js","actions/FeesActions.js","utils/Gun.js","utils/String.js"],"names":["ACTIONS","ADD_MY_SERVICE","REMOVE_MY_SERVICE","ADD_BOUGHT_SERVICE","createService","clear","encrypted","serviceID","dispatch","a","id","Http","post","path","value","data","ok","newID","all","Object","entries","map","name","console","log","$$__ENCRYPT__FOR","Promise","serviceType","deleteService","subscribeMyServices","rifle","query","publicKey","reconnect","onData","services","servicesEntries","forEach","get","service","type","serviceInfo","buyService","owner","servicePrice","amt","Number","to","memo","feeLimit","ackInfo","orderAck","JSON","parse","response","Loader","text","fullScreen","small","overlay","overlayBackground","style","height","use100vh","standaloneMode","window","matchMedia","matches","fullScreenStyles","marginBottom","overlayStyles","backgroundColor","className","classNames","unprotectedRoutes","GET","POST","PUT","DELETE","encryptRequest","config","store","hostKeys","getState","encryption","hostId","node","remotePublicKey","process","REACT_APP_SHOCK_ENCRYPTION_ECC","warn","Encryption","message","stringify","encryptedMessage","decryptResponse","userKeys","localPrivateKey","privateKey","decryptedMessage","interceptors","request","use","authToken","deviceId","localRequest","url","indexOf","headers","common","Authorization","method","toUpperCase","includes","error","reject","TipRibbon","tipCounter","tipValue","zoomed","opacity","Stream","item","index","postId","hideRibbon","width","playerDOM","timeout","useRef","useState","isLive","videoStyle","liveStatus","useEffect","player","videojs","current","autoplay","muted","aspectRatio","src","magnetURI","play","cursor","display","ref","preload","controls","autoPlay","INITIAL_STATE","hostIP","alias","authTokenExpirationDate","authMethod","hostingAttemptsDone","webClientPrefix","state","action","RESET_NODE_INFO","SET_HOST_IP","SET_HOST_ID","SET_AUTHENTICATED_USER","defaults","SET_ATTEMPTS_DONE","AUTH_ACTIONS","LOGOUT","SET_WEBCLIENT_PREFIX","authenticated","authStep","defaultSteps","manual","shockWizard","shockCloud","auth","SET_AUTHENTICATED","SET_AUTH_STEP","SET_AUTH_METHOD","totalBalance","channelBalance","confirmedBalance","pendingChannelBalance","USDRate","transactions","content","page","totalPages","totalItems","payments","channels","invoices","peers","recentTransactions","lightningInfo","_getUnifiedTransactionDate","parseInt","creation_date","settle_date","time_stamp","wallet","LOAD_BALANCE","Big","add","toString","LOAD_USD_RATE","LOAD_PEERS","ADD_PEER","REMOVE_PEER","filter","peer","pub_key","LOAD_CHANNELS","LOAD_TRANSACTIONS","LOAD_MORE_TRANSACTIONS","LOAD_INVOICES","LOAD_MORE_INVOICES","LOAD_PAYMENTS","LOAD_MORE_PAYMENTS","LOAD_RECENT_TRANSACTIONS","newRecentTransactions","sort","b","aDate","bDate","date","payment_hash","hash","payment_request","tx_hash","amount","label","RESET_RECENT_TRANSACTIONS","LOAD_LIGHTNING_INFO","contacts","messages","sentRequests","receivedRequests","requestBlacklist","_identicalMessages","oldMessage","newMessage","localId","_sortMessages","timestamp","_processNewMessage","status","outgoing","userMessages","recipientPublicKey","existingMessage","body","sortedMessages","chat","LOAD_CHAT_DATA","LOAD_SENT_REQUESTS","requestPublicKeys","pk","pendingRequests","loading","LOAD_RECEIVED_REQUESTS","SENT_REQUEST","avatar","changedAddress","displayName","Date","now","ACCEPT_HANDSHAKE_REQUEST","requestId","DECLINE_HANDSHAKE_REQUEST","trim","SENDING_MESSAGE","Schema","SENDING","SENT_MESSAGE","SENT","FAILED_MESSAGE","FAILED","RECEIVED_MESSAGE","RECEIVED","CHAT_WAS_DELETED","produce","draft","idx","findIndex","c","splice","open","drawer","SET_DRAWER_OPEN","seedProviderPub","streamUserToken","streamLiveToken","streamUrl","streamPostId","streamContentId","streamStatusUrl","streamBroadcasterUrl","publishedContent","unlockedContent","seedInfo","availableTokens","availableStreamTokens","publishedContentAdded","match","payload","res","publishedContentRemoved","SET_SEED_PROVIDER_PUB","ADD_UNLOCKED_CONTENT","unlockedTmp","contentPath","ADD_STREAM","liveToken","seedToken","REMOVE_STREAM","SET_SEED_INFO","ADD_AVAILABLE_TOKEN","seedUrl","userToken","availableTmp","push","REMOVE_USED_TOKEN","ADD_STREAM_TOKEN","REMOVE_STREAM_TOKEN","source","rate","feeRates","fastestFee","halfHourFee","hourFee","fees","RESET_FEES","LOAD_FEE_RATES","SET_SOURCE","SET_RATE","follows","user","private","posts","feed","RESET_FOLLOWS","ADD_FOLLOW","existingFollow","find","follow","REMOVE_FOLLOW","UPDATE_FOLLOW","key","profile","ADD_USER_POST","receivedPost","authorId","userPosts","existingPostIndex","tmp","DELETE_USER_POST","LOAD_POSTS","LOAD_SHARED_POST","sharerId","updatedPosts","originalPost","uuidv4","SET_DEVICE_ID","ADD_USER_KEY_PAIR","keyPair","ADD_HOST_KEY","userProfiles","NODE_ACTIONS","Common","RESET_USER_PROFILES","LOAD_USER_PROFILE","REMOVE_USER_PROFILE","profiles","UPDATE_USER_PROFILE","newProfile","oldProfile","CHAT_ACTIONS","req","myServices","boughtServices","orders","servicesTmp","selectedService","reducers","combineReducers","NodeReducer","AuthReducer","EncryptionReducer","WalletReducer","ChatReducer","DrawerReducer","ContentReducer","FeesReducer","FeedReducer","UserProfilesReducer","OrdersReducer","users","Migrations","1","newState","selectSelfPublicKey","isAuth","selectHost","selectSelfUser","selfPublicKey","maybeUser","createEmptyUser","selectUser","selectAllPublicKeys","keys","selectAllOtherPublicKeys","selectFollows","selectOwnPublishedContent","selectRoot","selectIsInContact","isContact","hasSentReq","r","hasReceivedReq","persistConfig","storage","blacklist","version","stateReconciler","autoMergeLevel2","migrate","createMigrate","debug","persistedReducer","persistReducer","rootReducer","initializedStore","appliedMiddleware","applyMiddleware","thunk","__REDUX_DEVTOOLS_EXTENSION__","createStore","compose","persistor","persistStore","initializeStore","useSelector","selector","origUseSelector","options","reconnection","rejectUnauthorized","parser","binaryParser","withCredentials","transports","rifleSubscriptions","Map","GunSocket","LNDSocket","connectSocket","host","disconnectSocket","socketOptions","encryptionId","SocketIO","connect","GunOn","encryptedOn","event","subscription","subscriptionId","onError","on","setAuthenticated","err","field","cachedNodeIP","connectHost","socket","off","close","decryptEventCallback","callback","encryptedEmit","eventName","emit","encryptedData","responses","decryptedResponses","subscribeSocket","resolve","then","token","unsubscribeRifleById","unsubscribeEvent","delete","unsubscribeRifleByQuery","Array","from","$shock","set","rifleCleanup","subscriptions","unsubscribe","getChats","chats","recipientAvatar","recipientDisplayName","didDisconnect","reduce","initialMessagePrefix","getSentRequests","getReceivedRequests","recipientChangedRequestAddress","RESET_AUTH_INFO","setAuthStep","step","setAuthMethod","logout","SET_CHAT_CONTACTS","SET_CHAT_MESSAGES","loadChatData","loadSentRequests","loadReceivedRequests","requestorPK","requestorAvatar","requestorDisplayName","subscribeChatMessages","userPublicKey","incomingId","rawMsg","msg","incomingMessages","acceptHandshakeRequest","put","accept","sendHandshakeRequest","sendMessage","tempId","DateTime","utc","toMillis","chatWasDeleted","PUBLISHED_CONTENT_ADDED","PUBLISHED_CONTENT_REMOVED","setSeedProviderPub","pub","setSeedInfo","cleanUrl","endsWith","slice","infoS","createAction","addPublishedContent","unlockContent","postID","revealRes","unlockedContents","contentID","hasOwnProperty","call","addStream","removeStream","addAvailableToken","removeUnavailableToken","addStreamToken","OWN_PUBLISHED_CONTENT_QUERY","subOwnPublishedContent","TypeError","parsed","parseJson","isPublishedContent","unsubOwnPublishedContent","fetchWalletBalance","channel_balance","confirmed_balance","pending_channel_balance","fetchUSDRate","exchangeRate","replace","fetchTransactions","itemsPerPage","reset","params","fetchChannels","fetchPeers","fetchInvoices","fetchUnifiedTransactions","connectPeer","pubkey","newPeer","address","bytes_sent","bytes_recv","sat_sent","sat_recv","inbound","openChannel","channelCapacity","pushAmount","channelPushAmount","satPerByte","FetchLightningInfo","safeParseJSON","nonEncryptedEvents","convertBase64ToBuffer","Buffer","convertBufferToBase64","processKey","Uint8Array","convertToEncryptedMessageResponse","ciphertext","iv","mac","ephemPublicKey","FieldError","convertToEncryptedMessage","isEncryptedMessage","isNonEncrypted","generateKeyPair","ECCrypto","generatePrivate","getPublic","privateKeyBase64","publicKeyBase64","encryptMessage","processedPublicKey","messageBuffer","encrypt","encryptedMessageResponse","decryptMessage","processedPrivateKey","decrypt","decryptedMessageBuffer","parsedMessage","SET_CONNECTION_STATUS","SET_NODE_HEALTH","setHostId","fetchNodeHealth","Error","APIStatus","fetchNodeUnlockStatus","walletExists","walletStatus","resetData","done","health","baseURL","throttledExchangeKeyPair","sanitizedHostIP","nodeHealthHttps","withProtocolHostIP","nodeHealth","unlockWallet","password","decodedToken","jwtDecode","authorization","exp","parseError","createWallet","setWebclientPrefix","prefix","useForceUpdate","React","setTick","useCallback","tick","logger","resizeImage","img","desiredLongEdge","compression","canvas","document","createElement","Math","round","getContext","drawImage","toDataURL","processImageFile","file","startsWith","size","rej","reader","FileReader","onload","e","target","result","ArrayBuffer","onFail","onerror","onabort","readAsArrayBuffer","imageBuffer","URL","webkitURL","createObjectURL","Blob","_image","Image","image","resizedImage","normalizeURL","_url","__url","_","protocol","href","getContact","contact","EMPTY_FN","useBooleanState","initialState","setState","_state","o","Drawer","useDispatch","Store","closeDrawer","onClickLogout","confirm","onClickScan","onClick","color","OverviewPage","lazy","AdvancedPage","MessagesPage","ProfilePage","ChatPage","SendPage","RequestPage","AuthPage","FeedPage","MoonPayPage","PublishContentPage","offerServicePage","CreatePostPage","GoLivePage","OtherUserPage","Story","Stories","QRScannerPage","BackupsPage","PrivateRoute","component","authorizedComponent","App","history","useHistory","setUpdate","setIsLive","showFloatingPlayer","setShowFloatingPlayer","interval","setInterval","clearInterval","setTimeout","info","clearTimeout","StreamRender","useMemo","undefined","stopStream","contentId","endUrl","urlForMagnet","obsToken","addLanguage","tokenExpired","JWTDecode","subscribeUserProfile","unsubscribeUserProfile","elementId","elmnt","getElementById","pos1","pos2","pos3","pos4","onpointerdown","preventDefault","clientX","clientY","onpointerup","closeDragElement","onpointermove","elementDrag","top","offsetTop","left","offsetLeft","dragElement","loadContentInfo","serviceProvider","seedData","JObject","fallback","exact","isLocalhost","Boolean","location","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","origin","addEventListener","fetch","contentType","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration","subscribedProfiles","Set","updateUserProfile","has","binarySub","Utils","header","RESET_FEED","POST_TIPPED","removeFollow","addFollow","loadSharedPost","originalPostId","originalPublicKey","sharerPublicKey","tipSet","tipsSet","values","lenSet","length","tot","acc","val","USER_POSTS_QUERY_SUFFIX","subscribeUserPosts","postEntries","newPosts","GUN_PROPS","deletedPosts","USER_SHARED_POSTS_QUERY_SUFFIX","subscribeSharedUserPosts","shared","originalAuthor","processedPost","shareDate","FOLLOWS_QUERY","subscribeFollows","unsubscribeFollows","sendTipPost","deleteUserPost","CHAT_MESSAGE_STATUS","isSharedPost","obj","description","title","stack","errorMessage","exchangingKeypair","addUserKeyPair","addHostKey","getDeviceId","APIPublicKey","openDrawer","loadFeeRates","capitalizeText","split","word","toLowerCase","join","processDisplayName","suffix"],"mappings":"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","file":"static/js/main.5119665e.chunk.js","sourcesContent":["import Http from \"../utils/Http\";\nimport {\n  rifle,\n  rifleSocketExists,\n  unsubscribeRifleById\n} from \"../utils/WebSocket\";\nexport const ACTIONS = {\n  ADD_MY_SERVICE: \"service/add\",\n  REMOVE_MY_SERVICE: \"service/remove\",\n  ADD_BOUGHT_SERVICE: \"service/add/bought\"\n};\n\nexport const createService = (\n  clear,\n  encrypted,\n  serviceID\n) => async dispatch => {\n  let id = serviceID;\n  if (serviceID) {\n    const { data } = await Http.post(\"/api/gun/put\", {\n      path: `$user>offeredServices>${id}`,\n      value: clear\n    });\n    const { ok } = data;\n    if (!ok) {\n      return \"\";\n    }\n  } else {\n    const { data } = await Http.post(\"/api/gun/set\", {\n      path: \"$user>offeredServices\",\n      value: clear\n    });\n    const { ok, id: newID } = data;\n    if (!ok) {\n      return \"\";\n    }\n    id = newID;\n  }\n\n  const all = Object.entries(encrypted).map(([name, value]) => {\n    if (!value) {\n      return;\n    }\n    console.log(`setting: ${name} to ${value}`);\n    return Http.post(\"/api/gun/put\", {\n      path: `$user>offeredServices>${id}>${name}`,\n      value: {\n        $$__ENCRYPT__FOR: \"me\",\n        value\n      }\n    });\n  });\n  await Promise.all(all);\n  const { serviceType } = clear;\n  //update the offered service\n  if (serviceType === \"torrentSeed\" || serviceType === \"streamSeed\") {\n    console.log(\"updating profile with service\");\n    await Http.post(\"/api/gun/put\", {\n      path: `$user>Profile>SeedServiceProvided`,\n      value: id\n    });\n  }\n  /* - The update will come from APi, this should not be needed \n  dispatch({\n    type: ACTIONS.ADD_MY_SERVICE,\n    data: {id,serviceInfo}\n  });*/\n  return id;\n};\n\nexport const deleteService = id => async dispatch => {\n  return await Http.post(\"/api/gun/put\", {\n    path: `$user>offeredServices>${id}`,\n    value: null\n  });\n};\n\nexport const subscribeMyServices = () => dispatch => {\n  const query = `$user::offeredServices::on`;\n  const subscription = rifle({\n    query,\n    publicKey: \"\",\n    reconnect: false,\n    onData: async services => {\n      const servicesEntries = Object.entries(services);\n      console.log(servicesEntries);\n\n      servicesEntries.forEach(async ([id]) => {\n        if (id === \"_\") {\n          return;\n        }\n        const { data: service } = await Http.get(\n          `/api/gun/user/load/offeredServices>${id}`\n        );\n        console.log(service.data);\n        if (service.data === null) {\n          dispatch({\n            type: ACTIONS.REMOVE_MY_SERVICE,\n            data: id\n          });\n          return;\n        }\n        dispatch({\n          type: ACTIONS.ADD_MY_SERVICE,\n          data: { id, serviceInfo: service.data }\n        });\n      });\n    }\n  });\n\n  return subscription;\n};\n\nexport const buyService = (\n  owner,\n  serviceID,\n  servicePrice\n) => async dispatch => {\n  const { data } = await Http.post(\"/api/lnd/unifiedTrx\", {\n    type: \"service\",\n    amt: Number(servicePrice),\n    to: owner,\n    memo: \"\",\n    feeLimit: 500,\n    ackInfo: serviceID\n  });\n  console.log(data);\n  const orderAck = JSON.parse(data.orderAck.response);\n  dispatch({\n    type: ACTIONS.ADD_BOUGHT_SERVICE,\n    data: { orderAck, owner, serviceID }\n  });\n  return orderAck;\n};\n","import classNames from \"classnames\";\nimport { use100vh } from \"react-div-100vh\";\nimport \"./css/index.scoped.css\";\n\nconst Loader = ({\n  text = \"Loading...\",\n  fullScreen = false,\n  small = false,\n  overlay = false,\n  overlayBackground = \"rgba(44, 51, 58, 0.95)\",\n  style = {}\n}) => {\n  const height = use100vh() ?? \"100vh\";\n  // Fixes cutoff loading overlay in PWA mode\n  const standaloneMode = window.matchMedia(\"(display-mode: standalone)\")\n    .matches;\n  const fullScreenStyles = fullScreen\n    ? { height: standaloneMode ? \"100%\" : height, marginBottom: 0 }\n    : {};\n  const overlayStyles = overlay\n    ? {\n        backgroundColor: overlayBackground\n      }\n    : {};\n  return (\n    <div\n      className={classNames({\n        \"loading-wall\": true,\n        \"loading-small\": small,\n        \"loading-overlay\": overlay\n      })}\n      style={{\n        ...fullScreenStyles,\n        ...overlayStyles,\n        ...style\n      }}\n    >\n      <div className=\"loading-wall-icon\">\n        <span className=\"loading-circle loading-circle-1\"></span>\n        <span className=\"loading-circle loading-circle-2\"></span>\n        <span className=\"loading-circle loading-circle-3\"></span>\n        {!small ? (\n          <>\n            <span className=\"loading-circle loading-circle-4\"></span>\n            <span className=\"loading-circle loading-circle-5\"></span>\n          </>\n        ) : null}\n      </div>\n      {text ? <div className=\"loading-wall-text\">{text}</div> : null}\n    </div>\n  );\n};\n\nexport default Loader;\n","import Http from \"axios\";\nimport * as Encryption from \"./Encryption\";\n\nconst unprotectedRoutes = {\n  GET: [\n    \"/healthz\",\n    \"/ping\",\n    // Errors out when viewing an API page from the browser\n    \"/favicon.ico\",\n    \"/api/lnd/wallet/status\"\n  ],\n  POST: [\"/api/security/exchangeKeys\", \"/api/encryption/exchange\"],\n  PUT: [],\n  DELETE: []\n};\n\nconst encryptRequest = async config => {\n  const { store } = await import(\"../store\");\n  const { hostKeys } = store.getState().encryption;\n  const { hostId } = store.getState().node;\n\n  const { data } = config;\n\n  const remotePublicKey = hostKeys[hostId];\n\n  if (process.env.REACT_APP_SHOCK_ENCRYPTION_ECC === \"false\") {\n    return config;\n  }\n\n  if (!remotePublicKey) {\n    console.warn(\n      \"[ENCRYPTION] Unable to retrieve key for specified Host ID:\",\n      hostId,\n      hostKeys\n    );\n    return config;\n  }\n\n  const encryptedMessage = await Encryption.encryptMessage({\n    publicKey: remotePublicKey,\n    message: JSON.stringify(data)\n  });\n\n  return {\n    ...config,\n    data: encryptedMessage\n  };\n};\n\nconst decryptResponse = async response => {\n  if (!response) {\n    return response;\n  }\n\n  const { store } = await import(\"../store\");\n  const { userKeys } = store.getState().encryption;\n  const { hostId } = store.getState().node;\n\n  const { data } = response;\n\n  if (!Encryption.isEncryptedMessage(data)) {\n    return response;\n  }\n\n  const localPrivateKey = userKeys[hostId]?.privateKey;\n\n  if (!localPrivateKey) {\n    console.warn(\n      \"[ENCRYPTION] Unable to retrieve key for specified Host ID:\",\n      hostId,\n      userKeys\n    );\n    return response;\n  }\n\n  const decryptedMessage = await Encryption.decryptMessage({\n    privateKey: localPrivateKey,\n    encryptedMessage: data\n  });\n\n  return { ...response, data: decryptedMessage };\n};\n\nHttp.interceptors.request.use(async config => {\n  try {\n    const { store } = await import(\"../store\");\n    const { authToken } = store.getState().node;\n    const { deviceId } = store.getState().encryption;\n    const localRequest = config.url.indexOf(\"/\") === 0;\n\n    if (localRequest) {\n      config.headers.common.Authorization = `Bearer ${authToken}`;\n      config.headers.common[\"encryption-device-id\"] = deviceId;\n    }\n\n    if (\n      localRequest &&\n      !unprotectedRoutes[config.method.toUpperCase()].includes(config.url)\n    ) {\n      return await encryptRequest(config);\n    }\n\n    return config;\n  } catch (error) {\n    console.error(error);\n  }\n});\n\nHttp.interceptors.response.use(\n  async response => {\n    return decryptResponse(response);\n  },\n  async error => {\n    try {\n      const response = await decryptResponse(error.response);\n      error.response = response;\n      return Promise.reject(error);\n    } catch (err) {\n      console.error(err);\n      throw error;\n    }\n  }\n);\n\nexport default Http;\n","import React from \"react\";\nimport \"./css/index.scoped.css\";\n\nconst TipRibbon = ({ tipCounter, tipValue, zoomed }) =>\n  tipValue > 0 ? (\n    <div className=\"ribbon-container\" style={{ opacity: !zoomed ? 1 : 0 }}>\n      <p className=\"ribbon-title\">Total Tips</p>\n      <p className=\"ribbon-value\">\n        {tipCounter} {tipCounter === 1 ? \"Tip\" : \"Tips\"}\n      </p>\n    </div>\n  ) : null;\n\nexport default TipRibbon;\n","import React, { useRef, useEffect, useState } from \"react\";\nimport TipRibbon from \"../TipRibbon\";\nimport \"./css/index.scoped.css\";\nimport videojs from \"video.js\";\nimport Http from \"../../../../utils/Http\";\n\nconst REACT_APP_SL_SEED_URI = \"https://webtorrent.shock.network\";\nconst STREAM_STATUS_URI = `${REACT_APP_SL_SEED_URI}/rtmpapi/api/streams/live`;\n\nconst Stream = ({\n  id,\n  item,\n  index,\n  postId,\n  tipValue,\n  tipCounter,\n  hideRibbon,\n  width,\n  timeout = 10000\n}) => {\n  const playerDOM = useRef(null);\n  const [isLive, setIsLive] = useState(false);\n  const videoStyle = { width: \"100%\" };\n  if (width) {\n    videoStyle.width = width;\n  }\n  const {liveStatus} = item\n  useEffect(() =>{\n    const player = videojs(playerDOM.current, {\n      autoplay: true,\n      muted: true,\n      aspectRatio: \"16:9\"\n    });\n    player.src({\n      src: item.magnetURI,\n      type: \"application/x-mpegURL\"\n    });\n    //listen for 404s from the player\n    //player.tech().on('retryplaylist', () => {\n    //  console.log('retryplaylist');\n    //});\n    player.play();\n  },[item])\n  useEffect(()=>{\n    console.log(\"status:\",liveStatus)\n  },[item])\n  return (\n    <div className=\"media-container w-100\">\n      <div\n        className=\"video-container w-100\"\n        style={{\n          cursor: \"pointer\",\n          width: \"100%\"\n        }}\n      >\n        {!isLive && liveStatus === 'waiting' && <p>The stream did not start yet.</p>}\n        {!isLive && liveStatus === 'wasLive' && <p>The stream is over</p>}\n        {!isLive && !liveStatus && <p>The streamer has disconnected.</p>}\n        <div\n          style={\n            liveStatus === 'live' ? { width: \"100%\" } : { display: \"none\", width: \"100%\" }\n          }\n        >\n          <video\n            className=\"video-js vjs-default-skin\"\n            ref={playerDOM}\n            style={videoStyle}\n            preload=\"auto\"\n            controls\n            muted\n            autoPlay\n          />\n        </div>\n        {!hideRibbon && (\n          <TipRibbon\n            tipCounter={tipCounter}\n            tipValue={tipValue}\n            zoomed={false}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Stream;\n","import Http from \"axios\";\nimport { ACTIONS } from \"../actions/NodeActions\";\nimport { ACTIONS as AUTH_ACTIONS } from \"../actions/AuthActions\";\n\nconst INITIAL_STATE = {\n  hostId: null,\n  hostIP: null,\n  alias: null,\n  authToken: null,\n  publicKey: null,\n  authTokenExpirationDate: null,\n  authMethod: null,\n  hostingAttemptsDone: false,\n  webClientPrefix:\"https://shock.pub\"\n};\n\nconst node = (state = INITIAL_STATE, action) => {\n  switch (action.type) {\n    case ACTIONS.RESET_NODE_INFO: {\n      return INITIAL_STATE;\n    }\n    case ACTIONS.SET_HOST_IP: {\n      const hostIP = action.data;\n      return {\n        ...state,\n        hostIP\n      };\n    }\n    case ACTIONS.SET_HOST_ID: {\n      const hostId = action.data;\n      return {\n        ...state,\n        hostId\n      };\n    }\n    case ACTIONS.SET_AUTHENTICATED_USER: {\n      const {\n        authToken,\n        alias,\n        publicKey,\n        authTokenExpirationDate,\n        authMethod\n      } = action.data;\n\n      Http.defaults.headers.common.Authorization = `Bearer ${authToken}`;\n\n      return {\n        ...state,\n        authToken,\n        authTokenExpirationDate,\n        alias,\n        publicKey,\n        authMethod\n      };\n    }\n    case ACTIONS.SET_ATTEMPTS_DONE: {\n      return { ...state, hostingAttemptsDone: true };\n    }\n\n    case AUTH_ACTIONS.LOGOUT: {\n      return {\n        ...state,\n        authToken: null,\n        publicKey: null,\n        authTokenExpirationDate: null,\n        authMethod: null,\n        hostingAttemptsDone: false\n      };\n    }\n    case ACTIONS.SET_WEBCLIENT_PREFIX:{\n      return {...state, webClientPrefix:action.data}\n    }\n    default:\n      return state;\n  }\n};\n\nexport default node;\n","import { ACTIONS } from \"../actions/AuthActions\";\n\nconst INITIAL_STATE = {\n  authenticated: false,\n  authStep: \"host\",\n  authMethod: null\n};\n\nconst defaultSteps = {\n  manual: \"host\",\n  shockWizard: \"scan\",\n  shockCloud: \"inviteCode\"\n};\n\nconst auth = (state = INITIAL_STATE, action) => {\n  switch (action.type) {\n    case ACTIONS.SET_AUTHENTICATED: {\n      return { ...state, authenticated: action.data };\n    }\n    case ACTIONS.SET_AUTH_STEP: {\n      return {\n        ...state,\n        authStep: action.data\n      };\n    }\n    case ACTIONS.SET_AUTH_METHOD: {\n      const method = action.data;\n      return {\n        ...state,\n        authMethod: method,\n        authStep: defaultSteps[method]\n      };\n    }\n    case ACTIONS.LOGOUT: {\n      return INITIAL_STATE;\n    }\n    default:\n      return state;\n  }\n};\n\nexport default auth;\n","// @ts-check\n/**\n * @typedef {import('shock-common').Channel} Channel\n */\n\nimport Big from \"big.js\";\nimport { ACTIONS } from \"../actions/WalletActions\";\n\nconst INITIAL_STATE = {\n  // Wallet Balance\n  totalBalance: \"0\",\n  channelBalance: \"0\",\n  confirmedBalance: \"0\",\n  pendingChannelBalance: \"0\",\n  USDRate: null,\n\n  transactions: { content: [], page: -1, totalPages: 0, totalItems: 0 },\n  payments: { content: [], page: -1, totalPages: 0, totalItems: 0 },\n  /**\n   * @type {readonly Channel[]}\n   */\n  channels: [],\n  invoices: { content: [], page: -1, totalPages: 0, totalItems: 0 },\n  peers: [],\n  // Includes transactions, payments and invoices combined with a unified schema\n  // and sorted by date\n  recentTransactions: [],\n  lightningInfo:{},\n};\n\nconst _getUnifiedTransactionDate = item =>\n  parseInt(item.creation_date || item.settle_date || item.time_stamp, 10);\n\n/**\n * @returns {typeof INITIAL_STATE}\n */\nconst wallet = (state = INITIAL_STATE, action) => {\n  switch (action.type) {\n    case ACTIONS.LOAD_BALANCE: {\n      const {\n        channelBalance,\n        confirmedBalance,\n        pendingChannelBalance\n      } = action.data;\n      const totalBalance = new Big(confirmedBalance)\n        .add(channelBalance)\n        .add(pendingChannelBalance)\n        .toString();\n\n      return {\n        ...state,\n        totalBalance,\n        channelBalance,\n        confirmedBalance,\n        pendingChannelBalance\n      };\n    }\n    case ACTIONS.LOAD_USD_RATE: {\n      const { data } = action;\n\n      return {\n        ...state,\n        USDRate: data\n      };\n    }\n    case ACTIONS.LOAD_PEERS: {\n      const { data } = action;\n\n      return {\n        ...state,\n        peers: data\n      };\n    }\n    case ACTIONS.ADD_PEER: {\n      const { data } = action;\n\n      return {\n        ...state,\n        peers: [data, ...state.peers]\n      };\n    }\n    case ACTIONS.REMOVE_PEER: {\n      const { data } = action;\n\n      return {\n        ...state,\n        peers: state.peers.filter(peer => peer.pub_key !== data.publicKey)\n      };\n    }\n    case ACTIONS.LOAD_CHANNELS: {\n      const { data } = action;\n\n      return {\n        ...state,\n        channels: data\n      };\n    }\n    case ACTIONS.LOAD_TRANSACTIONS: {\n      const { data } = action;\n\n      return {\n        ...state,\n        transactions: data\n      };\n    }\n    case ACTIONS.LOAD_MORE_TRANSACTIONS: {\n      const { data } = action;\n\n      return {\n        ...state,\n        transactions: {\n          ...data,\n          content: [...state.transactions.content, ...data.content]\n        }\n      };\n    }\n    case ACTIONS.LOAD_INVOICES: {\n      const { data } = action;\n\n      return {\n        ...state,\n        invoices: data\n      };\n    }\n    case ACTIONS.LOAD_MORE_INVOICES: {\n      const { data } = action;\n\n      return {\n        ...state,\n        invoices: {\n          ...data,\n          content: [...state.invoices.content, ...data.content]\n        }\n      };\n    }\n    case ACTIONS.LOAD_PAYMENTS: {\n      const { data } = action;\n\n      return {\n        ...state,\n        payments: data\n      };\n    }\n    case ACTIONS.LOAD_MORE_PAYMENTS: {\n      const { data } = action;\n\n      return {\n        ...state,\n        payments: {\n          ...data,\n          content: [...state.payments.content, ...data.content]\n        }\n      };\n    }\n    case ACTIONS.LOAD_RECENT_TRANSACTIONS: {\n      const { transactions, payments, invoices } = action.data;\n      const newRecentTransactions = [\n        ...transactions.content,\n        ...payments.content,\n        ...invoices.content\n      ]\n        .sort((a, b) => {\n          const aDate = _getUnifiedTransactionDate(a);\n          const bDate = _getUnifiedTransactionDate(b);\n\n          return aDate < bDate ? 1 : aDate > bDate ? -1 : 0;\n        })\n        .map(item => {\n          const date = _getUnifiedTransactionDate(item);\n\n          if (item.payment_hash) {\n            return {\n              type: \"payment\",\n              hash: item.payment_hash,\n              value: item.value,\n              date\n            };\n          }\n\n          if (item.payment_request) {\n            return {\n              type: \"invoice\",\n              hash: item.payment_request,\n              value: item.value,\n              date,\n              message: item.memo\n            };\n          }\n\n          if (item.tx_hash) {\n            return {\n              type: \"chain\",\n              hash: item.tx_hash,\n              value: item.amount,\n              date,\n              message: item.label\n            };\n          }\n\n          console.warn(\"Invalid transaction detected\", item);\n          return null;\n        })\n        .filter(item => item !== null);\n\n      return {\n        ...state,\n        transactions,\n        payments,\n        invoices,\n        recentTransactions: newRecentTransactions\n      };\n    }\n    case ACTIONS.RESET_RECENT_TRANSACTIONS: {\n      return {\n        ...state,\n        recentTransactions: []\n      };\n    }\n    case ACTIONS.LOAD_LIGHTNING_INFO:{\n      const {data}  = action\n      return {\n        ...state,\n        lightningInfo:data\n      }\n    }\n    default:\n      return state;\n  }\n};\n\nexport default wallet;\n","// @ts-check\n/**\n * @format\n */\nimport produce from \"immer\";\n/**\n * @typedef {import('redux').AnyAction} AnyAction\n */\n/**\n * @template S\n * @typedef {import('redux').Reducer<S, AnyAction>} Reducer\n */\n\nimport * as Schema from \"../schema\";\nimport { ACTIONS } from \"../actions/ChatActions\";\n/**\n * @typedef {import('../schema').Contact} Contact\n * @typedef {import('../schema').ReceivedRequest} ReceivedRequest\n * @typedef {import(\"../schema\").SentRequest} SentRequest\n *\n * @typedef {import('../actions/ChatActions').SentRequestAction} SentRequestAction\n * @typedef {import('../actions/ChatActions').LoadChatDataAction} LoadChatDataAction\n * @typedef {import('../actions/ChatActions').LoadReceivedRequestsAction} LoadReceivedRequestsAction\n * @typedef {import('../actions/ChatActions').LoadSentRequestsAction} LoadSentRequestsAction\n */\n\nconst INITIAL_STATE = {\n  contacts: /** @type {Contact[]} */ ([]),\n  /**\n   * @type {Record<string, Schema.ChatMessage[]>}\n   */\n  messages: {},\n  sentRequests: /** @type {SentRequest[]} */ ([]),\n  receivedRequests: /** @type {ReceivedRequest[]} */ ([]),\n  requestBlacklist: []\n};\n\n/**\n * @param {Schema.ChatMessage} oldMessage\n * @param {Schema.ChatMessage} newMessage\n * @returns {boolean}\n */\nconst _identicalMessages = (oldMessage, newMessage) =>\n  oldMessage.id && newMessage.id\n    ? oldMessage.id === newMessage.id\n    : oldMessage.localId === newMessage.localId;\n\n/**\n * @param {Schema.ChatMessage[]} messages\n * @returns {Schema.ChatMessage[]}\n */\nconst _sortMessages = (messages = []) =>\n  messages.sort((a, b) => b.timestamp - a.timestamp);\n\n/**\n * @typedef {object} ProcessNewMessageParams\n * @prop {Schema.ChatMessage} data\n * @prop {Schema.ChatMessageStatus} status\n * @prop {typeof INITIAL_STATE} state\n * @prop {boolean=} outgoing\n */\n\n/**\n * @param {ProcessNewMessageParams} args\n * @returns {typeof INITIAL_STATE}\n */\nconst _processNewMessage = ({ data, status, state, outgoing = false }) => {\n  const userMessages = state.messages[data.recipientPublicKey] ?? [];\n  const [existingMessage] = userMessages.filter(message =>\n    _identicalMessages(message, data)\n  );\n\n  if (existingMessage) {\n    console.warn(\"Duplicate Message:\", existingMessage?.body);\n  }\n\n  if (existingMessage) {\n    const messages = userMessages.map(message =>\n      _identicalMessages(message, existingMessage)\n        ? { ...existingMessage, ...data, status, outgoing }\n        : message\n    );\n    const sortedMessages = _sortMessages(messages);\n\n    return {\n      ...state,\n      messages: {\n        ...state.messages,\n        [data.recipientPublicKey]: sortedMessages\n      }\n    };\n  }\n\n  const messages = [{ ...data, status, outgoing }, ...userMessages];\n  const sortedMessages = _sortMessages(messages);\n\n  return {\n    ...state,\n    messages: {\n      ...state.messages,\n      [data.recipientPublicKey]: sortedMessages\n    }\n  };\n};\n\n/**\n * @type {Reducer<typeof INITIAL_STATE>}\n */\nconst chat = (state = INITIAL_STATE, action) => {\n  switch (action.type) {\n    case ACTIONS.LOAD_CHAT_DATA: {\n      const {\n        data: { contacts, messages }\n      } = /** @type {LoadChatDataAction} */ (action);\n      return {\n        ...state,\n        contacts,\n        // TODO: Could not replacing messages altogether be bad?\n        messages: {\n          ...state.messages,\n          ...messages\n        }\n      };\n    }\n    case ACTIONS.LOAD_SENT_REQUESTS: {\n      const {\n        data: sentRequests\n      } = /** @type {LoadSentRequestsAction} */ (action);\n      const requestPublicKeys = state.sentRequests.map(request => request.pk);\n      const pendingRequests = state.sentRequests.filter(\n        request => request.loading && !requestPublicKeys.includes(request.pk)\n      );\n\n      return {\n        ...state,\n        sentRequests: [...pendingRequests, ...sentRequests]\n      };\n    }\n    case ACTIONS.LOAD_RECEIVED_REQUESTS: {\n      const {\n        data: receivedRequests\n      } = /** @type {LoadReceivedRequestsAction} */ (action);\n\n      return {\n        ...state,\n        receivedRequests\n      };\n    }\n    case ACTIONS.SENT_REQUEST: {\n      const { data: publicKey } = /** @type {SentRequestAction} */ (action);\n      return {\n        ...state,\n        sentRequests: [\n          ...state.sentRequests,\n          {\n            avatar: null,\n            changedAddress: false,\n            displayName: null,\n            id: \"loading/\" + publicKey,\n            pk: publicKey,\n            timestamp: Date.now(),\n            loading: true\n          }\n        ]\n      };\n    }\n    case ACTIONS.ACCEPT_HANDSHAKE_REQUEST: {\n      const requestId = action.data;\n      return {\n        ...state,\n        receivedRequests: state.receivedRequests.filter(\n          request => request.id !== requestId\n        )\n      };\n    }\n    case ACTIONS.DECLINE_HANDSHAKE_REQUEST: {\n      const requestId = action.data;\n      if (!requestId || !requestId.trim()) {\n        return state;\n      }\n\n      return {\n        ...state,\n        requestBlacklist: [...state.requestBlacklist, requestId]\n      };\n    }\n    case ACTIONS.SENDING_MESSAGE: {\n      const { data } = action;\n      return _processNewMessage({\n        data,\n        status: Schema.CHAT_MESSAGE_STATUS.SENDING,\n        state,\n        outgoing: true\n      });\n    }\n    case ACTIONS.SENT_MESSAGE: {\n      const { data } = action;\n      return _processNewMessage({\n        data,\n        status: Schema.CHAT_MESSAGE_STATUS.SENT,\n        state,\n        outgoing: true\n      });\n    }\n    case ACTIONS.FAILED_MESSAGE: {\n      const { data } = action;\n      return _processNewMessage({\n        data,\n        status: Schema.CHAT_MESSAGE_STATUS.FAILED,\n        state,\n        outgoing: true\n      });\n    }\n    case ACTIONS.RECEIVED_MESSAGE: {\n      const { data } = action;\n      return _processNewMessage({\n        data,\n        status: Schema.CHAT_MESSAGE_STATUS.RECEIVED,\n        state\n      });\n    }\n    case ACTIONS.CHAT_WAS_DELETED: {\n      const {\n        data: { publicKey }\n      } = action;\n      return produce(state, draft => {\n        const idx = draft.contacts.findIndex(c => c.pk === publicKey);\n        idx > -1 && draft.contacts.splice(idx, 1);\n        delete draft.messages[publicKey];\n        draft.messages[publicKey] = [];\n      });\n    }\n    default:\n      return state;\n  }\n};\n\nexport default chat;\n","/**\n * @format\n */\nimport { ACTIONS } from \"../actions/DrawerActions\";\n\nconst INITIAL_STATE = {\n  open: false\n};\n\nconst drawer = (state = INITIAL_STATE, action) => {\n  switch (action.type) {\n    case ACTIONS.SET_DRAWER_OPEN: {\n      return { ...state, open: action.data };\n    }\n    default:\n      return state;\n  }\n};\n\nexport default drawer;\n","import produce from \"immer\";\n\nimport {\n  ACTIONS,\n  publishedContentAdded,\n  publishedContentRemoved\n} from \"../actions/ContentActions\";\nimport { PublishedContent } from \"../schema\";\n\nconst INITIAL_STATE = {\n  seedProviderPub:\n    \"qsgziGQS99sPUxV1CRwwRckn9cG6cJ3prbDsrbL7qko.oRbCaVKwJFQURWrS1pFhkfAzrkEvkQgBRIUz9uoWtrg\",\n  streamUserToken: \"\",\n  streamLiveToken: \"\",\n  streamUrl: \"\",\n  streamPostId: \"\",\n  streamContentId: \"\",\n  streamStatusUrl: \"\",\n  streamBroadcasterUrl: \"\",\n  publishedContent: {} as Record<string, PublishedContent>,\n  unlockedContent: {},\n  seedInfo: {} as { seedUrl?: string; seedToken?: string },\n  availableTokens: {},\n  availableStreamTokens: {}\n};\n\nconst content = (state = INITIAL_STATE, action): typeof INITIAL_STATE => {\n  if (publishedContentAdded.match(action)) {\n    return produce(state, draft => {\n      const {\n        payload: { content, res }\n      } = action;\n      if (res.ok) {\n        draft.publishedContent[res.id] = content;\n      }\n    });\n  }\n\n  if (publishedContentRemoved.match(action)) {\n    return produce(state, draft => {\n      delete draft.publishedContent[action.payload.id];\n    });\n  }\n\n  switch (action.type) {\n    case ACTIONS.SET_SEED_PROVIDER_PUB: {\n      return { ...state, seedProviderPub: action.data };\n    }\n\n    case ACTIONS.ADD_UNLOCKED_CONTENT: {\n      const { data } = action;\n      const unlockedTmp = { ...state.unlockedContent };\n      unlockedTmp[data.contentPath] = data.content;\n      return { ...state, unlockedContent: unlockedTmp };\n    }\n    case ACTIONS.ADD_STREAM: {\n      const { data } = action;\n      return {\n        ...state,\n        streamLiveToken: data.liveToken,\n        streamUserToken: data.seedToken,\n        streamUrl: data.streamUrl,\n        streamPostId: data.streamPostId,\n        streamContentId: data.streamContentId,\n        streamStatusUrl: data.streamStatusUrl,\n        streamBroadcasterUrl: data.streamBroadcasterUrl\n      };\n    }\n    case ACTIONS.REMOVE_STREAM: {\n      return {\n        ...state,\n        streamLiveToken: \"\",\n        streamUserToken: \"\",\n        streamUrl: \"\",\n        streamPostId: \"\",\n        streamContentId: \"\",\n        streamStatusUrl: \"\",\n        streamBroadcasterUrl: \"\"\n      };\n    }\n    case ACTIONS.SET_SEED_INFO: {\n      const { data } = action;\n      return { ...state, seedInfo: data };\n    }\n    case ACTIONS.ADD_AVAILABLE_TOKEN: {\n      const { data } = action;\n      const { seedUrl, userToken } = data;\n      const availableTmp = { ...state.availableTokens };\n      if (!availableTmp[seedUrl]) {\n        availableTmp[seedUrl] = [];\n      }\n      availableTmp[seedUrl].push(userToken);\n      return { ...state, availableTokens: availableTmp };\n    }\n    case ACTIONS.REMOVE_USED_TOKEN: {\n      const { data } = action;\n      const { seedUrl, userToken } = data;\n      const availableTmp = { ...state.availableTokens };\n      if (!availableTmp[seedUrl]) {\n        return state;\n      }\n      const index = availableTmp[seedUrl].indexOf(userToken);\n      if (index > -1) {\n        availableTmp[seedUrl].splice(index, 1);\n        return { ...state, availableTokens: availableTmp };\n      }\n      return state;\n    }\n    case ACTIONS.ADD_STREAM_TOKEN: {\n      const { data } = action;\n      const { seedUrl, userToken } = data;\n      const availableTmp = { ...state.availableStreamTokens };\n      if (!availableTmp[seedUrl]) {\n        availableTmp[seedUrl] = [];\n      }\n      availableTmp[seedUrl].push(userToken);\n      return { ...state, availableStreamTokens: availableTmp };\n    }\n    case ACTIONS.REMOVE_STREAM_TOKEN: {\n      const { data } = action;\n      const { seedUrl, userToken } = data;\n      const availableTmp = { ...state.availableStreamTokens };\n      if (!availableTmp[seedUrl]) {\n        return state;\n      }\n      const index = availableTmp[seedUrl].indexOf(userToken);\n      if (index > -1) {\n        availableTmp[seedUrl].splice(index, 1);\n        return { ...state, availableStreamTokens: availableTmp };\n      }\n      return state;\n    }\n    default:\n      return state;\n  }\n};\n\nexport default content;\n","import { ACTIONS } from \"../actions/FeesActions\";\n\nconst INITIAL_STATE = {\n  source: \"https://mempool.space/api/v1/fees/recommended\",\n  rate: \"halfHourFee\",\n  feeRates: {\n    fastestFee: 0,\n    halfHourFee: 0,\n    hourFee: 0\n  }\n};\n\nconst fees = (state = INITIAL_STATE, action) => {\n  switch (action.type) {\n    case ACTIONS.RESET_FEES: {\n      return INITIAL_STATE;\n    }\n    case ACTIONS.LOAD_FEE_RATES: {\n      const feeRates = action.data;\n      return {\n        ...state,\n        feeRates\n      };\n    }\n    case ACTIONS.SET_SOURCE: {\n      const source = action.data;\n      return {\n        ...state,\n        source\n      };\n    }\n    case ACTIONS.SET_RATE: {\n      const rate = action.data;\n      return {\n        ...state,\n        rate\n      };\n    }\n    default:\n      return state;\n  }\n};\n\nexport default fees;\n","// @ts-check\n/**\n * @typedef {import('shock-common').Follow} Follow\n */\n\nimport { ACTIONS } from \"../actions/FeedActions\";\n/**\n * @typedef {import('../schema').Post} Post\n * @typedef {import('../schema').SharedPost} SharedPost\n */\n\nconst INITIAL_STATE = {\n  follows: /** @type {Follow[]} */ ([\n    {\n      user:\n        \"qsgziGQS99sPUxV1CRwwRckn9cG6cJ3prbDsrbL7qko.oRbCaVKwJFQURWrS1pFhkfAzrkEvkQgBRIUz9uoWtrg\",\n      status: \"ok\",\n      private: false\n    }\n  ]),\n  /**\n   * Maps public key to posts/shared posts.\n   */\n  posts: /** @type {Record<string, Array<Post|SharedPost>>} */ ({})\n};\n\n/**\n * @returns {typeof INITIAL_STATE}\n */\nconst feed = (state = INITIAL_STATE, action) => {\n  switch (action.type) {\n    case ACTIONS.RESET_FOLLOWS: {\n      return INITIAL_STATE;\n    }\n    case ACTIONS.ADD_FOLLOW: {\n      const { data } = action;\n      const existingFollow = state.follows.find(\n        follow => data.user === follow.user\n      );\n\n      if (existingFollow) {\n        return {\n          ...state,\n          follows: state.follows.map(follow =>\n            follow.user === data.user ? data : follow\n          )\n        };\n      }\n\n      return {\n        ...state,\n        follows: [...state.follows, data]\n      };\n    }\n    case ACTIONS.REMOVE_FOLLOW: {\n      const { data } = action;\n      return {\n        ...state,\n        follows: state.follows.filter(follow => follow.user !== data)\n      };\n    }\n    case ACTIONS.UPDATE_FOLLOW: {\n      const { data } = action;\n\n      const follows = state.follows.map(follow => {\n        if (follow.user === data.key) {\n          return {\n            ...follow,\n            profile: data\n          };\n        }\n\n        return follow;\n      });\n\n      return {\n        ...state,\n        follows\n      };\n    }\n    case ACTIONS.ADD_USER_POST: {\n      const { data } = action;\n      /** @type {SharedPost} */\n      const receivedPost = data;\n      const authorId = receivedPost.authorId;\n      const userPosts = state.posts[authorId] ?? [];\n      const existingPostIndex = userPosts.findIndex(\n        post => receivedPost.id === post.id\n      );\n\n      const tmp = [...userPosts];\n\n      if (existingPostIndex !== -1) {\n        tmp[existingPostIndex] = receivedPost;\n      } else {\n        tmp.push(receivedPost);\n      }\n      return {\n        ...state,\n        posts: {\n          ...state.posts,\n          [authorId]: tmp\n        }\n      };\n    }\n    case ACTIONS.DELETE_USER_POST: {\n      const { id, authorId } = action.data;\n      const userPosts = (state.posts[authorId] ?? []).filter(\n        post => post.id !== id\n      );\n\n      return {\n        ...state,\n        posts: {\n          ...state.posts,\n          [authorId]: userPosts\n        }\n      };\n    }\n    case ACTIONS.LOAD_POSTS: {\n      const { data } = action;\n\n      return {\n        ...state,\n        posts: data\n      };\n    }\n    case ACTIONS.LOAD_SHARED_POST: {\n      const { data } = action;\n      const { id, sharerId } = data;\n      const userPosts = state.posts[sharerId] ?? [];\n      const updatedPosts = userPosts.map(post => {\n        if (post.id === id && post.type === \"shared\") {\n          return {\n            ...post,\n            originalPost: data\n          };\n        }\n\n        return post;\n      });\n\n      return {\n        ...state,\n        posts: {\n          ...state.posts,\n          [sharerId]: updatedPosts\n        }\n      };\n    }\n    default:\n      return state;\n  }\n};\n\nexport default feed;\n","import { v4 as uuidv4 } from \"uuid\";\nimport { ACTIONS } from \"../actions/EncryptionActions\";\n\nconst INITIAL_STATE = {\n  deviceId: uuidv4(),\n  userKeys: {},\n  hostKeys: {}\n};\n\nconst encryption = (state = INITIAL_STATE, action) => {\n  switch (action.type) {\n    case ACTIONS.SET_DEVICE_ID: {\n      const deviceId = action.data;\n      return {\n        ...state,\n        deviceId\n      };\n    }\n    case ACTIONS.ADD_USER_KEY_PAIR: {\n      const { hostId, keyPair } = action.data;\n      return { ...state, userKeys: { ...state.userKeys, [hostId]: keyPair } };\n    }\n    case ACTIONS.ADD_HOST_KEY: {\n      const { hostId, publicKey } = action.data;\n      return { ...state, hostKeys: { ...state.hostKeys, [hostId]: publicKey } };\n    }\n    default:\n      return state;\n  }\n};\n\nexport default encryption;\n","import * as Common from \"shock-common\";\nimport produce from \"immer\";\n\nimport { ACTIONS } from \"../actions/UserProfilesActions\";\nimport { ACTIONS as NODE_ACTIONS } from \"../actions/NodeActions\";\nimport { ACTIONS as CHAT_ACTIONS } from \"../actions/ChatActions\";\n/**\n * @typedef {import('../actions/ChatActions').LoadChatDataAction} LoadChatDataAction\n * @typedef {import(\"../actions/ChatActions\").LoadSentRequestsAction} LoadSentRequestsAction\n * @typedef {import('../actions/ChatActions').LoadReceivedRequestsAction} LoadReceivedRequestsAction\n * @typedef {import('../actions/ChatActions').SentRequestAction} SentRequestAction\n */\n\n/**\n * @typedef {Record<string, Common.User>} UserProfilesState\n */\n\n/**\n * @type {UserProfilesState}\n */\nconst INITIAL_STATE = {};\n\n/**\n * @param {UserProfilesState} state\n * @param {import('redux').AnyAction} action\n * @returns {UserProfilesState}\n */\nconst userProfiles = (state = INITIAL_STATE, action) => {\n  switch (action.type) {\n    case NODE_ACTIONS.SET_AUTHENTICATED_USER: {\n      const { publicKey } = action.data;\n      return {\n        ...state,\n        [publicKey]: {\n          ...Common.createEmptyUser(publicKey),\n          ...state[publicKey]\n        }\n      };\n    }\n    case ACTIONS.RESET_USER_PROFILES: {\n      return INITIAL_STATE;\n    }\n    case ACTIONS.LOAD_USER_PROFILE: {\n      const { publicKey, profile } = action.data;\n\n      if (!publicKey || !profile) {\n        return state;\n      }\n\n      return {\n        ...state,\n        [publicKey]: {\n          ...Common.createEmptyUser(publicKey),\n          ...state[publicKey],\n          ...profile\n        }\n      };\n    }\n    case ACTIONS.REMOVE_USER_PROFILE: {\n      const { publicKey } = action.data;\n      // Deletes the user profile property without mutating the state object\n      const { [publicKey]: deletedProfile, ...profiles } = state;\n\n      return profiles;\n    }\n    case ACTIONS.UPDATE_USER_PROFILE: {\n      const { publicKey, profile: newProfile } = action.data;\n      const oldProfile = state[publicKey];\n\n      if (!oldProfile || !newProfile) {\n        return state;\n      }\n\n      return {\n        ...state,\n        [publicKey]: {\n          ...Common.createEmptyUser(publicKey),\n          ...oldProfile,\n          ...newProfile\n        }\n      };\n    }\n    case CHAT_ACTIONS.LOAD_CHAT_DATA: {\n      return produce(state, draft => {\n        const { data } = /** @type {LoadChatDataAction} */ (action);\n\n        data.contacts.forEach(c => {\n          draft[c.pk] = {\n            ...Common.createEmptyUser(c.pk),\n            ...draft[c.pk]\n          };\n        });\n      });\n    }\n    case CHAT_ACTIONS.LOAD_RECEIVED_REQUESTS: {\n      return produce(state, draft => {\n        const { data } = /** @type {LoadReceivedRequestsAction} */ (action);\n\n        data.forEach(req => {\n          draft[req.pk] = {\n            ...Common.createEmptyUser(req.pk),\n            ...draft[req.pk]\n          };\n        });\n      });\n    }\n    case CHAT_ACTIONS.LOAD_SENT_REQUESTS: {\n      return produce(state, draft => {\n        const { data } = /** @type {LoadSentRequestsAction} */ (action);\n\n        data.forEach(req => {\n          draft[req.pk] = {\n            ...Common.createEmptyUser(req.pk),\n            ...draft[req.pk]\n          };\n        });\n      });\n    }\n    case CHAT_ACTIONS.SENT_REQUEST: {\n      return produce(state, draft => {\n        const { data: pk } = /** @type {SentRequestAction} */ (action);\n\n        if (!draft[pk]) {\n          draft[pk] = Common.createEmptyUser(pk);\n        }\n      });\n    }\n    default:\n      return state;\n  }\n};\n\nexport default userProfiles;\n","import { ACTIONS } from \"../actions/OrdersActions\";\n\nconst INITIAL_STATE = {\n  myServices: {},\n  services: {},\n  boughtServices: {}\n};\n\nconst orders = (state = INITIAL_STATE, action) => {\n  switch (action.type) {\n    case ACTIONS.ADD_MY_SERVICE: {\n      const { id, serviceInfo } = action.data;\n      const tmp = { ...state.myServices };\n      tmp[id] = serviceInfo;\n      return { ...state, myServices: tmp };\n    }\n    case ACTIONS.REMOVE_MY_SERVICE: {\n      const id = action.data;\n      const tmp = { ...state.myServices };\n      delete tmp[id];\n      return { ...state, myServices: tmp };\n    }\n    case ACTIONS.ADD_BOUGHT_SERVICE: {\n      const { orderAck, owner, serviceID } = action.data;\n      const servicesTmp = { ...state.boughtServices };\n\n      if (!servicesTmp[owner]) {\n        servicesTmp[owner] = {};\n      }\n      const selectedService = servicesTmp[owner];\n      if (!selectedService[serviceID]) {\n        selectedService[serviceID] = [];\n      }\n      selectedService[serviceID].push(orderAck);\n      return { ...state, boughtServices: servicesTmp };\n    }\n    default:\n      return state;\n  }\n};\n\nexport default orders;\n","import { combineReducers } from \"redux\";\nimport * as Common from \"shock-common\";\n\nimport NodeReducer from \"./NodeReducer\";\nimport AuthReducer from \"./AuthReducer\";\nimport WalletReducer from \"./WalletReducer\";\nimport ChatReducer from \"./ChatReducer\";\nimport DrawerReducer from \"./DrawerReducer\";\nimport ContentReducer from \"./ContentReducer\";\nimport FeesReducer from \"./FeesReducer\";\nimport FeedReducer from \"./FeedReducer\";\nimport EncryptionReducer from \"./EncryptionReducer\";\nimport UserProfilesReducer from \"./UserProfilesReducer\";\nimport OrdersReducer from \"./OrdersReducer\";\n\nconst reducers = combineReducers({\n  node: NodeReducer,\n  auth: AuthReducer,\n  encryption: EncryptionReducer,\n  wallet: WalletReducer,\n  chat: ChatReducer,\n  drawer: DrawerReducer,\n  content: ContentReducer,\n  fees: FeesReducer,\n  feed: FeedReducer,\n  userProfiles: UserProfilesReducer,\n  orders: OrdersReducer,\n  users: () => {\n    return {} as Record<string, Common.User>;\n  }\n});\n\nexport type State = ReturnType<typeof reducers>;\n\nexport default reducers;\n","import PeerMigration from \"./PeerMigration\";\n\nconst Migrations = {\n  1: PeerMigration\n};\n\nexport default Migrations;\n","const PeerMigration = state => {\n  console.log(\"--- PeerMigration Started ---\");\n  const newState = {\n    ...state,\n    wallet: {\n      ...state.wallet,\n      peers: []\n    }\n  };\n  console.log(\"--- PeerMigration Ended ---\", newState);\n  return newState;\n};\n\nexport default PeerMigration;\n","import { State } from \"../../reducers\";\n\nexport const selectSelfPublicKey = (state: State): string =>\n  state.node.publicKey;\n\nexport const isAuth = (state: State): boolean => !!state.node.publicKey;\n\nexport const selectHost = (state: State): string => state.node.hostIP;\n","import { Schema } from \"shock-common\";\n\nimport { State } from \"../../reducers\";\n\nimport { selectSelfPublicKey } from \"./auth\";\n\nexport const selectSelfUser = (state: State) => {\n  const selfPublicKey = selectSelfPublicKey(state);\n  const maybeUser = state.userProfiles[selfPublicKey];\n  if (maybeUser) {\n    return maybeUser;\n  } else {\n    console.error(\"No self user created at auth?\");\n    return Schema.createEmptyUser(selfPublicKey);\n  }\n};\n\nexport const selectUser = (publicKey: string) => (\n  state: State\n): Schema.User => {\n  const maybeUser = state.userProfiles[publicKey];\n\n  if (maybeUser) {\n    return maybeUser;\n  } else {\n    return Schema.createEmptyUser(publicKey);\n  }\n};\n\nexport const selectAllPublicKeys = (state: State): string[] => {\n  return Object.keys(state.userProfiles);\n};\n\nexport const selectAllOtherPublicKeys = (state: State): string[] => {\n  const selfPublicKey = selectSelfPublicKey(state);\n  return selectAllPublicKeys(state).filter(key => key !== selfPublicKey);\n};\n","import { State } from \"../../reducers\";\n\nexport const selectFollows = (state: State) => state.feed.follows;\n","import { State } from \"../../reducers\";\n\nexport const selectOwnPublishedContent = (state: State) =>\n  state.content.publishedContent;\n","import {\n  useSelector as originalUseSelector,\n  TypedUseSelectorHook\n} from \"react-redux\";\n\nimport { State } from \"../../reducers\";\n\nexport const useSelector: TypedUseSelectorHook<State> = (selector, eqFn) =>\n  originalUseSelector(selector, eqFn);\n\nexport const selectRoot = (state: State) => state;\n\nexport const selectIsInContact = (publicKey: string) => (\n  state: State\n): boolean => {\n  const {\n    chat: { contacts, sentRequests, receivedRequests }\n  } = state;\n\n  const isContact = !!contacts.find(c => c.pk === publicKey);\n  const hasSentReq = !!sentRequests.find(r => r.pk === publicKey);\n  const hasReceivedReq = !!receivedRequests.find(r => r.pk === publicKey);\n\n  return isContact || hasSentReq || hasReceivedReq;\n};\n\nexport * from \"./auth\";\nexport * from \"./users\";\nexport * from \"./follows\";\nexport * from \"./publishedContent\";\n","import { createStore, applyMiddleware, compose, AnyAction } from \"redux\";\nimport thunk from \"redux-thunk\";\nimport rootReducer, { State } from \"../reducers\";\nimport { useSelector as origUseSelector } from \"react-redux\";\nimport { persistStore, persistReducer } from \"redux-persist\";\nimport storage from \"redux-persist/lib/storage\"; // defaults to localStorage for web\nimport Migrations from \"./Migrations\";\nimport createMigrate from \"redux-persist/es/createMigrate\";\nimport autoMergeLevel2 from \"redux-persist/es/stateReconciler/autoMergeLevel2\";\n\nconst persistConfig = {\n  key: \"root\",\n  storage,\n  blacklist: [\"auth\"],\n  version: 1,\n  stateReconciler: autoMergeLevel2,\n  migrate: createMigrate(Migrations, {\n    debug: process.env.NODE_ENV === \"development\"\n  })\n};\n\nconst persistedReducer = persistReducer<State, AnyAction>(\n  persistConfig,\n  rootReducer\n);\n\nconst initializeStore = () => {\n  const appliedMiddleware = applyMiddleware(thunk);\n  // @ts-expect-error\n  const store = window.__REDUX_DEVTOOLS_EXTENSION__\n    ? createStore(\n        persistedReducer,\n        // @ts-expect-error\n        compose(appliedMiddleware, window.__REDUX_DEVTOOLS_EXTENSION__())\n      )\n    : createStore(persistedReducer, appliedMiddleware);\n  let persistor = persistStore(store);\n  return { store, persistor };\n};\n\nconst initializedStore = initializeStore();\n\nexport const store = initializedStore.store;\n\nexport const persistor = initializedStore.persistor;\n\n/**\n * React-redux 's useSelector with our state type pre-specified.\n */\nexport const useSelector = <TSelected = unknown>(\n  selector: (state: State) => TSelected\n): TSelected => origUseSelector<State, TSelected>(selector);\n\nexport * from \"./selectors\";\n","import SocketIO from \"socket.io-client\";\nimport binaryParser from \"socket.io-msgpack-parser\";\nimport * as Common from \"shock-common\";\nimport * as Encryption from \"./Encryption\";\nimport { initialMessagePrefix } from \"../utils/String\";\nimport { setAuthenticated } from \"../actions/AuthActions\";\nimport { connectHost } from \"../actions/NodeActions\";\n/**\n * @typedef {import('../schema').Contact} Contact\n */\n\nconst options = {\n  reconnection: true,\n  rejectUnauthorized: false,\n  parser: binaryParser,\n  withCredentials: true,\n  transports: [\"websocket\"]\n};\n\nconst rifleSubscriptions = new Map();\n\nexport let GunSocket = null;\n\nexport let LNDSocket = null;\n\nexport const connectSocket = async (host = \"\", reconnect = false) => {\n  if (GunSocket && LNDSocket && !reconnect) {\n    return { GunSocket, LNDSocket };\n  }\n\n  if (GunSocket && LNDSocket && reconnect) {\n    disconnectSocket(GunSocket);\n    disconnectSocket(LNDSocket);\n  }\n\n  const { store } = await import(\"../store\");\n  const socketOptions = {\n    ...options,\n    auth: {\n      encryptionId: store.getState().encryption.deviceId\n    }\n  };\n  GunSocket = SocketIO.connect(`${host}/gun`, socketOptions);\n  LNDSocket = SocketIO.connect(`${host}/lndstreaming`, socketOptions);\n\n  const GunOn = encryptedOn(GunSocket);\n\n  // Subscribe to Rifle query events as soon as the socket is connected\n  GunOn(\"query:data\", event => {\n    const subscription = rifleSubscriptions.get(event.subscriptionId);\n\n    if (subscription) {\n      subscription.onData?.(event.response.data, event.response.key);\n    }\n  });\n\n  GunOn(\"query:error\", event => {\n    const subscription = rifleSubscriptions.get(event.subscriptionId);\n\n    if (subscription) {\n      subscription.onError?.(event.response.data, event.response.key);\n    }\n  });\n\n  GunSocket.on(Common.NOT_AUTH, () => {\n    store.dispatch(setAuthenticated(false));\n  });\n\n  GunSocket.on(\"encryption:error\", async err => {\n    if (err.field === \"deviceId\") {\n      const cachedNodeIP = store.getState().node.hostIP;\n      await store.dispatch(connectHost(cachedNodeIP, false));\n      store.dispatch(setAuthenticated(false));\n    }\n  });\n\n  return { GunSocket, LNDSocket };\n};\n\nexport const disconnectSocket = socket => {\n  socket.off(\"*\");\n  socket.close();\n};\n\nconst decryptEventCallback = async ({ err, data, callback, privateKey }) => {\n  if (\n    (err && !Encryption.isEncryptedMessage(err)) ||\n    (data && !Encryption.isEncryptedMessage(data))\n  ) {\n    callback(err, data);\n    return;\n  }\n\n  if (err) {\n    const decryptedMessage = await Encryption.decryptMessage({\n      privateKey,\n      encryptedMessage: err\n    });\n\n    callback(decryptedMessage, data);\n    return;\n  }\n\n  if (data) {\n    const decryptedMessage = await Encryption.decryptMessage({\n      privateKey,\n      encryptedMessage: data\n    });\n\n    callback(err, decryptedMessage);\n    return;\n  }\n};\n\nconst encryptedEmit = socket => async (eventName, message, callback) => {\n  // TODO: remove circular dep\n  const { store } = await import(\"../store\");\n  const { hostKeys, userKeys } = store.getState().encryption;\n  const { hostId } = store.getState().node;\n\n  if (Encryption.isNonEncrypted(eventName)) {\n    socket.emit(eventName, message, callback);\n    return;\n  }\n\n  const remotePublicKey = hostKeys[hostId];\n  const localPrivateKey = userKeys[hostId]?.privateKey;\n\n  if (!remotePublicKey || !localPrivateKey) {\n    console.error(\"[WS] Unable to retrieve key for specified Host ID:\", hostId);\n\n    return;\n  }\n\n  const encryptedData = await (message\n    ? Encryption.encryptMessage({\n        publicKey: remotePublicKey,\n        message: JSON.stringify(message)\n      })\n    : null);\n\n  socket.emit(eventName, encryptedData, (err, data) => {\n    decryptEventCallback({\n      err,\n      data,\n      callback,\n      privateKey: localPrivateKey\n    });\n  });\n};\n\nconst encryptedOn = socket => async (eventName, callback) => {\n  // TODO: remove circular dep\n  const { store } = await import(\"../store\");\n  const { userKeys } = store.getState().encryption;\n  const { hostId } = store.getState().node;\n\n  if (Encryption.isNonEncrypted(eventName)) {\n    socket.on(eventName, callback);\n    return;\n  }\n\n  const localPrivateKey = userKeys[hostId]?.privateKey;\n\n  if (!localPrivateKey) {\n    console.error(\"[WS] Unable to retrieve key for specified Host ID:\", hostId);\n\n    return;\n  }\n\n  socket.on(eventName, async (...responses) => {\n    const decryptedResponses = await Promise.all(\n      responses.map(async response => {\n        if (!response) {\n          return response;\n        }\n\n        if (response && !Encryption.isEncryptedMessage(response)) {\n          console.warn(\"Non-encrypted socket message\", response);\n          return response;\n        }\n\n        return Encryption.decryptMessage({\n          privateKey: localPrivateKey,\n          encryptedMessage: response\n        });\n      })\n    );\n\n    callback(...decryptedResponses);\n  });\n};\n\nconst subscribeSocket = ({ eventName, callback }) =>\n  new Promise((resolve, reject) => {\n    try {\n      import(\"../store\").then(({ store }) => {\n        const on = encryptedOn(GunSocket);\n        const emit = encryptedEmit(GunSocket);\n\n        emit(\n          `subscribe:${eventName}`,\n          {\n            token: store.getState().node.authToken\n          },\n          err => {\n            if (err) {\n              console.error(err);\n              reject(err);\n              return;\n            }\n          }\n        );\n\n        on(eventName, data => {\n          if (callback) {\n            callback(null, data);\n            return;\n          }\n          resolve(data);\n        });\n      });\n    } catch (err) {\n      console.error(err);\n    }\n  });\n\nexport const unsubscribeRifleById = subscriptionId => {\n  const cachedSocket = rifleSubscriptions.get(subscriptionId);\n\n  if (cachedSocket) {\n    unsubscribeEvent(subscriptionId);\n    rifleSubscriptions.delete(subscriptionId);\n  }\n};\n\nexport const unsubscribeRifleByQuery = query => {\n  const subscriptionEntries = Array.from(rifleSubscriptions.entries());\n\n  subscriptionEntries.map(([id, subscription]) => {\n    if (subscription.query === query) {\n      console.log(\"Unsubscribing by query:\", subscription);\n      unsubscribeRifleById(id);\n      return true;\n    }\n\n    return false;\n  });\n};\n\nexport const unsubscribeEvent = subscriptionId =>\n  new Promise(resolve => {\n    const emit = encryptedEmit(GunSocket);\n    emit(\n      \"unsubscribe\",\n      {\n        subscriptionId\n      },\n      () => {\n        console.debug(\n          `[SOCKET] Unsubscribed from event successfully! (${subscriptionId})`\n        );\n        resolve(true);\n      }\n    );\n  });\n\nexport const rifleSocketExists = subscriptionId => {\n  const cachedSocket = rifleSubscriptions.get(subscriptionId);\n  return !!cachedSocket;\n};\n\n/**\n * @typedef {object} RifleParams\n * @prop {string} query\n * @prop {string=} publicKey Alias for publicKeyForDecryption\n * @prop {boolean=} reconnect\n * @prop {(data, key) => void} onData\n * @prop {((error) => void)=} onError\n */\n\n/**\n * Returns a socket wired up to the given query. Use `.onData(callback)` for values.\n * Please do not forget to listen to the NOT_AUTH event and react accordingly.\n * Query example:\n * ```js\n * rifle(`$user::Profile>displayName::on`)\n * // results in:\n * gun.user().get('Profile').get('displayName').on(...)\n *\n * const pk = '....'\n * rifle(`${pk}::Profile::map.once`)\n * // results in:\n * gun.user(pk).get('Profile').get('displayName').map().once(...)\n *\n * rifle(`$gun::handshakeNodes::on`)\n * // results in:\n * gun.get('handshakeNodes').on(...)\n * ```\n * @param {RifleParams} args\n * @returns {Promise<{ off: () => void }>}\n */\nexport const rifle = ({ query, publicKey, reconnect, onData, onError }) =>\n  new Promise((resolve, reject) => {\n    import(\"../store\").then(({ store }) => {\n      if (reconnect) {\n        unsubscribeRifleByQuery(query);\n      }\n\n      const emit = encryptedEmit(GunSocket);\n\n      emit(\n        \"subscribe:query\",\n        {\n          $shock: query,\n          token: store.getState().node.authToken,\n          publicKey\n        },\n        (err, data) => {\n          if (err) {\n            console.error(`Gun rifle error (${query})`);\n            console.error(err);\n            reject(err);\n            return;\n          }\n\n          rifleSubscriptions.set(data.subscriptionId, {\n            onData,\n            onError,\n            query\n          });\n\n          resolve({\n            off: () => unsubscribeRifleById(data.subscriptionId)\n          });\n        }\n      );\n    });\n  });\n\n/**\n *\n * @param {Promise<() => void>} subscription\n */\nexport const rifleCleanup = (...subscriptions) => () => {\n  subscriptions.map(subscription =>\n    subscription.then(unsubscribe => {\n      unsubscribe.off();\n    })\n  );\n};\n\n/**\n * @returns {{ messages: any , contacts: Contact[]}}\n */\nexport const getChats = async ({ authToken }) => {\n  try {\n    const chats = await subscribeSocket({ authToken, eventName: \"chats\" });\n\n    const contacts = chats.map(chat => ({\n      pk: chat.recipientPublicKey,\n      avatar: chat.recipientAvatar,\n      displayName: chat.recipientDisplayName,\n      didDisconnect: chat.didDisconnect\n    }));\n\n    const messages = chats.reduce(\n      (messages, chat) => ({\n        ...messages,\n        [chat.recipientPublicKey]: chat.messages\n          ?.filter(\n            message =>\n              message.body &&\n              message.body.trim() &&\n              message.body !== initialMessagePrefix\n          )\n          .sort((a, b) => b.timestamp - a.timestamp)\n      }),\n      {}\n    );\n\n    return {\n      contacts,\n      messages\n    };\n  } catch (err) {\n    console.error(err);\n    throw err;\n  }\n};\n\nexport const getSentRequests = async ({ hostIP, authToken }, callback) => {\n  try {\n    const sentRequests = await subscribeSocket({\n      hostIP,\n      authToken,\n      eventName: \"sentRequests\",\n      callback\n    });\n\n    return sentRequests;\n  } catch (err) {\n    console.error(err);\n  }\n};\n\nexport const getReceivedRequests = async ({ hostIP, authToken }, callback) => {\n  try {\n    const receivedRequests = await subscribeSocket({\n      hostIP,\n      authToken,\n      eventName: \"receivedRequests\",\n      callback\n    });\n\n    return receivedRequests.map(request => ({\n      id: request.id,\n      pk: request.recipientPublicKey,\n      avatar: request.recipientAvatar,\n      displayName: request.recipientDisplayName,\n      changedAddress: request.recipientChangedRequestAddress,\n      timestamp: request.timestamp\n    }));\n  } catch (err) {\n    console.error(err);\n  }\n};\n","export const ACTIONS = {\n  RESET_AUTH_INFO: \"auth/reset\",\n  SET_AUTH_STEP: \"auth/step/set\",\n  SET_AUTHENTICATED: \"auth/authenticated/set\",\n  SET_AUTH_METHOD: \"auth/method/set\",\n  LOGOUT: \"auth/logout\"\n};\n\nexport const setAuthenticated = status => dispatch => {\n  dispatch({\n    type: ACTIONS.SET_AUTHENTICATED,\n    data: status\n  });\n};\n\nexport const setAuthStep = step => dispatch => {\n  dispatch({\n    type: ACTIONS.SET_AUTH_STEP,\n    data: step\n  });\n};\n\nexport const setAuthMethod = method => dispatch => {\n  dispatch({\n    type: ACTIONS.SET_AUTH_METHOD,\n    data: method\n  });\n};\n\nexport const logout = () => ({\n  type: ACTIONS.LOGOUT\n});\n","// @ts-check\nimport Http from \"../utils/Http\";\nimport { DateTime } from \"luxon\";\nimport { v4 as uuidv4 } from \"uuid\";\n/**\n * @typedef {import('shock-common').Message} RawMessage\n */\n\nimport {\n  getChats,\n  getReceivedRequests,\n  getSentRequests,\n  rifle\n} from \"../utils/WebSocket\";\nimport { initialMessagePrefix } from \"../utils/String\";\nimport * as Schema from \"../schema\";\n/**\n * @typedef {import('../schema').Contact} Contact\n * @typedef {import('../schema').SentRequest} SentRequest\n * @typedef {import(\"../schema\").ReceivedRequest} ReceivedRequest\n * @typedef {import('../schema').ChatMessage} ChatMessage\n */\n\nexport const ACTIONS = {\n  LOAD_CHAT_DATA: /** @type {\"chat/loadData\"} */ (\"chat/loadData\"),\n  LOAD_SENT_REQUESTS: /** @type {\"chat/loadSentRequests\"} */ (\"chat/loadSentRequests\"),\n  LOAD_RECEIVED_REQUESTS: /** @type {\"chat/loadReceivedRequests\"} */ (\"chat/loadReceivedRequests\"),\n  SET_CHAT_CONTACTS: \"chat/contacts\",\n  SET_CHAT_MESSAGES: \"chat/messages\",\n  SENT_REQUEST: /** @type {\"chat/request/sent\"} */ (\"chat/request/sent\"),\n  ACCEPT_HANDSHAKE_REQUEST: \"chat/request/accept\",\n  DECLINE_HANDSHAKE_REQUEST: \"chat/request/decline\",\n  SENDING_MESSAGE: \"chat/message/sending\",\n  SENT_MESSAGE: \"chat/message/sent\",\n  FAILED_MESSAGE: \"chat/message/failed\",\n  RECEIVED_MESSAGE: /** @type {\"chat/message/received\"} */ (\"chat/message/received\"),\n  CHAT_WAS_DELETED: /** @type {'chat/deleted'} */ (\"chat/deleted\")\n};\n\n/**\n * @typedef {object} SentRequestAction\n * @prop {typeof ACTIONS.SENT_REQUEST} type\n * @prop {string} data The public key.\n */\n\n/**\n * @typedef {object} LoadChatDataAction\n * @prop {typeof ACTIONS.LOAD_CHAT_DATA} type\n * @prop {{ messages: Record<string, ChatMessage[]> , contacts: Contact[] }} data\n */\n\n/**\n * @typedef {object} LoadSentRequestsAction\n * @prop {typeof ACTIONS.LOAD_SENT_REQUESTS} type\n * @prop {SentRequest[]} data\n */\n\n/**\n * @typedef {object} LoadReceivedRequestsAction\n * @prop {typeof ACTIONS.LOAD_RECEIVED_REQUESTS} type\n * @prop {ReceivedRequest[]} data\n */\n\n/**\n * @typedef {object} ReceivedMessageAction\n * @prop {typeof ACTIONS.RECEIVED_MESSAGE} type\n * @prop {ChatMessage} data\n */\n\nexport const loadChatData = () => async (dispatch, getState) => {\n  const { authToken } = getState().node;\n  const data = await getChats({ authToken });\n  console.log(\"LOAD_CHAT_DATA:\", data);\n\n  dispatch({\n    type: ACTIONS.LOAD_CHAT_DATA,\n    data\n  });\n};\n\nexport const loadSentRequests = () => (dispatch, getState) => {\n  const { hostIP, authToken } = getState().node;\n  getSentRequests({ hostIP, authToken }, (err, sentRequests) => {\n    if (err) {\n      console.error(err);\n      return;\n    }\n\n    console.log(\"sentRequests:\", sentRequests);\n\n    /** @type {LoadSentRequestsAction} */\n    const action = {\n      type: ACTIONS.LOAD_SENT_REQUESTS,\n      data: sentRequests.map(request => {\n        /** @type {SentRequest} */\n        const req = {\n          id: request.id,\n          pk: request.recipientPublicKey,\n          avatar: request.recipientAvatar,\n          displayName: request.recipientDisplayName,\n          changedAddress: request.recipientChangedRequestAddress,\n          timestamp: request.timestamp,\n          loading: false\n        };\n\n        return req;\n      })\n    };\n\n    dispatch(action);\n  });\n};\n\nexport const loadReceivedRequests = () => (dispatch, getState) => {\n  const { hostIP, authToken } = getState().node;\n  getReceivedRequests({ hostIP, authToken }, (err, receivedRequests) => {\n    if (err) {\n      console.error(err);\n      return;\n    }\n\n    console.log(\"receivedRequests:\", receivedRequests);\n\n    /** @type {LoadReceivedRequestsAction} */\n    const action = {\n      type: ACTIONS.LOAD_RECEIVED_REQUESTS,\n      data: receivedRequests.map(request => {\n        /** @type {ReceivedRequest} */\n        const req = {\n          id: request.id,\n          pk: request.requestorPK,\n          avatar: request.requestorAvatar,\n          displayName: request.requestorDisplayName,\n          timestamp: request.timestamp\n        };\n\n        return req;\n      })\n    };\n\n    dispatch(action);\n  });\n};\n\nexport const subscribeChatMessages = (\n  userPublicKey,\n  recipientPublicKey\n) => async dispatch => {\n  const { data: incomingId } = await Http.get(\n    `/api/gun/user/once/userToIncoming>${recipientPublicKey}`,\n    {\n      headers: {\n        \"public-key-for-decryption\": userPublicKey\n      }\n    }\n  );\n\n  if (!incomingId.data) {\n    console.warn(\"Unable to retrieve incoming ID for selected contact\");\n    return null;\n  }\n\n  const incomingMessages = await rifle({\n    query: `${recipientPublicKey}::outgoings>${incomingId.data}>messages::map.on`,\n    publicKey: recipientPublicKey,\n    onData: (message, id) => {\n      if (!message.body || message.body === initialMessagePrefix) {\n        return;\n      }\n      /** @type {RawMessage} */\n      const rawMsg = message;\n\n      /** @type {ChatMessage} */\n      const msg = {\n        body: rawMsg.body,\n        id,\n        localId: id,\n        outgoing: false,\n        recipientPublicKey,\n        status: Schema.CHAT_MESSAGE_STATUS.SENT,\n        timestamp: rawMsg.timestamp\n      };\n\n      /** @type {ReceivedMessageAction} */\n      const action = {\n        type: ACTIONS.RECEIVED_MESSAGE,\n        data: msg\n      };\n\n      dispatch(action);\n    }\n  });\n\n  return incomingMessages;\n};\n\nexport const acceptHandshakeRequest = requestId => async dispatch => {\n  const { data } = await Http.put(`/api/gun/requests/${requestId}`, {\n    accept: true\n  });\n\n  dispatch({\n    type: ACTIONS.ACCEPT_HANDSHAKE_REQUEST,\n    data: requestId\n  });\n\n  return data;\n};\n\nexport const sendHandshakeRequest = publicKey => async (dispatch, getState) => {\n  const { data } = await Http.post(`/api/gun/requests`, {\n    publicKey\n  });\n\n  /** @type {SentRequest[]} */\n  const sentRequests = getState().chat.sentRequests;\n  const [userExists] = sentRequests.filter(request => request.pk === publicKey);\n\n  if (!userExists) {\n    /** @type {SentRequestAction} */\n    const action = {\n      type: ACTIONS.SENT_REQUEST,\n      data: publicKey\n    };\n    dispatch(action);\n  }\n\n  return data;\n};\n\nexport const sendMessage = ({\n  publicKey,\n  message,\n  localId = null\n}) => async dispatch => {\n  const tempId = localId ?? uuidv4();\n  try {\n    dispatch({\n      type: ACTIONS.SENDING_MESSAGE,\n      data: {\n        body: message,\n        localId: tempId,\n        timestamp: DateTime.utc().toMillis(),\n        recipientPublicKey: publicKey\n      }\n    });\n    const { data } = await Http.post(`/api/gun/chats/${publicKey}`, {\n      body: message\n    });\n    console.log(data);\n    dispatch({\n      type: ACTIONS.SENT_MESSAGE,\n      data: { ...data, localId: tempId, recipientPublicKey: publicKey }\n    });\n  } catch (err) {\n    dispatch({\n      type: ACTIONS.FAILED_MESSAGE,\n      data: {\n        body: message,\n        localId: tempId,\n        timestamp: DateTime.utc().toMillis(),\n        recipientPublicKey: publicKey\n      }\n    });\n  }\n};\n\n/**\n * @param {string} publicKey\n */\nexport const chatWasDeleted = publicKey => ({\n  type: ACTIONS.CHAT_WAS_DELETED,\n  data: {\n    publicKey\n  }\n});\n","import { createAction } from \"@reduxjs/toolkit\";\n\nimport Http from \"../utils/Http\";\nimport { rifle, unsubscribeRifleByQuery } from \"../utils/WebSocket\";\nimport { PublishedContent, isPublishedContent } from \"../schema\";\nimport { parseJson } from \"../utils\";\n\nexport const ACTIONS = {\n  SET_SEED_PROVIDER_PUB: \"content/setSeedProviderPub\",\n  SET_SEED_INFO: \"content/setSeedInfo\",\n\n  PUBLISHED_CONTENT_ADDED: \"content/publishedContentAdded\",\n  PUBLISHED_CONTENT_REMOVED: \"content/publishedContentRemoved\",\n\n  ADD_UNLOCKED_CONTENT: \"content/addUnlocked\",\n  ADD_STREAM: \"content/addStream\",\n  REMOVE_STREAM: \"content/removeStream\",\n  ADD_AVAILABLE_TOKEN: \"content/addToken\",\n  REMOVE_USED_TOKEN: \"content/removeToken\",\n  ADD_STREAM_TOKEN: \"content/addStreamToken\",\n  REMOVE_STREAM_TOKEN: \"content/removeStreamToken\"\n} as const;\n\nexport const setSeedProviderPub = pub => async dispatch => {\n  let value: string | Record<string, any> = {\n    $$__ENCRYPT__FOR: \"me\",\n    value: pub\n  };\n  if (!pub) {\n    value = \"\";\n  }\n  await Http.post(\"/api/gun/put\", {\n    path: \"$user>seedServiceProviderPubKey\",\n    value\n  });\n  dispatch({\n    type: ACTIONS.SET_SEED_PROVIDER_PUB,\n    data: pub\n  });\n};\nexport const setSeedInfo = (\n  seedUrl: string,\n  seedToken: string\n) => async dispatch => {\n  const cleanUrl = seedUrl.endsWith(\"/\") ? seedUrl.slice(0, -1) : seedUrl;\n  const infoS = JSON.stringify({ seedUrl: cleanUrl, seedToken });\n  await Http.post(\"/api/gun/put\", {\n    path: \"$user>seedServiceSeedData\",\n    value: {\n      $$__ENCRYPT__FOR: \"me\",\n      value: infoS\n    }\n  });\n  dispatch({\n    type: ACTIONS.SET_SEED_INFO,\n    data: { seedUrl: cleanUrl, seedToken }\n  });\n};\n\nexport const publishedContentAdded = createAction<{\n  content: PublishedContent;\n  res: { ok: boolean; id: string };\n}>(ACTIONS.PUBLISHED_CONTENT_ADDED);\n\nexport const addPublishedContent = (\n  content: PublishedContent\n) => async dispatch => {\n  const { data } = await Http.post<{ ok: boolean; id: string }>(\n    \"/api/gun/set\",\n    {\n      path: \"$user>publishedContent\",\n      value: {\n        $$__ENCRYPT__FOR: \"me\",\n        value: JSON.stringify(content)\n      }\n    }\n  );\n  dispatch(\n    publishedContentAdded({\n      content,\n      res: data\n    })\n  );\n  return data;\n};\n\nexport const publishedContentRemoved = createAction<{ id: string }>(\n  ACTIONS.PUBLISHED_CONTENT_REMOVED\n);\n\nexport const unlockContent = (amt, owner, postID) => async dispatch => {\n  const { data } = await Http.post(\"/api/lnd/unifiedTrx\", {\n    type: \"contentReveal\",\n    amt,\n    to: owner,\n    memo: \"\",\n    feeLimit: 500,\n    ackInfo: postID\n  });\n  const revealRes = JSON.parse(data.orderAck.response);\n  if (revealRes && revealRes.unlockedContents) {\n    for (const contentID in revealRes.unlockedContents) {\n      if (Object.hasOwnProperty.call(revealRes.unlockedContents, contentID)) {\n        const content = revealRes.unlockedContents[contentID];\n        dispatch({\n          type: ACTIONS.ADD_UNLOCKED_CONTENT,\n          data: { contentPath: `${owner}>posts>${postID}`, content }\n        });\n      }\n    }\n  }\n};\nexport const addStream = ({\n  seedToken,\n  liveToken,\n  streamUrl,\n  streamPostId,\n  streamContentId,\n  streamStatusUrl,\n  streamBroadcasterUrl\n}) => dispatch => {\n  dispatch({\n    type: ACTIONS.ADD_STREAM,\n    data: {\n      seedToken,\n      liveToken,\n      streamUrl,\n      streamPostId,\n      streamContentId,\n      streamStatusUrl,\n      streamBroadcasterUrl\n    }\n  });\n};\nexport const removeStream = () => dispatch => {\n  dispatch({\n    type: ACTIONS.REMOVE_STREAM\n  });\n};\nexport const addAvailableToken = (seedUrl, userToken) => dispatch => {\n  dispatch({\n    type: ACTIONS.ADD_AVAILABLE_TOKEN,\n    data: { seedUrl, userToken }\n  });\n};\nexport const removeUnavailableToken = (seedUrl, userToken) => dispatch => {\n  dispatch({\n    type: ACTIONS.REMOVE_USED_TOKEN,\n    data: { seedUrl, userToken }\n  });\n};\nexport const addStreamToken = (seedUrl, userToken) => dispatch => {\n  dispatch({\n    type: ACTIONS.ADD_STREAM_TOKEN,\n    data: { seedUrl, userToken }\n  });\n};\nexport const removeStreamToken = (seedUrl, userToken) => dispatch => {\n  dispatch({\n    type: ACTIONS.REMOVE_STREAM_TOKEN,\n    data: { seedUrl, userToken }\n  });\n};\n\nconst OWN_PUBLISHED_CONTENT_QUERY = \"$user::publishedContent::map.on\";\n\nexport const subOwnPublishedContent = () => async (\n  dispatch: (action: any) => void,\n  getState: () => { node: { publicKey: string } }\n) => {\n  console.debug(`Subscribing to own published content`);\n  const subscription = await rifle({\n    query: OWN_PUBLISHED_CONTENT_QUERY,\n    reconnect: true,\n    publicKey: getState().node.publicKey,\n    onData: async (content: string, key) => {\n      try {\n        console.debug(`Received own content:`);\n        console.debug(content);\n\n        if (typeof key !== \"string\") {\n          throw new TypeError(`Invalid content key received: ${key}`);\n        }\n\n        if (!content) {\n          dispatch(\n            publishedContentRemoved({\n              id: key\n            })\n          );\n          return;\n        }\n\n        if (typeof content !== \"string\") {\n          throw new TypeError(`Invalid content received (${content})`);\n        }\n\n        const parsed = parseJson(content);\n\n        if (!isPublishedContent(parsed)) {\n          throw new TypeError(\n            `Invalid content received (might be incomplete replication): ${JSON.stringify(\n              parsed,\n              null,\n              2\n            )}`\n          );\n        }\n\n        dispatch(\n          publishedContentAdded({\n            content: parsed,\n            res: {\n              id: key,\n              ok: true\n            }\n          })\n        );\n      } catch (e) {\n        console.error(`Error inside own published content sub:`);\n        console.error(e);\n      }\n    }\n  });\n\n  return subscription;\n};\n\nexport const unsubOwnPublishedContent = () => () => {\n  console.debug(`Unsubbing own published content.`);\n  unsubscribeRifleByQuery(OWN_PUBLISHED_CONTENT_QUERY);\n};\n","import Http from \"axios\";\n\nexport const ACTIONS = {\n  LOAD_BALANCE: \"wallet/balance/load\",\n  LOAD_USD_RATE: \"wallet/usdRate/load\",\n  LOAD_TRANSACTIONS: \"wallet/transactions/load\",\n  LOAD_MORE_TRANSACTIONS: \"wallet/transactions/loadMore\",\n  LOAD_CHANNELS: \"wallet/channels/load\",\n  LOAD_INVOICES: \"wallet/invoices/load\",\n  LOAD_MORE_INVOICES: \"wallet/invoices/loadMore\",\n  LOAD_PAYMENTS: \"wallet/payments/load\",\n  LOAD_MORE_PAYMENTS: \"wallet/payments/loadMore\",\n  LOAD_PEERS: \"wallet/peers/load\",\n  ADD_PEER: \"wallet/peers/add\",\n  REMOVE_PEER: \"wallet/peers/remove\",\n  LOAD_RECENT_TRANSACTIONS: \"wallet/recentTransactions/load\",\n  RESET_RECENT_TRANSACTIONS: \"wallet/recentTransactions/reset\",\n  LOAD_LIGHTNING_INFO: \"wallet/lightningInfo/load\",\n};\n\nexport const fetchWalletBalance = () => async dispatch => {\n  try {\n    const { data } = await Http.get(`/api/lnd/balance`);\n\n    dispatch({\n      type: ACTIONS.LOAD_BALANCE,\n      data: {\n        channelBalance: data.channel_balance,\n        confirmedBalance: data.confirmed_balance,\n        pendingChannelBalance: data.pending_channel_balance\n      }\n    });\n  } catch (e) {\n    console.error(\n      `When trying to fetch the balance for the wallet, an error ocurred:`,\n      e\n    );\n  }\n};\n\nexport const fetchUSDRate = () => async dispatch => {\n  try {\n    const { data } = await Http.get(\n      \"https://api.coinbase.com/v2/prices/spot?currency=USD\"\n    );\n    const exchangeRate = data.data.amount.replace(/,/g, \"\");\n\n    dispatch({\n      type: ACTIONS.LOAD_USD_RATE,\n      data: exchangeRate\n    });\n  } catch (e) {\n    console.error(`An error happened when trying to fetch the USD rate:`, e);\n  }\n};\n\nexport const fetchTransactions = ({\n  page,\n  itemsPerPage = 10,\n  reset = false\n}) => async (dispatch, getState) => {\n  try {\n    const { transactions } = getState().wallet;\n\n    if (\n      (transactions.page >= page && !reset) ||\n      transactions.totalPages < page\n    ) {\n      return;\n    }\n\n    const { data } = await Http.get(\"/api/lnd/transactions\", {\n      params: {\n        page,\n        itemsPerPage\n      }\n    });\n\n    dispatch({\n      type: reset ? ACTIONS.LOAD_TRANSACTIONS : ACTIONS.LOAD_MORE_TRANSACTIONS,\n      data\n    });\n  } catch (e) {\n    console.error(\n      `An error ocurred when fetching transactions (fetchTransactions()):`,\n      e\n    );\n  }\n};\n\nexport const fetchChannels = () => async dispatch => {\n  try {\n    const { data } = await Http.get(\"/api/lnd/listchannels\");\n\n    dispatch({\n      type: ACTIONS.LOAD_CHANNELS,\n      data: data.channels\n    });\n  } catch (e) {\n    console.error(\n      `An ocurred ocurred when fetching channels (fetchChannels()):`,\n      e\n    );\n  }\n};\n\nexport const fetchPeers = () => async dispatch => {\n  try {\n    const { data } = await Http.get(\"/api/lnd/listpeers\");\n\n    dispatch({\n      type: ACTIONS.LOAD_PEERS,\n      data: data.peers\n    });\n\n    return data;\n  } catch (e) {\n    console.error(\n      `An error ocurred while fetching peers (fetchPeers()) (will be re-thrown):`,\n      e\n    );\n    throw e;\n  }\n};\n\nexport const fetchInvoices = ({\n  page,\n  itemsPerPage = 10,\n  reset = false\n}) => async (dispatch, getState) => {\n  try {\n    const { invoices } = getState().wallet;\n\n    if ((invoices.page >= page && !reset) || invoices.totalPages < page) {\n      return;\n    }\n\n    const { data } = await Http.get(\"/api/lnd/invoices\", {\n      params: {\n        page,\n        itemsPerPage\n      }\n    });\n\n    dispatch({\n      type: reset ? ACTIONS.LOAD_INVOICES : ACTIONS.LOAD_MORE_INVOICES,\n      data\n    });\n  } catch (e) {\n    console.error(\n      `An error ocurred while fetching invoices (fetchInvoices()):`,\n      e\n    );\n  }\n};\n\nconst fetchPayments = ({ page, itemsPerPage = 10, reset = false }) => async (\n  dispatch,\n  getState\n) => {\n  try {\n    const { payments } = getState().wallet;\n\n    if ((payments.page >= page && !reset) || payments.totalPages < page) {\n      return;\n    }\n\n    const { data } = await Http.get(\"/api/lnd/payments\", {\n      params: {\n        page,\n        itemsPerPage\n      }\n    });\n\n    dispatch({\n      type: reset ? ACTIONS.LOAD_PAYMENTS : ACTIONS.LOAD_MORE_PAYMENTS,\n      data\n    });\n  } catch (e) {\n    console.error(\n      `An error ocurred while fetching payments (fetchPayments()):`,\n      e\n    );\n  }\n};\n\nexport const fetchUnifiedTransactions = () => async dispatch => {\n  const { data } = await Http.get(\"/api/lnd/unifiedTrx\");\n\n  dispatch({\n    type: ACTIONS.LOAD_RECENT_TRANSACTIONS,\n    data\n  });\n\n  return data;\n};\n\nexport const connectPeer = ({ publicKey, host }) => async dispatch => {\n  try {\n    await Http.post(\"/api/lnd/connectpeer\", {\n      pubkey: publicKey,\n      host: host\n    });\n\n    const newPeer = {\n      pub_key: publicKey,\n      address: host,\n      bytes_sent: 0,\n      bytes_recv: 0,\n      sat_sent: 0,\n      sat_recv: 0,\n      inbound: false\n    };\n\n    dispatch({\n      type: ACTIONS.ADD_PEER,\n      data: newPeer\n    });\n  } catch (err) {\n    console.error(\n      `An error ocurred while connecting peer --| ${host} |-- with public key --| ${publicKey} |-- in connectPeer()`,\n      err\n    );\n    throw err?.response?.data ?? err;\n  }\n};\n\nexport const openChannel = ({\n  publicKey = \"\",\n  channelCapacity = 0,\n  pushAmount = 0\n}) => async (dispatch, getState) => {\n  try {\n    const { feeRates, rate } = getState().fees;\n    await Http.post(\"/api/lnd/openchannel\", {\n      pubkey: publicKey,\n      channelCapacity: channelCapacity.toString(),\n      channelPushAmount: pushAmount.toString(),\n      satPerByte: feeRates[rate]\n    });\n\n    dispatch(fetchChannels());\n  } catch (err) {\n    console.error(\n      `An error ocurred while opening a channel (openChannel()) with public key --| ${publicKey} |--, channel capacity: --| ${channelCapacity} |-- and push amount: --| ${pushAmount} |--:`,\n      err\n    );\n    throw err?.response?.data ?? err;\n  }\n};\n\nexport const FetchLightningInfo = () =>async dispatch => {\n  \n  try{\n    const {data}= await Http.get(\"/api/lnd/getinfo\");\n    dispatch({\n      type:ACTIONS.LOAD_LIGHTNING_INFO,\n      data\n    })\n  }catch (err) {\n    console.error(err);\n    throw err?.response?.data ?? err;\n  }\n}\n","export const safeParseJSON = (data: string): string | object => {\n  try {\n    const parsedJSON = JSON.parse(data);\n    return parsedJSON;\n  } catch (err) {\n    return data;\n  }\n};\n","import { Buffer } from \"buffer\";\nimport ECCrypto from \"eccrypto\";\nimport FieldError from \"./FieldError\";\nimport { safeParseJSON } from \"./JSON\";\n\ninterface EncryptedMessage {\n  ciphertext: Uint8Array;\n  ephemPublicKey: Uint8Array;\n  iv: Uint8Array;\n  mac: Uint8Array;\n}\n\ninterface EncryptedMessageResponse {\n  ciphertext: string;\n  ephemPublicKey: string;\n  iv: string;\n  mac: string;\n}\n\ninterface DeriveKey {\n  localPrivateKey: Uint8Array | string;\n  remotePublicKey: Uint8Array | string;\n}\n\ninterface EncryptMessageArgs {\n  publicKey: Uint8Array | string;\n  sharedKey: Uint8Array | string;\n  message: string;\n}\n\ninterface DecryptMessageArgs {\n  privateKey: Uint8Array | string;\n  encryptedMessage: EncryptedMessage;\n}\n\nconst nonEncryptedEvents = [\n  \"ping\",\n  \"disconnect\",\n  \"IS_GUN_AUTH\",\n  \"SET_LAST_SEEN_APP\",\n  \"NOT_AUTH\"\n];\n\nexport const convertUTF8ToBase64 = (value: string) => {\n  return Buffer.from(value, \"utf-8\").toString(\"base64\");\n};\n\nexport const convertBase64ToBuffer = (value: string) => {\n  return Buffer.from(value, \"base64\");\n};\n\nexport const convertUTF8ToBuffer = (value: string) => {\n  return Buffer.from(value, \"utf-8\");\n};\n\nexport const convertBufferToBase64 = (value: Uint8Array) => {\n  return Buffer.from(value).toString(\"base64\");\n};\n\nexport const processKey = (key: Uint8Array | string): Uint8Array => {\n  if (key instanceof Uint8Array) {\n    return key;\n  }\n\n  const convertedKey = convertBase64ToBuffer(key);\n  return convertedKey;\n};\n\nexport const convertToEncryptedMessageResponse = (\n  encryptedMessage: EncryptedMessage | EncryptedMessageResponse\n): EncryptedMessageResponse => {\n  if (\n    typeof encryptedMessage.ciphertext === \"string\" &&\n    typeof encryptedMessage.iv === \"string\" &&\n    typeof encryptedMessage.mac === \"string\" &&\n    typeof encryptedMessage.ephemPublicKey === \"string\"\n  ) {\n    // @ts-ignore\n    return encryptedMessage;\n  }\n\n  if (\n    encryptedMessage.ciphertext instanceof Uint8Array &&\n    encryptedMessage.iv instanceof Uint8Array &&\n    encryptedMessage.mac instanceof Uint8Array &&\n    encryptedMessage.ephemPublicKey instanceof Uint8Array\n  ) {\n    return {\n      ciphertext: convertBufferToBase64(encryptedMessage.ciphertext),\n      iv: convertBufferToBase64(encryptedMessage.iv),\n      mac: convertBufferToBase64(encryptedMessage.mac),\n      ephemPublicKey: convertBufferToBase64(encryptedMessage.ephemPublicKey)\n    };\n  }\n\n  throw new FieldError({\n    field: \"encryptedMessage\",\n    message: \"Unknown encrypted message format\"\n  });\n};\n\nexport const convertToEncryptedMessage = (\n  encryptedMessage: EncryptedMessage | EncryptedMessageResponse\n): EncryptedMessage => {\n  if (\n    encryptedMessage.ciphertext instanceof Uint8Array &&\n    encryptedMessage.iv instanceof Uint8Array &&\n    encryptedMessage.mac instanceof Uint8Array &&\n    encryptedMessage.ephemPublicKey instanceof Uint8Array\n  ) {\n    // @ts-ignore\n    return encryptedMessage;\n  }\n\n  if (\n    typeof encryptedMessage.ciphertext === \"string\" &&\n    typeof encryptedMessage.iv === \"string\" &&\n    typeof encryptedMessage.mac === \"string\" &&\n    typeof encryptedMessage.ephemPublicKey === \"string\"\n  ) {\n    return {\n      ciphertext: convertBase64ToBuffer(encryptedMessage.ciphertext),\n      iv: convertBase64ToBuffer(encryptedMessage.iv),\n      mac: convertBase64ToBuffer(encryptedMessage.mac),\n      ephemPublicKey: convertBase64ToBuffer(encryptedMessage.ephemPublicKey)\n    };\n  }\n\n  throw new FieldError({\n    field: \"encryptedMessage\",\n    message: \"Unknown encrypted message format\"\n  });\n};\n\nexport const isEncryptedMessage = (message: any) =>\n  message?.ciphertext && message?.iv && message?.mac && message?.ephemPublicKey;\n\nexport const isNonEncrypted = (eventName: string) =>\n  nonEncryptedEvents.includes(eventName) ||\n  process.env.REACT_APP_SHOCK_ENCRYPTION_ECC === \"false\";\n\nexport const generateKeyPair = () => {\n  const privateKey: Uint8Array = ECCrypto.generatePrivate();\n  const publicKey: Uint8Array = ECCrypto.getPublic(privateKey);\n\n  const privateKeyBase64 = convertBufferToBase64(privateKey);\n  const publicKeyBase64 = convertBufferToBase64(publicKey);\n\n  return {\n    privateKey,\n    publicKey,\n    privateKeyBase64,\n    publicKeyBase64\n  };\n};\n\nexport const deriveKey = async ({\n  localPrivateKey,\n  remotePublicKey\n}: DeriveKey) => {\n  const sharedKey: Uint8Array = await ECCrypto.derive(\n    processKey(localPrivateKey),\n    processKey(remotePublicKey)\n  );\n  const sharedKeyBase64 = convertBufferToBase64(sharedKey);\n\n  return { sharedKey, sharedKeyBase64 };\n};\n\nexport const encryptMessage = async ({\n  publicKey,\n  message = \"\"\n}: EncryptMessageArgs): Promise<EncryptedMessageResponse> => {\n  const processedPublicKey = processKey(publicKey);\n  const messageBuffer = convertUTF8ToBuffer(message);\n  const encryptedMessage: EncryptedMessage = await ECCrypto.encrypt(\n    processedPublicKey,\n    messageBuffer\n  );\n  const encryptedMessageResponse = {\n    ciphertext: encryptedMessage.ciphertext,\n    iv: encryptedMessage.iv,\n    mac: encryptedMessage.mac,\n    ephemPublicKey: encryptedMessage.ephemPublicKey\n  };\n\n  return convertToEncryptedMessageResponse(encryptedMessageResponse);\n};\n\nexport const decryptMessage = async ({\n  privateKey,\n  encryptedMessage\n}: DecryptMessageArgs): Promise<string | object> => {\n  const processedPrivateKey = processKey(privateKey);\n  const decryptedMessageBuffer: Uint8Array = await ECCrypto.decrypt(\n    processedPrivateKey,\n    convertToEncryptedMessage(encryptedMessage)\n  );\n  const decryptedMessage = Buffer.from(decryptedMessageBuffer).toString();\n  const parsedMessage = safeParseJSON(decryptedMessage);\n\n  return parsedMessage;\n};\n","// @ts-check\nimport jwtDecode from \"jwt-decode\";\nimport Http from \"axios\";\nimport { ACTIONS as AUTH_ACTIONS, setAuthenticated } from \"./AuthActions\";\nimport { parseError } from \"../utils/Error\";\nimport { throttledExchangeKeyPair } from \"./EncryptionActions\";\nimport { connectSocket } from \"../utils/WebSocket\";\n\nexport const ACTIONS = {\n  RESET_NODE_INFO: \"node/reset\",\n  SET_HOST_IP: \"node/hostIP\",\n  SET_HOST_ID: \"node/hostId\",\n  SET_AUTHENTICATED_USER: \"node/authenticatedUser\",\n  SET_CONNECTION_STATUS: \"node/connectionStatus\",\n  SET_NODE_HEALTH: \"node/health\",\n  SET_WEBCLIENT_PREFIX:'node/setWebClientPrefix'\n};\n\nexport const resetNodeInfo = () => dispatch => {\n  dispatch({\n    type: ACTIONS.RESET_NODE_INFO\n  });\n};\n\nexport const setHostId = hostId => dispatch => {\n  dispatch({\n    type: ACTIONS.SET_HOST_ID,\n    data: hostId\n  });\n};\n\nconst wait = ms => new Promise(r => setTimeout(r, ms));\n\nexport const fetchNodeHealth = hostIP => async dispatch => {\n  try {\n    const { data } = await Http.get(`${hostIP}/healthz`);\n    if (!data) {\n      throw new Error(\n        `NodeActions->fetchNodeHealth()->No data obtained from healthz endpoint`\n      );\n    }\n\n    if (data.APIStatus?.message) {\n      dispatch({\n        type: ACTIONS.SET_CONNECTION_STATUS,\n        data: true\n      });\n    }\n\n    return data;\n  } catch (err) {\n    console.log(`NodeActions->fetchNodeHealth()->Error encountered:`);\n    console.log(err);\n    dispatch({\n      type: ACTIONS.SET_CONNECTION_STATUS,\n      data: false\n    });\n  }\n};\n\nexport const fetchNodeUnlockStatus = () => async dispatch => {\n  const { data } = await Http.get(\"/api/lnd/wallet/status\");\n  const { walletExists, walletStatus } = data;\n\n  if (walletExists) {\n    dispatch({\n      type: AUTH_ACTIONS.SET_AUTH_STEP,\n      data: walletStatus === \"locked\" ? \"unlockWallet\" : \"gunAuth\"\n    });\n    return walletStatus;\n  }\n\n  dispatch({\n    type: AUTH_ACTIONS.SET_AUTH_STEP,\n    data: \"createWallet\"\n  });\n\n  return \"createWallet\";\n};\n\nexport const connectHost = (hostIP, resetData = true) => async dispatch => {\n  if (resetData) {\n    dispatch({\n      type: ACTIONS.RESET_NODE_INFO\n    });\n    dispatch({\n      type: AUTH_ACTIONS.RESET_AUTH_INFO\n    });\n  }\n  const done = async (host, health) => {\n    Http.defaults.baseURL = `${host}`;\n\n    dispatch({\n      type: ACTIONS.SET_HOST_IP,\n      data: host\n    });\n\n    await Promise.all([\n      dispatch(fetchNodeUnlockStatus()),\n      dispatch(throttledExchangeKeyPair())\n    ]);\n\n    connectSocket(host, true);\n  };\n\n  let nodeHealthHttps;\n  const sanitizedHostIP = hostIP.replace(/^http(s)?:\\/\\//, \"\");\n  try {\n    nodeHealthHttps = await fetchNodeHealth(`https://${sanitizedHostIP}`)(\n      dispatch\n    );\n    if (nodeHealthHttps) {\n      nodeHealthHttps.withProtocolHostIP = `https://${sanitizedHostIP}`;\n      await done(`https://${sanitizedHostIP}`, nodeHealthHttps);\n      return nodeHealthHttps;\n    }\n  } catch (e) {\n    console.log(e);\n  }\n\n  console.error(\"cannot establish https connection, will try http\");\n  const nodeHealth = await fetchNodeHealth(`http://${sanitizedHostIP}`)(\n    dispatch\n  );\n  nodeHealth.withProtocolHostIP = `http://${sanitizedHostIP}`;\n  await done(`http://${sanitizedHostIP}`, nodeHealth);\n  return nodeHealthHttps || nodeHealth;\n};\n\nexport const unlockWallet = ({ alias, password }) => async dispatch => {\n  try {\n    const { data } = await Http.post(\n      \"/api/lnd/auth\",\n      {\n        alias,\n        password\n      },\n      {\n        // Unlocking can take significantly longer than other endpoints\n        timeout: 30000\n      }\n    );\n\n    dispatch(setAuthenticated(true));\n    const decodedToken = jwtDecode(data.authorization);\n    dispatch({\n      type: ACTIONS.SET_AUTHENTICATED_USER,\n      data: {\n        alias: data.user.alias,\n        authToken: data.authorization,\n        publicKey: data.user.publicKey,\n        // @ts-expect-error\n        authTokenExpirationDate: decodedToken.exp\n      }\n    });\n    return data;\n  } catch (err) {\n    dispatch(setAuthenticated(false));\n    throw parseError(err);\n  }\n};\n\nexport const createAlias = ({ alias, password }) => async dispatch => {\n  try {\n    const { data } = await Http.post(\"/api/lnd/wallet/existing\", {\n      alias,\n      password\n    });\n\n    dispatch(setAuthenticated(true));\n    const decodedToken = jwtDecode(data.authorization);\n    dispatch({\n      type: ACTIONS.SET_AUTHENTICATED_USER,\n      data: {\n        alias: data.user.alias,\n        authToken: data.authorization,\n        publicKey: data.user.publicKey,\n        // @ts-expect-error\n        authTokenExpirationDate: decodedToken.exp\n      }\n    });\n    return data;\n  } catch (err) {\n    dispatch(setAuthenticated(false));\n    throw parseError(err);\n  }\n};\n\nexport const createWallet = ({ alias, password }) => async dispatch => {\n  try {\n    const { data } = await Http.post(\n      \"/api/lnd/wallet\",\n      {\n        alias,\n        password\n      },\n      {\n        // Creating a wallet can take longer than any other endpoints.\n        timeout: 30000\n      }\n    );\n\n    dispatch(setAuthenticated(true));\n    const decodedToken = jwtDecode(data.authorization);\n    dispatch({\n      type: ACTIONS.SET_AUTHENTICATED_USER,\n      data: {\n        alias: data.user.alias,\n        authToken: data.authorization,\n        publicKey: data.user.publicKey,\n        // @ts-expect-error\n        authTokenExpirationDate: decodedToken.exp\n      }\n    });\n    return data;\n  } catch (err) {\n    dispatch(setAuthenticated(false));\n    throw parseError(err);\n  }\n};\n\nexport const setWebclientPrefix = prefix => dispatch => {\n  dispatch({\n    type:ACTIONS.SET_WEBCLIENT_PREFIX,\n    data:prefix\n  })\n}","import React from \"react\";\n\nexport function useForceUpdate(): () => void {\n  const [, setTick] = React.useState(0);\n  const update = React.useCallback(() => {\n    setTick(tick => tick + 1);\n  }, []);\n  return update;\n}\n","import * as Common from \"shock-common\";\nimport { useCallback, useState } from \"react\";\n\nimport { Contact, ReceivedRequest, SentRequest } from \"../schema\";\n\nexport * from \"./Date\";\nexport { default as Http } from \"./Http\";\nexport * from \"./Error\";\n\nexport const logger = {\n  log: (...args: any[]) => console.log(...args),\n  warn: (...args: any[]) => console.warn(...args),\n  error: (...args: any[]) => console.error(...args),\n  debug: (...args: any[]) => console.debug(...args)\n};\n\nexport interface File {\n  size: number;\n  type: string;\n}\n\n/**\n * Max limit in API 's http config.\n */\nexport const LARGEST_RES_SIZE = 102400;\n\n/**\n * @returns Image in jpeg format, in a data url presentation (base64).\n */\nexport const resizeImage = (\n  img: HTMLImageElement,\n  desiredLongEdge: number,\n  compression: number\n) => {\n  const canvas = document.createElement(\"canvas\");\n  let { width, height } = img;\n\n  if (width > height) {\n    if (width > desiredLongEdge) {\n      //height *= max_width / width;\n      height = Math.round((height *= desiredLongEdge / width));\n      width = desiredLongEdge;\n    }\n  } /* height > width */ else {\n    if (height > desiredLongEdge) {\n      width = Math.round((width *= desiredLongEdge / height));\n      height = desiredLongEdge;\n    }\n  }\n\n  canvas.width = width;\n  canvas.height = height;\n\n  canvas.getContext(\"2d\").drawImage(img, 0, 0, width, height);\n  return canvas.toDataURL(\"image/jpeg\", compression);\n};\n\n/**\n * @returns Image in jpeg format, in a data url presentation (base64).\n */\nexport const processImageFile = async (\n  file: File,\n  desiredLongEdge: number,\n  compression: number\n) => {\n  // based on https://github.com/josefrichter/resize/blob/master/public/preprocess.js\n  if (!file.type.startsWith(\"image/\")) {\n    throw new TypeError(\n      `Got a file of type ${file.type} with size: ${file.size}, expected type to start with \"image\"`\n    );\n  }\n\n  const imageBuffer = await Common.makePromise<ArrayBuffer>((res, rej) => {\n    const reader = new FileReader();\n\n    reader.onload = e => {\n      if (e.target.result instanceof ArrayBuffer) {\n        res(e.target.result);\n      } else {\n        rej(\n          new TypeError(\n            `Non ArrayBuffer file reader result when trying to load image file.`\n          )\n        );\n      }\n    };\n\n    const onFail = (e: ProgressEvent<FileReader>) => {\n      rej(\n        new Error(\n          `Error inside processImageFile()->imageBuffer->${JSON.stringify(e)}`\n        )\n      );\n    };\n    reader.onerror = onFail;\n    reader.onabort = onFail;\n\n    /// TODO: Why the need to cast and heck why does it even allow the cast?\n    reader.readAsArrayBuffer(file as Blob);\n  });\n\n  const url = (window.URL ?? window.webkitURL).createObjectURL(\n    new Blob([imageBuffer], { type: \"image/jpeg\" })\n  );\n\n  const image = await Common.makePromise<HTMLImageElement>((res, rej) => {\n    const _image = new Image();\n    _image.src = url;\n\n    _image.onload = () => {\n      res(_image);\n    };\n\n    _image.onerror = e => {\n      if (typeof e === \"string\") {\n        rej(new Error(e));\n      } else {\n        rej(new Error(JSON.stringify(e)));\n      }\n    };\n  });\n\n  const resizedImage = resizeImage(image, desiredLongEdge, compression);\n\n  return resizedImage;\n};\n\nexport const wait = (ms: number): Promise<void> =>\n  new Promise<void>(r => {\n    setTimeout(r, ms);\n  });\n\nexport const retryOperation = <T>(\n  operation: () => Promise<T>,\n  delay: number,\n  retries: number\n): Promise<T> =>\n  new Promise<T>((resolve, reject) => {\n    return operation()\n      .then(resolve)\n      .catch(reason => {\n        if (retries > 0) {\n          return (\n            wait(delay)\n              .then(retryOperation.bind(null, operation, delay, retries - 1))\n              // @ts-expect-error\n              .then(resolve)\n              .catch(reject)\n          );\n        }\n        return reject(reason);\n      });\n  });\n\n/**\n * Returns an empty string if the string provided is not a url.\n */\nexport const normalizeURL = (_url: string): string => {\n  let url = _url;\n\n  if (url.startsWith(\"www.\")) {\n    url = \"https://\" + url;\n  }\n\n  // https://stackoverflow.com/a/43467144\n  const isURL = (() => {\n    let __url: URL;\n\n    try {\n      __url = new URL(url);\n    } catch (_) {\n      return false;\n    }\n\n    return __url.protocol === \"http:\" || __url.protocol === \"https:\";\n  })();\n\n  if (isURL) {\n    return new URL(url).href;\n  }\n\n  return \"\";\n};\n\nexport const getContact = (\n  contacts: Array<Contact | SentRequest | ReceivedRequest>,\n  publicKey: string\n) => contacts.filter(contact => contact.pk === publicKey)[0];\n\nexport const EMPTY_FN: (...args: any[]) => void = () => {};\n\nexport const useBooleanState = (initialState: boolean) => {\n  const [state, setState] = useState<boolean>(initialState);\n  const toggle = useCallback(() => {\n    setState(_state => !_state);\n  }, []);\n\n  return [state, toggle] as const;\n};\n\nexport const parseJson = (o: string) => JSON.parse(o) as unknown;\n","// @ts-check\nimport { useCallback } from \"react\";\nimport classNames from \"classnames\";\nimport \"./css/index.scoped.css\";\nimport { NavLink } from \"react-router-dom\";\nimport { useDispatch } from \"react-redux\";\nimport { logout } from \"../../actions/AuthActions\";\nimport { closeDrawer } from \"../../actions/DrawerActions\";\nimport * as Store from \"../../store\";\n\nconst Drawer = () => {\n  const dispatch = useDispatch();\n  const open = Store.useSelector(({ drawer }) => drawer.open);\n  const close = useCallback(() => {\n    dispatch(closeDrawer());\n  }, [dispatch]);\n  const onClickLogout = useCallback(() => {\n    if (window.confirm(\"Are you sure you wish to log out?\")) {\n      dispatch(logout());\n      dispatch(closeDrawer());\n    }\n  }, [dispatch]);\n\n  const onClickScan = useCallback(() => {}, []);\n\n  return (\n    <>\n      <div\n        className={classNames({\n          \"drawer-overlay\": true,\n          \"drawer-overlay-open\": open\n        })}\n        onClick={close}\n      ></div>\n      <div\n        className={classNames({\n          \"drawer-container\": true,\n          \"drawer-container-open\": open\n        })}\n      >\n        <div className=\"drawer-top-section\">\n          {/* <div className=\"drawer-item\">\n            <div className=\"drawer-item-icon\">\n              <i className=\"icon-solid-wallet\"></i>\n            </div>\n            <p className=\"drawer-item-title unselectable\">Spending Rules</p>\n          </div> */}\n          {/* <div className=\"drawer-item\">\n        <div className=\"drawer-item-icon\">\n          <i className=\"icon-solid-spending-rule\"></i>\n        </div>\n        <p className=\"drawer-item-title unselectable\">Spending Rules</p>\n      </div> */}\n          <NavLink className=\"drawer-item\" to=\"/advanced\" onClick={close}>\n            <div className=\"drawer-item-icon\">\n              <i className=\"icon-solid-spending-rule\"></i>\n            </div>\n            <p className=\"drawer-item-title unselectable\">Advanced Lightning</p>\n          </NavLink>\n          <NavLink to=\"/Backups\" className=\"drawer-item\" onClick={close}>\n            <div className=\"drawer-item-icon\">\n              <i className=\"icon-solid-key\"></i>\n            </div>\n            <p className=\"drawer-item-title unselectable\">Seed Backup</p>\n          </NavLink>\n        </div>\n        <div className=\"drawer-bottom-section\">\n          <NavLink className=\"drawer-item\" to=\"/moonpay\" onClick={close}>\n            <div className=\"drawer-item-icon\">\n              <i className=\"icon-solid-help\"></i>\n            </div>\n            <p className=\"drawer-item-title unselectable\">Buy Bitcoins</p>\n          </NavLink>\n          <div className=\"drawer-item\">\n            <div className=\"drawer-item-icon\">\n              <i className=\"icon-solid-help\"></i>\n            </div>\n            <p className=\"drawer-item-title unselectable\">Help</p>\n          </div>\n        </div>\n\n        <div className=\"drawer-logout-and-scan\">\n          <NavLink to=\"/QRScanner\" onClick={close}>\n            <i\n              onClick={onClickScan}\n              className=\"icon-solid-scan\"\n              style={{ color: \"var(--main-blue)\" }}\n            ></i>\n          </NavLink>\n          <i\n            onClick={onClickLogout}\n            className=\"fas fa-power-off\"\n            style={{ color: \"var(--main-blue)\" }}\n          ></i>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default Drawer;\n","// @ts-check\nimport React, {\n  Suspense,\n  useCallback,\n  useEffect,\n  useMemo,\n  useState\n} from \"react\";\nimport { Redirect, Route, Switch, useHistory } from \"react-router-dom\";\nimport { useDispatch } from \"react-redux\";\nimport JWTDecode from \"jwt-decode\";\nimport videojs from \"video.js\";\nimport FullHeight from \"react-div-100vh\";\n\nimport { setAuthenticated } from \"./actions/AuthActions\";\nimport { loadReceivedRequests, loadSentRequests } from \"./actions/ChatActions\";\nimport Loader from \"./common/Loader\";\nimport Drawer from \"./common/Drawer\";\nimport {\n  subscribeUserProfile,\n  unsubscribeUserProfile\n} from \"./actions/UserProfilesActions\";\nimport * as Store from \"./store\";\nimport \"./styles/App.global.css\";\nimport Stream from \"./common/Post/components/Stream\";\nimport { dragElement } from \"./utils/ui\";\nimport { Http } from \"./utils\";\nimport {\n  removeStream,\n  setSeedInfo,\n  setSeedProviderPub\n} from \"./actions/ContentActions\";\n\nconst OverviewPage = React.lazy(() => import(\"./pages/Overview\"));\nconst AdvancedPage = React.lazy(() => import(\"./pages/Advanced\"));\nconst MessagesPage = React.lazy(() => import(\"./pages/Messages\"));\nconst ProfilePage = React.lazy(() => import(\"./pages/Profile\"));\nconst ChatPage = React.lazy(() => import(\"./pages/Chat\"));\nconst SendPage = React.lazy(() => import(\"./pages/Send\"));\nconst RequestPage = React.lazy(() => import(\"./pages/Request\"));\nconst AuthPage = React.lazy(() => import(\"./pages/Auth\"));\nconst FeedPage = React.lazy(() => import(\"./pages/Feed\"));\nconst MoonPayPage = React.lazy(() => import(\"./pages/MoonPay\"));\nconst PublishContentPage = React.lazy(() =>\n  import(\"./pages/Profile/PublishContent\")\n);\nconst offerServicePage = React.lazy(() =>\n  import(\"./pages/Profile/offerService\")\n);\nconst CreatePostPage = React.lazy(() => import(\"./pages/Profile/CreatePost\"));\nconst GoLivePage = React.lazy(() => import(\"./pages/Profile/GoLive/GoLive\"));\nconst OtherUserPage = React.lazy(() => import(\"./pages/OtherUser\"));\nconst Story = React.lazy(() => import(\"./pages/Story\"));\nconst Stories = React.lazy(() => import(\"./pages/Stories\"));\nconst QRScannerPage = React.lazy(() => import(\"./pages/QRScanner\"));\nconst BackupsPage = React.lazy(() => import(\"./pages/Backups\"));\n\nconst PrivateRoute = ({ component, ...options }) => {\n  const authenticated = Store.useSelector(({ auth }) => auth.authenticated);\n  const authorizedComponent = authenticated ? component : AuthPage;\n\n  return <Route {...options} component={authorizedComponent} />;\n};\n\nconst App = () => {\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const authToken = Store.useSelector(({ node }) => node.authToken);\n  const authenticated = Store.useSelector(({ auth }) => auth.authenticated);\n  const publicKey = Store.useSelector(Store.selectSelfPublicKey);\n  const streamUrl = Store.useSelector(({ content }) => content.streamUrl);\n  const streamStatusUrl = Store.useSelector(\n    ({ content }) => content.streamStatusUrl\n  );\n  const streamContentId = Store.useSelector(\n    ({ content }) => content.streamContentId\n  );\n  const streamPostId = Store.useSelector(({ content }) => content.streamPostId);\n  const streamUserToken = Store.useSelector(\n    ({ content }) => content.streamUserToken\n  );\n  const streamLiveToken = Store.useSelector(\n    ({ content }) => content.streamLiveToken\n  );\n  const [, setUpdate] = useState(0);\n  const [isLive, setIsLive] = useState(false);\n  const [showFloatingPlayer, setShowFloatingPlayer] = useState(false);\n  // effect to update live status\n  useEffect(() => {\n    if (!streamStatusUrl) {\n      return;\n    }\n    let timeout;\n    const interval = setInterval(async () => {\n      try {\n        const res = await Http.get(streamStatusUrl);\n        if (!res.data.isLive) {\n          return;\n        }\n        setIsLive(true);\n        clearInterval(interval);\n        timeout = setTimeout(() => {\n          console.info(\"upp\");\n          setUpdate(Date.now());\n        }, 5000);\n      } catch (e) {}\n    }, 2000);\n    return () => {\n      clearInterval(interval);\n      clearTimeout(timeout);\n    };\n  }, [streamStatusUrl, setIsLive, setUpdate]);\n  const StreamRender = useMemo(() => {\n    return (\n      <Stream\n        hideRibbon={true}\n        item={{ magnetURI: streamUrl, liveStatus: \"live\" }}\n        timeout={1500}\n        id={undefined}\n        index={undefined}\n        postId={undefined}\n        tipCounter={undefined}\n        tipValue={undefined}\n        width={undefined}\n      />\n    );\n  }, [streamUrl]);\n\n  const stopStream = useCallback(() => {\n    Http.post(\"/api/stopStream\", {\n      postId: streamPostId,\n      contentId: streamContentId,\n      endUrl: `https://webtorrent.shock.network/api/stream/end`,\n      urlForMagnet: `https://webtorrent.shock.network/api/stream/torrent/${streamUserToken}`,\n      obsToken: streamLiveToken\n    });\n    removeStream()(dispatch);\n    console.info(streamUserToken);\n    history.push(\"/profile\");\n  }, [\n    dispatch,\n    history,\n    streamContentId,\n    streamLiveToken,\n    streamPostId,\n    streamUserToken\n  ]);\n\n  useEffect(() => {\n    videojs.addLanguage(\"en\", {\n      \"The media could not be loaded, either because the server or network failed or because the format is not supported.\":\n        \"Stream Not Available\"\n    });\n  }, []);\n\n  useEffect(() => {\n    if (!authToken) {\n      dispatch(setAuthenticated(false));\n      return;\n    }\n\n    const decodedToken = JWTDecode(authToken);\n    // @ts-expect-error\n    const tokenExpired = decodedToken.exp * 1000 < Date.now();\n    setAuthenticated(tokenExpired);\n  }, [authToken, dispatch]);\n\n  useEffect(() => {\n    if (authenticated) {\n      // TODO: Move to messages screen\n      dispatch(loadSentRequests());\n      dispatch(loadReceivedRequests());\n      // Get current user's profile on login\n      dispatch(subscribeUserProfile(publicKey));\n    } else {\n      dispatch(unsubscribeUserProfile(publicKey));\n    }\n  }, [authenticated, dispatch, publicKey]);\n\n  useEffect(() => {\n    const tmp = !!(authenticated && isLive && streamUrl);\n    if (tmp !== showFloatingPlayer) {\n      setShowFloatingPlayer(tmp);\n    }\n  }, [\n    authenticated,\n    isLive,\n    streamUrl,\n    showFloatingPlayer,\n    setShowFloatingPlayer\n  ]);\n  useEffect(() => {\n    if (showFloatingPlayer) {\n      dragElement(\"floatyVideo\");\n    }\n  }, [showFloatingPlayer]);\n\n  //load info about content provider stored into gun\n  const loadContentInfo = useCallback(async () => {\n    try {\n      const { data: serviceProvider } = await Http.get(\n        `/api/gun/user/load/seedServiceProviderPubKey`,\n        {\n          headers: {\n            \"public-key-for-decryption\": publicKey\n          }\n        }\n      );\n      if (\n        serviceProvider &&\n        typeof serviceProvider.data === \"string\" &&\n        serviceProvider.data !== \"\"\n      ) {\n        setSeedProviderPub(serviceProvider.data)(dispatch);\n      }\n      const { data: seedData } = await Http.get(\n        `/api/gun/user/load/seedServiceSeedData`,\n        {\n          headers: {\n            \"public-key-for-decryption\": publicKey\n          }\n        }\n      );\n      if (\n        seedData &&\n        typeof seedData.data === \"string\" &&\n        seedData.data !== \"\"\n      ) {\n        const JObject = JSON.parse(seedData.data);\n        if (JObject && JObject.seedUrl && JObject.seedToken) {\n          setSeedInfo(JObject.seedUrl, JObject.seedToken)(dispatch);\n        }\n      }\n    } catch (err) {\n      //if something goes wrong just log the error, no need to do anything else\n      console.log(err);\n    }\n  }, [dispatch, publicKey]);\n  useEffect(() => {\n    loadContentInfo();\n  }, [loadContentInfo]);\n\n  return (\n    <FullHeight className=\"ShockWallet\">\n      {showFloatingPlayer && (\n        <div id=\"floatyVideo\" className=\"floaty-container\">\n          <i id=\"floatyVideoHeader\" className=\"fas fa-grip-vertical\"></i>\n          {StreamRender}\n          <button onClick={stopStream}>CLOSE STREAM</button>\n        </div>\n      )}\n      <Drawer />\n      <Suspense fallback={<Loader fullScreen text={null} />}>\n        <Switch>\n          <Route path=\"/auth\" exact component={AuthPage} />\n          <PrivateRoute path=\"/overview\" exact component={OverviewPage} />\n          <PrivateRoute path=\"/advanced\" exact component={AdvancedPage} />\n          <PrivateRoute path=\"/chat\" exact component={MessagesPage} />\n          <PrivateRoute path=\"/chat/:publicKey\" component={ChatPage} />\n          <PrivateRoute path=\"/send\" exact component={SendPage} />\n          <PrivateRoute path=\"/request\" exact component={RequestPage} />\n          <PrivateRoute path=\"/profile\" exact component={ProfilePage} />\n          <PrivateRoute\n            path=\"/publishContent\"\n            exact\n            component={PublishContentPage}\n          />\n          <PrivateRoute path=\"/feed\" exact component={FeedPage} />\n          <PrivateRoute path=\"/moonpay\" exact component={MoonPayPage} />\n          <PrivateRoute path=\"/createPost\" exact component={CreatePostPage} />\n          <PrivateRoute path=\"/goLive\" exact component={GoLivePage} />\n          <PrivateRoute\n            path=\"/offerService\"\n            exact\n            component={offerServicePage}\n          />\n          <PrivateRoute path=\"/QRScanner\" exact component={QRScannerPage} />\n          <PrivateRoute\n            path=\"/otherUser/:publicKey\"\n            exact\n            component={OtherUserPage}\n          />\n          <PrivateRoute path=\"/Backups\" exact component={BackupsPage} />\n          <Route path=\"/story\" exact component={Story} />\n          <Route path=\"/stories\" exact component={Stories} />\n          <Redirect to=\"/overview\" />\n        </Switch>\n      </Suspense>\n    </FullHeight>\n  );\n};\n\nexport default App;\n","export function dragElement(elementId) {\n  const elmnt = document.getElementById(elementId)\n  if(!elmnt){\n    console.log(\"draggable set fail\")\n    return\n      \n  }\n  var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;\n  document.getElementById(elmnt.id + \"Header\").onpointerdown = dragMouseDown;\n\n  function dragMouseDown(e) {\n    e = e || window.event;\n    e.preventDefault();\n    // get the mouse cursor position at startup:\n    pos3 = e.clientX;\n    pos4 = e.clientY;\n    document.onpointerup = closeDragElement;\n    // call a function whenever the cursor moves:\n    document.onpointermove = elementDrag;\n  }\n\n  function elementDrag(e) {\n      console.log(\"dragging yooo\")\n    e = e || window.event;\n    e.preventDefault();\n    // calculate the new cursor position:\n    pos1 = pos3 - e.clientX;\n    pos2 = pos4 - e.clientY;\n    pos3 = e.clientX;\n    pos4 = e.clientY;\n    // set the element's new position:\n    elmnt.style.top = (elmnt.offsetTop - pos2) + \"px\";\n    elmnt.style.left = (elmnt.offsetLeft - pos1) + \"px\";\n  }\n\n  function closeDragElement() {\n      console.log(\"not anymore!\")\n    // stop moving when mouse button is released:\n    document.onpointerup = null;\n    document.onpointermove = null;\n  }\n  }\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://cra.link/PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://cra.link/PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Http from \"axios\";\nimport App from \"./App\";\nimport * as serviceWorkerRegistration from \"./serviceWorkerRegistration\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { Provider } from \"react-redux\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport { store, persistor } from \"./store\";\nimport { PersistGate } from \"redux-persist/integration/react\";\nimport \"./styles/index.global.css\";\n\nHttp.defaults.timeout = 20000;\n\nReactDOM.render(\n  <Provider store={store}>\n    <PersistGate loading={null} persistor={persistor}>\n      <React.StrictMode>\n        <Router>\n          <App />\n        </Router>\n      </React.StrictMode>\n    </PersistGate>\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorkerRegistration.register();\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals(console.log);\n","import * as Common from \"shock-common\";\n\nimport * as Utils from \"../utils\";\nimport {\n  rifle,\n  rifleCleanup,\n  unsubscribeRifleByQuery\n} from \"../utils/WebSocket\";\n\nexport const ACTIONS = {\n  RESET_USER_PROFILES: \"userProfiles/profiles/reset\",\n  LOAD_USER_PROFILE: \"userProfiles/profiles/load\",\n  REMOVE_USER_PROFILE: \"userProfiles/profiles/remove\",\n  UPDATE_USER_PROFILE: \"userProfiles/profiles/update\"\n};\n\nconst subscribedProfiles = new Set();\n\nexport const updateUserProfile = (\n  publicKey: string,\n  profile: Partial<Common.User>\n) => ({\n  type: ACTIONS.UPDATE_USER_PROFILE,\n  data: {\n    publicKey,\n    profile\n  }\n});\n\n/**\n * Returns an un subscription function.\n */\nexport const subscribeUserProfile = (publicKey: string) => (\n  dispatch: (action: object) => void,\n  getState: () => {\n    userProfiles: Record<string, Common.User>;\n  }\n) => {\n  if (subscribedProfiles.has(publicKey)) {\n    return () => {};\n  }\n\n  console.info(\"subbing user...\" + publicKey);\n  subscribedProfiles.add(publicKey);\n\n  const subscription = rifle({\n    query: `${publicKey}::Profile::on`,\n    reconnect: true,\n    onData: profile => {\n      const { [publicKey]: existingUser } = getState().userProfiles;\n\n      if (existingUser) {\n        dispatch({\n          type: ACTIONS.UPDATE_USER_PROFILE,\n          data: { publicKey, profile }\n        });\n        return profile;\n      }\n\n      dispatch({\n        type: ACTIONS.LOAD_USER_PROFILE,\n        data: { publicKey, profile }\n      });\n    }\n  });\n\n  const binarySub = rifle({\n    query: `${publicKey}::profileBinary::map.on`,\n    reconnect: true,\n    onData: (data, key: string) => {\n      if (key === \"avatar\") {\n        if (typeof data !== \"string\" && data !== null) {\n          Utils.logger.error(\n            `Expected avatar data to be string or null, instead got: ${typeof data}. Public key: ${publicKey}`\n          );\n          return;\n        }\n        dispatch(\n          updateUserProfile(publicKey, {\n            avatar: data\n          })\n        );\n      } else if (key === \"header\") {\n        if (typeof data !== \"string\" && data !== null) {\n          Utils.logger.error(\n            `Expected header data to be string or null, instead got: ${typeof data}. Public key: ${publicKey}`\n          );\n          return;\n        }\n        dispatch(\n          updateUserProfile(publicKey, {\n            header: data\n          })\n        );\n      } else {\n        Utils.logger.error(\n          `Unknown key: ${key} for user binary profile data gun RPC socket`\n        );\n      }\n    }\n  });\n\n  return () => {\n    rifleCleanup(subscription, binarySub)();\n    subscribedProfiles.delete(publicKey);\n  };\n};\n\nexport const unsubscribeUserProfile = (publicKey: string) => async () => {\n  unsubscribeRifleByQuery(`${publicKey}::Profile::on`);\n  unsubscribeRifleByQuery(`${publicKey}::profileBinary::map.on`);\n};\n","// @ts-check\nimport { GUN_PROPS } from \"../utils/Gun\";\nimport Http from \"../utils/Http\";\nimport { rifle, unsubscribeRifleByQuery } from \"../utils/WebSocket\";\n\nimport { subscribeUserProfile } from \"./UserProfilesActions\";\n\nexport const ACTIONS = {\n  RESET_FEED: \"feed/reset\",\n  ADD_FOLLOW: \"feed/follows/add\",\n  REMOVE_FOLLOW: \"feed/follows/remove\",\n  UPDATE_FOLLOW: \"feed/follows/update\",\n  LOAD_POSTS: \"feed/posts/load\",\n  ADD_USER_POST: \"feed/posts/add\",\n  DELETE_USER_POST: \"feed/posts/delete\",\n  LOAD_SHARED_POST: \"feed/sharedPosts/load\",\n  POST_TIPPED: \"feed/posts/tipped\"\n};\n\nexport const removeFollow = key => dispatch =>\n  dispatch({\n    type: ACTIONS.REMOVE_FOLLOW,\n    data: key\n  });\n\nexport const addFollow = follow => dispatch =>\n  dispatch({\n    type: ACTIONS.ADD_FOLLOW,\n    data: follow\n  });\n\nexport const loadSharedPost = (\n  originalPostId,\n  originalPublicKey,\n  sharerPublicKey\n) => async dispatch => {\n  const { data: post } = await Http.get(\n    `/api/gun/otheruser/${originalPublicKey}/load/posts>${originalPostId}`\n  );\n  dispatch(subscribeUserProfile(originalPublicKey));\n  const tipSet = post.data.tipsSet ? Object.values(post.data.tipsSet) : [];\n  const lenSet = tipSet.length;\n  const tot =\n    lenSet > 0 ? tipSet.reduce((acc, val) => Number(val) + Number(acc)) : 0;\n  dispatch({\n    type: ACTIONS.LOAD_SHARED_POST,\n    data: {\n      ...post.data,\n      authorId: originalPublicKey,\n      sharerId: sharerPublicKey,\n      id: originalPostId,\n      tipCounter: lenSet,\n      tipValue: tot\n    }\n  });\n};\n\nconst USER_POSTS_QUERY_SUFFIX = `::posts::on`;\n\nexport const subscribeUserPosts = publicKey => async dispatch => {\n  console.info(\"subbing to posts from:\" + publicKey);\n  const subscription = await rifle({\n    query: publicKey + USER_POSTS_QUERY_SUFFIX,\n    onData: posts => {\n      console.debug(`posts from: ${publicKey}: `, posts);\n      const postEntries = Object.entries(posts);\n      const newPosts = postEntries\n        .filter(([key, value]) => value !== null && !GUN_PROPS.includes(key))\n        .map(([key]) => key);\n      const deletedPosts = postEntries\n        .filter(([key, value]) => value === null && !GUN_PROPS.includes(key))\n        .map(([key]) => key);\n\n      newPosts.forEach(async function fetchAndDispatchPost(id) {\n        try {\n          const { data: post } = await Http.get(\n            `/api/gun/otheruser/${publicKey}/load/posts>${id}`\n          );\n          console.info(`processing post: ${id} from ${publicKey}`);\n          const tipSet = post.data.tipsSet\n            ? Object.values(post.data.tipsSet)\n            : [];\n          const lenSet = tipSet.length;\n          const tot =\n            lenSet > 0\n              ? tipSet.reduce((acc, val) => Number(val) + Number(acc))\n              : 0;\n          dispatch({\n            type: ACTIONS.ADD_USER_POST,\n            data: {\n              ...post.data,\n              id,\n              authorId: publicKey,\n              type: \"post\",\n              tipCounter: lenSet,\n              tipValue: tot\n            }\n          });\n        } catch (e) {\n          console.error(\n            `When subscribed to posts from public key --| ${publicKey} |-- and trying to download the post with id: --| ${id} |-- an error ocurred:`,\n            e\n          );\n        }\n      });\n\n      deletedPosts.forEach(id =>\n        dispatch({\n          type: ACTIONS.DELETE_USER_POST,\n          data: {\n            id,\n            authorId: publicKey,\n            type: \"post\"\n          }\n        })\n      );\n    }\n  });\n  return subscription;\n};\n\nexport const unsubUserPosts = publicKey => async () => {\n  console.info(\"unsubbing to posts from:\" + publicKey);\n  unsubscribeRifleByQuery(publicKey + USER_POSTS_QUERY_SUFFIX);\n};\n\nconst USER_SHARED_POSTS_QUERY_SUFFIX = `::sharedPosts::on`;\n\nexport const subscribeSharedUserPosts = publicKey => async dispatch => {\n  const subscription = await rifle({\n    query: publicKey + USER_SHARED_POSTS_QUERY_SUFFIX,\n    onData: posts => {\n      console.debug(`shared posts from ${publicKey}: `, posts);\n      const postEntries = Object.entries(posts);\n      const newPosts = postEntries\n        .filter(([key, value]) => value !== null && !GUN_PROPS.includes(key))\n        .map(([key]) => key);\n      const deletedPosts = postEntries\n        .filter(([key, value]) => value === null && !GUN_PROPS.includes(key))\n        .map(([key]) => key);\n\n      newPosts.forEach(async function fetchAndDispatchSharedPost(id) {\n        try {\n          const res = await Http.get(\n            `/api/gun/otheruser/${publicKey}/load/sharedPosts>${id}`\n          );\n          const { data: shared } = res;\n          if (!shared.data || !shared.data.originalAuthor) {\n            throw new Error(\n              `invalid shared post provided for user ${publicKey}`\n            );\n          }\n          /** @type {import('shock-common').SharedPostRaw} */\n          const post = res.data.data;\n\n          /** @type {import('../schema').SharedPost} */\n          const processedPost = {\n            authorId: publicKey,\n            id,\n            originalAuthor: post.originalAuthor,\n            shareDate: post.shareDate,\n            sharerId: publicKey,\n            originalPost: undefined,\n            type: \"shared\"\n          };\n          dispatch({\n            type: ACTIONS.ADD_USER_POST,\n            data: processedPost\n          });\n\n          console.debug(\"dispatching shared post load\");\n          dispatch(loadSharedPost(id, post.originalAuthor, publicKey));\n        } catch (e) {\n          console.error(`User: ${publicKey}\\npostID: ${id}\\n error:`, e);\n        }\n      });\n\n      deletedPosts.forEach(id =>\n        dispatch({\n          type: ACTIONS.DELETE_USER_POST,\n          data: {\n            id,\n            authorId: publicKey\n          }\n        })\n      );\n    }\n  });\n  return subscription;\n};\n\nexport const unsubUserSharedPosts = publicKey => () => {\n  unsubscribeRifleByQuery(publicKey + USER_SHARED_POSTS_QUERY_SUFFIX);\n};\n\nconst FOLLOWS_QUERY = \"$user::follows::map.on\";\n\nexport const subscribeFollows = () => async dispatch => {\n  const subscription = await rifle({\n    query: FOLLOWS_QUERY,\n    reconnect: true,\n    onData: async (follow, key) => {\n      console.info(`processing follow`);\n      console.info(follow);\n      if (typeof key !== \"string\") {\n        console.warn(`Invalid follow key received: ${key}`);\n        return;\n      }\n\n      if (!follow) {\n        dispatch(removeFollow(key));\n        return;\n      }\n\n      if (typeof follow.user !== \"string\") {\n        console.warn(`Invalid follow user received (${follow.user})`);\n        return;\n      }\n\n      dispatch(addFollow(follow));\n    }\n  });\n\n  console.debug(\"subbing follows\");\n\n  return subscription;\n};\n\nexport const unsubscribeFollows = () => () => {\n  console.debug(\"unsubbing follows\");\n  unsubscribeRifleByQuery(FOLLOWS_QUERY);\n};\n\nexport const sendTipPost = ({\n  publicKey,\n  postId,\n  amount\n}) => async dispatch => {\n  const { data } = await Http.post(\"/api/lnd/unifiedTrx\", {\n    type: \"tip\",\n    amt: amount,\n    to: publicKey,\n    memo: \"Post Tipped!\",\n    feeLimit: amount * 0.006 + 10, // TODO: Hardcoded fees for now\n    ackInfo: postId\n  });\n  console.log(data);\n  dispatch({\n    type: ACTIONS.POST_TIPPED,\n    data: {\n      publicKey,\n      postId,\n      amount\n    }\n  });\n};\n\nexport const deleteUserPost = ({ id, authorId }) => ({\n  type: ACTIONS.DELETE_USER_POST,\n  data: {\n    id,\n    authorId\n  }\n});\n","import * as Common from \"shock-common\";\n\nexport type Contact = {\n  pk: string;\n  avatar: string | null;\n  displayName: string | null;\n  didDisconnect: boolean;\n};\n\nexport interface ReceivedRequest {\n  id: string;\n  pk: string;\n  avatar: string | null;\n  displayName: string | null;\n  timestamp: number;\n}\n\nexport interface SentRequest {\n  id: string;\n  pk: string;\n  avatar: string | null;\n  displayName: string | null;\n  changedAddress: boolean;\n  timestamp: number;\n  loading: boolean;\n}\n\nexport type ChatMessageStatus = \"SENT\" | \"SENDING\" | \"FAILED\" | \"RECEIVED\";\n\nexport const CHAT_MESSAGE_STATUS = {\n  SENT: \"SENT\",\n  SENDING: \"SENDING\",\n  FAILED: \"FAILED\",\n  RECEIVED: \"RECEIVED\"\n} as const;\n\nexport interface ChatMessage {\n  body: string;\n  id: string;\n  localId: string;\n  outgoing: boolean;\n  recipientPublicKey: string;\n  status: ChatMessageStatus;\n  timestamp: number;\n}\n\nexport interface Post extends Common.RawPost {\n  authorId: string;\n  id: string;\n  type: \"post\";\n}\n\n/**\n * Different from the one in shock-common.\n */\nexport interface SharedPost extends Common.SharedPostRaw {\n  authorId: string;\n  sharerId: string;\n  id: string;\n  type: \"shared\";\n  /**\n   * Undefined when loading it.\n   */\n  originalPost?: Post;\n}\n\nexport const isSharedPost = (post: any): post is SharedPost => {\n  if (!Common.isObj(post)) {\n    return false;\n  }\n\n  const obj = (post as unknown) as SharedPost;\n\n  if (typeof obj.authorId !== \"string\") {\n    return false;\n  }\n\n  if (typeof obj.id !== \"string\") {\n    return false;\n  }\n\n  if (typeof obj.originalAuthor !== \"string\") {\n    return false;\n  }\n\n  return obj.type === \"shared\";\n};\n\nexport interface PublishedContent {\n  type: \"image/embedded\" | \"video/embedded\";\n  magnetURI: string;\n  width: number;\n  height: number;\n  title: string;\n  description: string;\n}\n\nexport const isPublishedContent = (o: unknown): o is PublishedContent => {\n  if (!Common.isObj(o)) {\n    return false;\n  }\n  const obj = (o as unknown) as PublishedContent;\n\n  if (typeof obj.description !== \"string\") {\n    return false;\n  }\n  if (typeof obj.height !== \"number\") {\n    return false;\n  }\n  if (typeof obj.width !== \"number\") {\n    return false;\n  }\n  if (!Common.isPopulatedString(obj.title)) {\n    return false;\n  }\n  if (obj.type !== \"image/embedded\" && obj.type !== \"video/embedded\") {\n    return false;\n  }\n  return true;\n};\n","export type FieldErrorType = {\n  message: string;\n  field: string;\n  name?: string;\n  stack?: string;\n};\n\nclass FieldError extends Error {\n  field: string;\n\n  constructor(error: any) {\n    super();\n    this.message = error?.message ?? \"An unknown error has occurred\";\n    this.field = error?.field ?? \"unknown\";\n    this.name = error?.name;\n    this.stack = error?.stack;\n  }\n}\n\nexport default FieldError;\n","import { AxiosError } from \"axios\";\nimport FieldError, { FieldErrorType } from \"./FieldError\";\n\nexport type MixedError = Error | AxiosError | FieldErrorType;\n\nexport const parseError = (error: MixedError) => {\n  if (\"response\" in error) {\n    const response = error.response?.data;\n    return new FieldError({\n      field: response?.field ?? \"unknown\",\n      message: response?.errorMessage ?? \"An unknown error has occurred\"\n    });\n  }\n\n  return new FieldError({\n    field: (\"field\" in error && error.field) ?? \"unknown\",\n    message: error.message ?? \"An unknown error has occurred\"\n  });\n};\n","import { v4 as uuidv4 } from \"uuid\";\nimport Http from \"axios\";\nimport { setHostId } from \"./NodeActions\";\nimport { generateKeyPair } from \"../utils/Encryption\";\n\nexport const ACTIONS = {\n  ADD_USER_KEY_PAIR: \"encryption/userKeyPair\",\n  ADD_HOST_KEY: \"encryption/hostKey\",\n  SET_DEVICE_ID: \"encryption/deviceId\"\n};\n\nlet exchangingKeypair = null;\n\nexport const generateDeviceId = () => dispatch => {\n  const deviceId = uuidv4();\n  dispatch({\n    type: ACTIONS.SET_DEVICE_ID,\n    data: deviceId\n  });\n  return deviceId;\n};\n\nexport const addUserKeyPair = ({ hostId, keyPair }) => dispatch => {\n  dispatch({\n    type: ACTIONS.ADD_USER_KEY_PAIR,\n    data: { hostId, keyPair }\n  });\n};\n\nexport const addHostKey = ({ hostId, publicKey }) => dispatch => {\n  dispatch({\n    type: ACTIONS.ADD_HOST_KEY,\n    data: {\n      hostId,\n      publicKey\n    }\n  });\n};\n\nconst getDeviceId = () => (dispatch, getState) => {\n  const { deviceId } = getState().node;\n\n  if (!deviceId) {\n    const newDeviceId = dispatch(generateDeviceId());\n    return newDeviceId;\n  }\n\n  return deviceId;\n};\n\nexport const exchangeKeyPair = () => async dispatch => {\n  try {\n    const deviceId = dispatch(getDeviceId());\n\n    const keyPair = generateKeyPair();\n    const { data } = await Http.post(`/api/encryption/exchange`, {\n      publicKey: keyPair.publicKeyBase64,\n      deviceId\n    });\n\n    dispatch(\n      addUserKeyPair({\n        hostId: data.hostId,\n        keyPair\n      })\n    );\n\n    dispatch(\n      addHostKey({\n        hostId: data.hostId,\n        publicKey: data.APIPublicKey\n      })\n    );\n\n    dispatch(setHostId(data.hostId));\n\n    return {\n      user: keyPair,\n      host: data\n    };\n  } catch (err) {\n    console.error(\"[ENCRYPTION] Key Exchange Error:\", err);\n    throw err;\n  }\n};\n\nexport const throttledExchangeKeyPair = () => async dispatch => {\n  try {\n    if (!exchangingKeypair) {\n      exchangingKeypair = dispatch(exchangeKeyPair());\n    }\n\n    const result = await exchangingKeypair;\n\n    // eslint-disable-next-line require-atomic-updates\n    exchangingKeypair = null;\n\n    return result;\n  } catch (err) {\n    console.error(err);\n    exchangingKeypair = null;\n    throw err;\n  }\n};\n","export const ACTIONS = {\n  SET_DRAWER_OPEN: \"drawer/open\"\n};\n\nexport const openDrawer = () => async dispatch => {\n  dispatch({\n    type: ACTIONS.SET_DRAWER_OPEN,\n    data: true\n  });\n};\n\nexport const closeDrawer = () => async dispatch => {\n  dispatch({\n    type: ACTIONS.SET_DRAWER_OPEN,\n    data: false\n  });\n};\n","import Http from \"../utils/Http\";\n\nexport const ACTIONS = {\n  RESET_FEES: \"fees/reset\",\n  LOAD_FEE_RATES: \"fees/feeRates/load\",\n  SET_SOURCE: \"fees/source/set\",\n  SET_RATE: \"fees/rate/set\"\n};\n\nexport const loadFeeRates = () => async (dispatch, getState) => {\n  const { source } = getState().fees;\n  const { data } = await Http.get(source);\n\n  dispatch({\n    type: ACTIONS.LOAD_FEE_RATES,\n    data\n  });\n\n  return data;\n};\n\nexport const setSource = source => dispatch => {\n  dispatch({\n    type: ACTIONS.SET_SOURCE,\n    data: source\n  });\n\n  return source;\n};\n\nexport const setRate = rate => dispatch => {\n  dispatch({\n    type: ACTIONS.SET_RATE,\n    data: rate\n  });\n\n  return rate;\n};\n","export const GUN_PROPS = [\"_\", \"#\"];\n","export const initialMessagePrefix = \"$$__SHOCKWALLET__INITIAL__MESSAGE\";\n\nexport const invoiceMessagePrefix = \"$$__SHOCKWALLET__INVOICE__\";\n\nexport const userMessagePrefix = \"$$__SHOCKWALLET__USER__\";\n\nexport const capitalizeText = text =>\n  text\n    .split(\" \")\n    .map(\n      word => `${word.slice(0, 1).toUpperCase()}${word.slice(1).toLowerCase()}`\n    )\n    .join(\" \");\n\nexport const processDisplayName = (publicKey = \"\", displayName = \"\") => {\n  if (displayName) {\n    return displayName;\n  }\n\n  const suffix = publicKey.slice(-8);\n\n  return `Anon${suffix}`;\n};\n"],"sourceRoot":""}