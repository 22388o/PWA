(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[26],{533:function(e,t,n){"use strict";t.a=n.p+"static/media/bitcoin-lightning.2d73b74b.svg"},577:function(e,t,n){"use strict";var a=n(3),c=a.useLayoutEffect;t.a=function(e){var t=Object(a.useRef)(e);return c((function(){t.current=e})),t}},632:function(e,t,n){},633:function(e,t,n){},752:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),r=n(6),i=n(21),s=n(3),o=n(26),u=n(41),l=n(15),d=n(32),b=n(577),h=function(e,t){"function"!==typeof e?e.current=t:e(t)},p=function(e,t){var n=Object(s.useRef)();return Object(s.useCallback)((function(a){e.current=a,n.current&&h(n.current,null),n.current=t,t&&h(t,a)}),[t])},f={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},j=function(e){Object.keys(f).forEach((function(t){e.style.setProperty(t,f[t],"important")}))},m=null;var v=function(){},g=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width"],O=!!document.documentElement.currentStyle,x=function(e,t){var n=e.cacheMeasurements,a=e.maxRows,c=e.minRows,r=e.onChange,i=void 0===r?v:r,o=e.onHeightChange,u=void 0===o?v:o,h=Object(d.a)(e,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]);var f=void 0!==h.value,x=Object(s.useRef)(null),y=p(x,t),S=Object(s.useRef)(0),w=Object(s.useRef)(),N=function(){var e=x.current,t=n&&w.current?w.current:function(e){var t=window.getComputedStyle(e);if(null===t)return null;var n,a=(n=t,g.reduce((function(e,t){return e[t]=n[t],e}),{})),c=a.boxSizing;return""===c?null:(O&&"border-box"===c&&(a.width=parseFloat(a.width)+parseFloat(a.borderRightWidth)+parseFloat(a.borderLeftWidth)+parseFloat(a.paddingRight)+parseFloat(a.paddingLeft)+"px"),{sizingStyle:a,paddingSize:parseFloat(a.paddingBottom)+parseFloat(a.paddingTop),borderSize:parseFloat(a.borderBottomWidth)+parseFloat(a.borderTopWidth)})}(e);if(t){w.current=t;var r=function(e,t,n,a){void 0===n&&(n=1),void 0===a&&(a=1/0),m||((m=document.createElement("textarea")).setAttribute("tab-index","-1"),m.setAttribute("aria-hidden","true"),j(m)),null===m.parentNode&&document.body.appendChild(m);var c=e.paddingSize,r=e.borderSize,i=e.sizingStyle,s=i.boxSizing;Object.keys(i).forEach((function(e){var t=e;m.style[t]=i[t]})),j(m),m.value=t;var o=function(e,t){var n=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?n+t.borderSize:n-t.paddingSize}(m,e);m.value="x";var u=m.scrollHeight-c,l=u*n;"border-box"===s&&(l=l+c+r),o=Math.max(l,o);var d=u*a;return"border-box"===s&&(d=d+c+r),[o=Math.min(d,o),u]}(t,e.value||e.placeholder||"x",c,a),i=r[0],s=r[1];S.current!==i&&(S.current=i,e.style.setProperty("height",i+"px","important"),u(i,{rowHeight:s}))}};return Object(s.useLayoutEffect)(N),function(e){var t=Object(b.a)(e);Object(s.useLayoutEffect)((function(){var e=function(e){t.current(e)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[])}(N),Object(s.createElement)("textarea",Object(l.a)({},h,{onChange:function(e){f||N(),i(e)},ref:y}))},y=Object(s.forwardRef)(x),S=n(514),w=n(78),N=n.n(w),k=(n(632),n(8)),z=function(e){var t=e.text,n=void 0===t?"":t,a=e.receivedMessage,c=void 0!==a&&a;return Object(k.jsxs)("div",{className:N()({"chat-message":!0,"chat-message-received":c}),children:[c?Object(k.jsx)("div",{className:"chat-message-avatar"}):null,Object(k.jsx)("p",{className:"chat-message-text",children:n})]})},R=n(28),C=n(533),E=(n(633),n(96)),F=n(25),L=n(16);t.default=function(){var e=Object(u.c)(),t=Object(o.i)().publicKey,n=Object(s.useState)(""),a=Object(i.a)(n,2),l=a[0],d=a[1],b=F.useSelector((function(e){return e.chat.messages[t]})),h=F.useSelector((function(e){var n=e.chat;return Object(L.b)(n.contacts,t)})),p=F.useSelector((function(e){var n=e.chat;return Object(L.b)(n.sentRequests,t)})),f=F.useSelector((function(e){var n=e.chat;return Object(L.b)(n.receivedRequests,t)})),j=F.useSelector((function(e){return e.node.publicKey})),m=!h&&p,v=!h&&f,g=Object(s.useCallback)((function(e){d(e.target.value)}),[]),O=Object(s.useCallback)((function(){console.log(f),f&&Object(R.b)(f.id)(e)}),[f,e]),x=Object(s.useCallback)((function(n){if("Enter"!==n.key||!n.ctrlKey)return"Enter"===n.key?(n.preventDefault(),e(Object(R.g)({message:l,publicKey:t})),void d("")):void 0;d(l+"\r\n")}),[l,t,e]),w=Object(s.useCallback)((function(){var n=e(Object(R.h)(j,t));return Object(r.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:null===(t=e.sent)||void 0===t||t.close();case 4:case"end":return e.stop()}}),e)})))}),[e,j,t]);Object(s.useEffect)((function(){return w()}),[w]);var N=Object(s.useMemo)((function(){return m?Object(E.c)(m.pk,m.displayName):v?Object(E.c)(v.pk,v.displayName):h?Object(E.c)(h.pk,h.displayName):""}),[m,v,h]);return Object(k.jsxs)("div",{className:"page-container chat-page",children:[Object(k.jsx)(S.a,{solid:!0,pageTitle:N,enableBackButton:!0}),Object(k.jsx)("div",{className:"chat-messages-container",children:null===b||void 0===b?void 0:b.map((function(e){return Object(k.jsx)(z,{text:e.body,receivedMessage:!e.outgoing,status:e.status,timestamp:e.timestamp})}))}),v?Object(k.jsxs)("div",{className:"chat-permission-bar",children:[Object(k.jsxs)("p",{className:"chat-permission-bar-title unselectable",children:[N," has sent you a chat request!"]}),Object(k.jsxs)("p",{className:"chat-permission-bar-text",children:["Once you accept the request, you'll be able to chat and send invoices to ",N]}),Object(k.jsxs)("div",{className:"chat-permission-bar-actions unselectable",children:[Object(k.jsx)("div",{className:"chat-permission-bar-action chat-permission-bar-action-accept",onClick:O,children:"Accept"}),Object(k.jsx)("div",{className:"chat-permission-bar-action chat-permission-bar-action-decline",children:"Decline"})]})]}):m?Object(k.jsxs)("div",{className:"chat-permission-bar",children:[Object(k.jsxs)("p",{className:"chat-permission-bar-title",children:["Your request has been sent to ",N," successfully"]}),Object(k.jsxs)("p",{className:"chat-permission-bar-text unselectable",children:["Once ",N," accepts the request, you'll be able to chat with them"]})]}):Object(k.jsx)("div",{className:"chat-bottom-bar",children:Object(k.jsxs)("div",{className:"chat-input-container",children:[Object(k.jsx)("div",{className:"chat-input-btn unselectable",children:Object(k.jsx)("img",{src:C.a,alt:"Menu"})}),Object(k.jsx)(y,{className:"chat-input",type:"text",enterKeyHint:"send",onKeyPress:x,onChange:g,value:l,height:20})]})})]})}}}]);
//# sourceMappingURL=26.96ab20ac.chunk.js.map