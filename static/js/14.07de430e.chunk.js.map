{"version":3,"sources":["common/Modal/components/ModalContent/index.js","common/Modal/components/ModalTitle/index.js","common/Modal/index.js","common/InputGroup/index.js","common/BottomBar/index.js","common/Modal/components/ModalSubmit/index.js","pages/Feed/components/SendTipModal/index.js","pages/Feed/components/ShareModal/index.js","pages/Feed/components/UnlockModal/index.js","utils/Cache.js","utils/Promise.js","utils/Torrents.js","pages/Feed/css/Feed.module.css","pages/Feed/index.js"],"names":["ModalContent","children","style","className","ModalTitle","title","toggleModal","onClick","Modal","modalOpen","modalTitle","contentStyle","closeModal","useCallback","classNames","modal","InputGroup","label","name","onChange","inputAction","actionIcon","value","inputMode","type","element","small","disabled","group","fas","BottomBar","to","activeClassName","ModalSubmit","text","SendTipModal","tipData","toggleOpen","dispatch","useDispatch","useState","error","setError","loading","setLoading","amount","setAmount","tipSuccess","setTipSuccess","onInputChange","e","target","submitTip","a","preventDefault","sendTipPost","publicKey","postId","postID","console","errorMessage","message","responseError","response","data","useEffect","onSubmit","overlay","ShareModal","shareData","success","setSuccess","submitShare","id","sharedPostRaw","originalAuthor","shareDate","Date","now","Http","post","path","ok","UnlockModal","unlockData","unlockSuccess","setUnlockSuccess","submitUnlock","unlockContent","getCachedFile","fileName","FileCache","_init","Promise","resolve","reject","init","then","log","persist","status","persistent","load","cachedFile","createURL","warn","renderCachedFile","fileURL","selector","elements","document","querySelectorAll","length","forEach","src","muted","autoplay","saveFile","buffer","save","runSerial","tasks","result","task","supportedFileTypes","formats","options","_getFileType","file","extension","split","slice","supportedFileType","Object","entries","filter","includes","fileType","webTorrentClient","WebTorrent","attachMedia","posts","torrentMode","allowDuplicates","torrentTasks","map","contentItems","item","key","get","magnetURI","add","torrent","files","destroy","torrentElement","contentURL","decodeURIComponent","replace","format","toLowerCase","endsWith","compatibleURL","elementSrc","getAttribute","setAttribute","renderTo","on","getBlob","err","blob","querySelector","dataset","played","reduce","torrents","module","exports","Post","React","lazy","SharedPost","FeedPage","history","useHistory","follows","Store","feed","userProfiles","tipModalData","setTipModalOpen","unlockModalData","setUnlockModalOpen","shareModalData","setShareModalData","selfPublicKey","subscribeFollows","unsubscribeFollows","followedPosts","useMemo","values","userPosts","p","isSharedPost","find","f","user","sharerId","authorId","sort","b","alpha","date","toggleTipModal","toggleUnlockModal","toggleShareModal","useLayoutEffect","subscriptions","follow","profileSubscription","subscribeUserProfile","postsSubscription","subscribeUserPosts","sharedPostsSubscription","subscribeSharedUserPosts","rifleCleanup","unsubscribe","styles","followed","forceAddBtn","height","onPress","push","nameAtBottom","index","originalPost","streamContentId","streamItem","liveStatus","playbackMagnet","sharerProfile","Common","originalPublicKey","originalProfile","fallback","originalPostProfile","sharedTimestamp","postPublicKey","openTipModal","openUnlockModal","openShareModal","profile","timestamp","username","processDisplayName","displayName","tipCounter","tipValue"],"mappings":"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","file":"static/js/14.07de430e.chunk.js","sourcesContent":["// @ts-check\nimport \"./css/index.scoped.css\";\n\nconst ModalContent = ({ children, style }) => (\n  <div className=\"content\" style={style}>\n    {children}\n  </div>\n);\n\nexport default ModalContent;\n","import React from \"react\";\nimport \"./css/index.scoped.css\";\n\nconst ModalTitle = ({ title, toggleModal }) =>\n  title ? (\n    <div className=\"head\">\n      <p className=\"head-title\">{title}</p>\n      <div className=\"head-close\" onClick={toggleModal}>\n        <i className=\"fas fa-times\"></i>\n      </div>\n    </div>\n  ) : null;\n\nexport default ModalTitle;\n","// @ts-check\nimport { useCallback } from \"react\";\nimport classNames from \"classnames\";\nimport ModalContent from \"./components/ModalContent\";\nimport ModalTitle from \"./components/ModalTitle\";\nimport \"./css/index.scoped.css\";\n\nconst Modal = ({\n  modalOpen = false,\n  toggleModal,\n  modalTitle = \"\",\n  children,\n  contentStyle = {}\n}) => {\n  const closeModal = useCallback(() => {\n    toggleModal();\n  }, [toggleModal]);\n  return (\n    <div className={classNames({ modal: true, \"open\": modalOpen })}>\n      <div className=\"backdrop\" onClick={closeModal} />\n      <div className=\"container\">\n        <ModalTitle title={modalTitle} toggleModal={closeModal} />\n        <ModalContent style={contentStyle}>{children}</ModalContent>\n      </div>\n    </div>\n  );\n};\n\nexport default Modal;\n","import classNames from \"classnames\";\nimport \"./css/index.scoped.css\";\n\nconst InputGroup = ({\n  label,\n  name,\n  onChange,\n  inputAction,\n  actionIcon,\n  value,\n  inputMode = \"text\",\n  type = \"text\",\n  element = \"input\",\n  small = false,\n  disabled\n}) => {\n  return (\n    <div\n      className={classNames({\n        group: true,\n        \"group-disabled\": disabled,\n        \"group-small\": small\n      })}\n    >\n      {label ? <p className=\"group-label\">{label}</p> : null}\n      <div\n        className={classNames({\n          \"group-input-container\": true,\n          \"group-input-textarea-container\": element === \"textarea\"\n        })}\n      >\n        {element === \"textarea\" ? (\n          <textarea\n            className=\"group-input group-input-textarea\"\n            name={name}\n            onChange={onChange}\n            inputMode={inputMode}\n            value={value}\n            disabled={disabled}\n          />\n        ) : (\n          <input\n            className=\"group-input\"\n            type={type}\n            name={name}\n            onChange={onChange}\n            inputMode={inputMode}\n            value={value}\n            disabled={disabled}\n          />\n        )}\n        {inputAction && actionIcon ? (\n          <div className=\"group-input-action\" onClick={inputAction}>\n            <i\n              className={classNames({\n                \"group-input-action-icon\": true,\n                fas: true,\n                [actionIcon]: true\n              })}\n              onClick={inputAction}\n            ></i>\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n};\n\nexport default InputGroup;\n","import { NavLink } from \"react-router-dom\";\n\nconst BottomBar = () => (\n  <div className=\"bottom-nav-container\">\n    <NavLink\n      className=\"bottom-nav-btn\"\n      to=\"/overview\"\n      activeClassName=\"active-nav-btn\"\n    >\n      <i className=\"bottom-nav-btn-icon icon-thin-wallet\"></i>\n    </NavLink>\n    <NavLink\n      className=\"bottom-nav-btn\"\n      to=\"/chat\"\n      activeClassName=\"active-nav-btn\"\n    >\n      <i className=\"bottom-nav-btn-icon icon-thin-chat\"></i>\n    </NavLink>\n    <NavLink\n      className=\"bottom-nav-btn\"\n      to=\"/profile\"\n      activeClassName=\"active-nav-btn\"\n    >\n      <i className=\"bottom-nav-btn-icon icon-thin-profile\"></i>\n    </NavLink>\n    <NavLink\n      className=\"bottom-nav-btn\"\n      to=\"/feed\"\n      activeClassName=\"active-nav-btn\"\n    >\n      <i className=\"bottom-nav-btn-icon icon-thin-feed\"></i>\n    </NavLink>\n  </div>\n);\n\nexport default BottomBar;\n","import React from \"react\";\nimport \"./css/index.scoped.css\";\nimport \"../../css/index.scoped.css\"\n\nconst ModalSubmit = ({ text = \"Submit\", onClick }) => {\n  return (\n    <div className=\"submit-btn\" onClick={onClick}>\n      <p className=\"submit-btn-text\">{text}</p>\n    </div>\n  );\n};\n\nexport default ModalSubmit;\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport Modal from \"../../../../common/Modal\";\nimport ModalSubmit from \"../../../../common/Modal/components/ModalSubmit\";\nimport InputGroup from \"../../../../common/InputGroup\";\nimport { sendTipPost } from \"../../../../actions/FeedActions\";\nimport Loader from \"../../../../common/Loader\";\nimport \"./css/index.scoped.css\";\n\nconst SendTipModal = ({ tipData, toggleOpen }) => {\n  const dispatch = useDispatch();\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [amount, setAmount] = useState(0);\n  const [tipSuccess, setTipSuccess] = useState(false);\n\n  const onInputChange = useCallback(e => {\n    if (e.target.name === \"amount\") {\n      setAmount(e.target.value);\n    }\n  }, []);\n\n  const submitTip = useCallback(\n    async e => {\n      e.preventDefault();\n      try {\n        setLoading(true);\n        await dispatch(\n          sendTipPost({\n            amount,\n            publicKey: tipData.publicKey,\n            postId: tipData.postID\n          })\n        );\n        setTipSuccess(true);\n      } catch (err) {\n        console.error(err);\n        if (tipData) {\n          const errorMessage = err.message;\n          const responseError = err.response?.data?.errorMessage;\n          setError(responseError ?? errorMessage);\n        }\n      } finally {\n        setLoading(false);\n      }\n    },\n    [dispatch, amount, tipData]\n  );\n\n  // Reset the modal's state\n  useEffect(() => {\n    if (!tipData) {\n      setLoading(false);\n      setError(null);\n      setTipSuccess(false);\n    }\n  }, [tipData]);\n\n  return (\n    <Modal toggleModal={toggleOpen} modalOpen={!!tipData} modalTitle=\"Send Tip\">\n      {tipSuccess ? (\n        <div className=\"tip-modal-success m-1\">\n          <i className=\"tip-success-icon fas fa-check-circle\"></i>\n          <p className=\"tip-success-title\">Post tipped successfully!</p>\n          <p className=\"tip-success-desc\"></p>\n        </div>\n      ) : (\n        <form className=\"modal-form tip-form m-1\" onSubmit={submitTip}>\n          {error ? <div className=\"form-error\">{error}</div> : null}\n          {loading ? <Loader overlay text=\"Sending Tip...\" /> : null}\n          <p className=\"tip-modal-desc m-1\">\n            Please specify the amount of sats you'd like to tip this user with\n            below.\n          </p>\n          <InputGroup\n            name=\"amount\"\n            onChange={onInputChange}\n            value={amount}\n            inputMode=\"decimal\"\n            small\n          />\n          <ModalSubmit text=\"SEND TIP\" onClick={submitTip} />\n        </form>\n      )}\n    </Modal>\n  );\n};\n\nexport default SendTipModal;\n","// @ts-check\nimport { useCallback, useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport Modal from \"../../../../common/Modal\";\nimport ModalSubmit from \"../../../../common/Modal/components/ModalSubmit\";\nimport Loader from \"../../../../common/Loader\";\nimport \"./css/index.scoped.css\";\nimport { Http } from \"../../../../utils\";\n\nconst ShareModal = ({ shareData, toggleOpen }) => {\n  const dispatch = useDispatch();\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [success, setSuccess] = useState(false);\n\n  const submitShare = useCallback(\n    async e => {\n      e.preventDefault();\n      try {\n        setLoading(true);\n        const {postID:id,publicKey} = shareData\n        const sharedPostRaw = {\n          originalAuthor: publicKey,\n          shareDate: Date.now(),\n        }\n        const {data} = await Http.post(`/api/gun/put`, {\n          path: `$user>sharedPosts>${id}`,\n          value: sharedPostRaw,\n        })\n        if(data.ok){\n          setSuccess(true)\n        } else {\n          setError(\"Share operation failed\")\n        }\n      } catch (err) {\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    },\n    [dispatch, shareData]\n  );\n\n  // Reset the modal's state\n  useEffect(() => {\n    if (!shareData) {\n      setLoading(false);\n      setError(null);\n      setSuccess(false);\n    }\n  }, [shareData]);\n\n  return (\n    <Modal\n      toggleModal={toggleOpen}\n      modalOpen={!!shareData}\n      modalTitle=\"Share post\"\n    >\n      {success ? (\n        <div className=\"tip-modal-success m-1\">\n          <i className=\"tip-success-icon fas fa-check-circle\"></i>\n          <p className=\"tip-success-title\">Post shared successfully!</p>\n        </div>\n      ) : (\n        <form className=\"modal-form tip-form m-1\" onSubmit={submitShare}>\n          {error ? <div className=\"form-error\">{error}</div> : null}\n          {loading ? <Loader overlay text=\"Sharing...\" /> : null}\n          <p className=\"tip-modal-desc m-1\">\n            This post will be shared on your profile\n          </p>\n          <ModalSubmit text=\"SHARE\" onClick={submitShare} />\n        </form>\n      )}\n    </Modal>\n  );\n};\n\nexport default ShareModal;\n","// @ts-check\nimport { useCallback, useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport Modal from \"../../../../common/Modal\";\nimport ModalSubmit from \"../../../../common/Modal/components/ModalSubmit\";\nimport { unlockContent } from \"../../../../actions/ContentActions\";\nimport Loader from \"../../../../common/Loader\";\nimport \"./css/index.scoped.css\";\n\nconst UnlockModal = ({ unlockData, toggleOpen }) => {\n  const dispatch = useDispatch();\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [unlockSuccess, setUnlockSuccess] = useState(false);\n\n  const submitUnlock = useCallback(\n    async e => {\n      e.preventDefault();\n      try {\n        setLoading(true);\n        await unlockContent(\n          100,\n          unlockData.publicKey,\n          unlockData.postID\n        )(dispatch);\n        setUnlockSuccess(true);\n      } catch (err) {\n        console.error(err);\n        if (unlockData) {\n          const errorMessage = err.message;\n          const responseError = err.response?.data?.errorMessage;\n          setError(responseError ?? errorMessage);\n        }\n      } finally {\n        setLoading(false);\n      }\n    },\n    [dispatch, unlockData]\n  );\n\n  // Reset the modal's state\n  useEffect(() => {\n    if (!unlockData) {\n      setLoading(false);\n      setError(null);\n      setUnlockSuccess(false);\n    }\n  }, [unlockData]);\n\n  return (\n    <Modal\n      toggleModal={toggleOpen}\n      modalOpen={!!unlockData}\n      modalTitle=\"Unlock content\"\n    >\n      {unlockSuccess ? (\n        <div className=\"tip-modal-success\">\n          <i className=\"tip-success-icon fas fa-check-circle\"></i>\n          <p className=\"tip-success-title\">Content unlocked successfully!</p>\n          {/*<p className=\"tip-success-desc\">\n            Lorem ipsum, dolor sit amet consectetur adipisicing elit. Sunt\n            ratione repudiandae voluptates debitis esse ea ut molestiae\n            praesentium possimus quia\n          </p>*/}\n        </div>\n      ) : (\n        <form className=\"modal-form tip-form\" onSubmit={submitUnlock}>\n          {error ? <div className=\"form-error\">{error}</div> : null}\n          {loading ? <Loader overlay text=\"Sending Tip...\" /> : null}\n          <p className=\"tip-modal-desc\">\n            100 sats will be sent to the owner of the post to unlock the content\n          </p>\n          <ModalSubmit text=\"UNLOCK\" onClick={submitUnlock} />\n        </form>\n      )}\n    </Modal>\n  );\n};\n\nexport default UnlockModal;\n","import FileCache from \"browser-file-storage\";\n\nexport const DB_NAME = \"ShockWalletStore\";\n\nexport const init = () =>\n  new Promise((resolve, reject) => {\n    FileCache.init(DB_NAME)\n      .then(() => {\n        console.log(\"File cache initialized!\");\n        return FileCache.persist();\n      })\n      .then(status => {\n        if (status.persistent) {\n          resolve(status);\n        } else {\n          reject(status);\n        }\n      });\n  });\n\nexport const getCachedFile = async fileName => {\n  try {\n    if (!FileCache._init) {\n      await init();\n    }\n\n    const cachedFile = await FileCache.load(fileName);\n    return cachedFile.createURL();\n  } catch (err) {\n    console.warn(err);\n    return false;\n  }\n};\n\nexport const renderCachedFile = (fileURL, selector) => {\n  const elements = document.querySelectorAll(selector);\n  if (elements && elements.length) {\n    elements.forEach(element => {\n      if (!element.src) {\n        element.src = fileURL;\n        element.muted = true;\n        element.autoplay = true;\n      }\n    });\n  }\n  return !!elements?.length;\n};\n\nexport const saveFile = (fileName, buffer) => {\n  return FileCache.save(fileName, buffer);\n};\n","export const runSerial = tasks => {\n  let result = Promise.resolve();\n  tasks.forEach(task => {\n    result = result.then(() => task());\n  });\n  return result;\n};\n","import WebTorrent from \"webtorrent\";\nimport { getCachedFile, renderCachedFile, saveFile } from \"./Cache\";\nimport { runSerial } from \"./Promise\";\n\nconst supportedFileTypes = {\n  \"video/embedded\": {\n    formats: [\"mp4\", \"webm\"],\n    element: \"video\",\n    options: {\n      autoplay: true,\n      muted: true\n    }\n  },\n  \"image/embedded\": {\n    formats: [\"jpg\", \"png\", \"webp\", \"jpeg\"],\n    element: \"img\",\n    options: {}\n  }\n};\n\nconst _getFileType = file => {\n  const extension = file.name?.split(\".\")?.slice(-1)[0];\n  const supportedFileType = Object.entries(\n    supportedFileTypes\n  ).filter(([type, options]) => options.formats.includes(extension))[0];\n\n  if (supportedFileType) {\n    const [name, fileType] = supportedFileType;\n    return {\n      name,\n      ...fileType\n    };\n  }\n\n  return null;\n};\n\nexport const webTorrentClient = new WebTorrent();\n\nexport const attachMedia = (\n  posts = [],\n  torrentMode = true,\n  allowDuplicates = false\n) => {\n  const torrentTasks = posts\n    .map(post => {\n      const { contentItems, id } = post;\n      return Object.entries(contentItems)\n        .filter(([key, item]) => supportedFileTypes[item.type])\n        .map(([key, item]) => () =>\n          new Promise(resolve => {\n            const torrentExists = webTorrentClient.get(item.magnetURI);\n\n            if (torrentExists && !allowDuplicates) {\n              resolve(true);\n              return;\n            }\n\n            webTorrentClient.add(item.magnetURI, async torrent => {\n              // Proceed to the next torrent in queue\n              resolve(true);\n\n              const files = torrent.files.filter(file => {\n                const extension = file.name?.split(\".\")?.slice(-1)[0];\n                const supportedFileType = Object.entries(\n                  supportedFileTypes\n                ).filter(([type, options]) =>\n                  options.formats.includes(extension)\n                )[0];\n                if (supportedFileType) {\n                  const [, fileType] = supportedFileType;\n                  const matched = fileType.formats.includes(extension);\n                  return matched;\n                }\n                return false;\n              });\n\n              files.map(async file => {\n                const fileType = _getFileType(file);\n\n                if (!fileType) {\n                  return;\n                }\n\n                const fileName = `${id}-${key}-${file.name}`;\n\n                const element = fileType.element;\n                const target = `${element}[data-torrent=\"${item.magnetURI}\"]`;\n                const cachedFile = await getCachedFile(fileName);\n\n                if (cachedFile) {\n                  const torrent = webTorrentClient.get(item.magnetURI);\n\n                  if (torrent) {\n                    torrent.destroy();\n                  }\n\n                  renderCachedFile(cachedFile, target);\n                  return;\n                }\n\n                const torrentElements = document.querySelectorAll(target);\n                torrentElements.forEach(torrentElement => {\n                  const contentURL = decodeURIComponent(\n                    item.magnetURI.replace(/.*(ws=)/gi, \"\")\n                  );\n                  const [compatibleURL] = fileType.formats.filter(format =>\n                    contentURL\n                      .toLowerCase()\n                      .endsWith(`.${format.toLowerCase()}`)\n                  );\n                  const elementSrc = torrentElement.getAttribute(\"src\");\n\n                  if ((torrentMode || !compatibleURL) && !elementSrc) {\n                    file.renderTo(torrentElement, fileType.options);\n                    return;\n                  }\n\n                  torrentElement.setAttribute(\"src\", contentURL);\n                });\n              });\n\n              torrent.on(\"done\", () => {\n                files.map(file => {\n                  const fileType = _getFileType(file);\n                  const fileName = `${id}-${key}-${file.name}`;\n                  const element = fileType.element;\n                  const target = `${element}[data-torrent=\"${item.magnetURI}\"]`;\n\n                  file.getBlob(async (err, blob) => {\n                    if (err) {\n                      console.warn(err);\n                      return;\n                    }\n\n                    await saveFile(fileName, blob);\n                    const element = document.querySelector(target);\n                    if (\n                      element?.dataset.played === \"false\" &&\n                      !element?.getAttribute(\"src\")\n                    ) {\n                      const cachedFile = await getCachedFile(fileName);\n                      renderCachedFile(cachedFile, target);\n                    }\n                  });\n\n                  return file;\n                });\n              });\n            });\n          })\n        );\n    })\n    .reduce((torrents, contentItems) => [...torrents, ...contentItems], []);\n\n  runSerial(torrentTasks);\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"followed\":\"Feed_followed__1ZWr5\"};","// @ts-check\nimport React, {\n  Suspense,\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useState\n} from \"react\";\nimport * as Common from \"shock-common\";\nimport { useHistory } from \"react-router-dom\";\n\nimport { processDisplayName } from \"../../utils/String\";\nimport { attachMedia } from \"../../utils/Torrents\";\nimport * as Store from \"../../store\";\nimport BottomBar from \"../../common/BottomBar\";\n\nimport SendTipModal from \"./components/SendTipModal\";\nimport ShareModal from \"../Feed/components/ShareModal\";\nimport Loader from \"../../common/Loader\";\nimport ShockAvatar from \"../../common/ShockAvatar\";\n\nimport { isSharedPost } from \"../../schema\";\n\nimport \"./css/index.scoped.css\";\nimport UnlockModal from \"./components/UnlockModal\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  subscribeFollows,\n  subscribeSharedUserPosts,\n  subscribeUserPosts,\n  unsubscribeFollows\n} from \"../../actions/FeedActions\";\nimport { subscribeUserProfile } from \"../../actions/UserProfilesActions\";\nimport { rifleCleanup } from \"../../utils/WebSocket\";\nimport styles from \"./css/Feed.module.css\";\n\nconst Post = React.lazy(() => import(\"../../common/Post\"));\nconst SharedPost = React.lazy(() => import(\"../../common/Post/SharedPost\"));\n\nconst FeedPage = () => {\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const follows = Store.useSelector(Store.selectFollows);\n  const posts = Store.useSelector(({ feed }) => feed.posts);\n  const userProfiles = Store.useSelector(({ userProfiles }) => userProfiles);\n  const [tipModalData, setTipModalOpen] = useState(null);\n  const [unlockModalData, setUnlockModalOpen] = useState(null);\n  const [shareModalData, setShareModalData] = useState(null);\n  const { publicKey: selfPublicKey } = Store.useSelector(Store.selectSelfUser);\n  // Effect to sub follows\n  useEffect(() => {\n    dispatch(subscribeFollows());\n    return () => {\n      dispatch(unsubscribeFollows());\n    };\n  }, [dispatch]);\n  const followedPosts = useMemo(() => {\n    if (posts) {\n      const feed = Object.values(posts)\n        .reduce((posts, userPosts) => [...posts, ...userPosts], [])\n        .filter(p => {\n          if (isSharedPost(p)) {\n            return !!follows.find(f => f.user === p.sharerId);\n          }\n          return !!follows.find(f => f.user === p.authorId);\n        })\n        .sort((a, b) => {\n          const alpha = isSharedPost(a) ? a.shareDate : a.date;\n          const beta = isSharedPost(b) ? b.shareDate : b.date;\n\n          return beta - alpha;\n        });\n\n      return feed;\n    }\n\n    return [];\n  }, [follows, posts]);\n\n  const toggleTipModal = useCallback(\n    tipData => {\n      console.log(tipData);\n      if (tipModalData || !tipData) {\n        setTipModalOpen(null);\n      }\n\n      setTipModalOpen(tipData);\n    },\n    [tipModalData]\n  );\n  const toggleUnlockModal = useCallback(\n    unlockData => {\n      console.log(unlockData);\n      if (unlockModalData || !unlockData) {\n        setUnlockModalOpen(null);\n      }\n\n      setUnlockModalOpen(unlockData);\n    },\n    [unlockModalData]\n  );\n\n  const toggleShareModal = useCallback(\n    shareData => {\n      console.log(shareData);\n      if (shareModalData || !shareData) {\n        setShareModalData(null);\n      }\n\n      setShareModalData(shareData);\n    },\n    [shareModalData]\n  );\n\n  useLayoutEffect(() => {\n    attachMedia(\n      followedPosts.filter(post => post.type === \"post\"),\n      false\n    );\n  }, [followedPosts]);\n\n  useEffect(() => {\n    const subscriptions = follows.map(follow => {\n      const profileSubscription = dispatch(subscribeUserProfile(follow.user));\n      const postsSubscription = dispatch(subscribeUserPosts(follow.user));\n      const sharedPostsSubscription = dispatch(\n        subscribeSharedUserPosts(follow.user)\n      );\n\n      return () => {\n        // @ts-ignore\n        profileSubscription();\n        rifleCleanup(postsSubscription, sharedPostsSubscription)();\n      };\n    });\n\n    return () => {\n      subscriptions.map(unsubscribe => unsubscribe());\n    };\n  }, [follows, dispatch]);\n\n  return (\n    <div className=\"page-container feed-page\">\n      <div className={styles.followed}>\n        <ShockAvatar\n          forceAddBtn\n          height={60}\n          publicKey={selfPublicKey}\n          onPress={useCallback(() => {\n            history.push(\"/createPost\");\n          }, [history])}\n        />\n\n        {follows?.map(follow => {\n          return (\n            <ShockAvatar\n              height={60}\n              key={follow.user}\n              nameAtBottom\n              publicKey={follow.user}\n            />\n          );\n        })}\n      </div>\n\n      <div className=\"tabs-holder\">\n        <p className=\"tab active\">Feed</p>\n        <p className=\"tab\">Saved</p>\n        <p className=\"tab\">Videos</p>\n      </div>\n      <div className=\"posts-holder no-scrollbar\">\n        {followedPosts.length === 0 && <Loader text=\"loading posts...\" />}\n        {followedPosts.map((post, index) => {\n          if (post.type === \"shared\") {\n            if (!post.originalPost) {\n              return null;\n            }\n            const item = Object.entries(post.originalPost.contentItems).find(\n              ([_, item]) => item.type === \"stream/embedded\"\n            );\n            let streamContentId, streamItem;\n            if (item) {\n              [streamContentId, streamItem] = item;\n            }\n            if (streamItem) {\n              //@ts-expect-error\n              if (!streamItem.liveStatus) {\n                return null;\n              }\n              //@ts-expect-error\n              if (streamItem.liveStatus === \"waiting\") {\n                return null;\n              }\n              //@ts-expect-error\n              if (streamItem.liveStatus === \"wasLive\") {\n                //@ts-expect-error\n                if (!streamItem.playbackMagnet) {\n                  return null;\n                }\n                post.originalPost.contentItems[streamContentId].type =\n                  \"video/embedded\";\n                //@ts-expect-error\n                post.originalPost.contentItems[streamContentId].magnetURI =\n                  //@ts-expect-error\n                  streamItem.playbackMagnet;\n              }\n            }\n            const sharerProfile =\n              userProfiles[post.sharerId] ||\n              Common.createEmptyUser(post.sharerId);\n            const originalPublicKey = post.originalAuthor;\n            const originalProfile =\n              userProfiles[originalPublicKey] ||\n              Common.createEmptyUser(originalPublicKey);\n            return (\n              <Suspense fallback={<Loader />} key={index}>\n                <SharedPost\n                  originalPost={post.originalPost}\n                  originalPostProfile={originalProfile}\n                  sharedTimestamp={post.shareDate}\n                  sharerProfile={sharerProfile}\n                  postPublicKey={originalPublicKey}\n                  openTipModal={toggleTipModal}\n                  openUnlockModal={toggleUnlockModal}\n                  openShareModal={toggleShareModal}\n                />\n              </Suspense>\n            );\n          }\n\n          const item = Object.entries(post.contentItems).find(\n            ([_, item]) => item.type === \"stream/embedded\"\n          );\n          let streamContentId, streamItem;\n          if (item) {\n            [streamContentId, streamItem] = item;\n          }\n          if (streamItem) {\n            //@ts-expect-error\n            if (!streamItem.liveStatus) {\n              return null;\n            }\n            //@ts-expect-error\n            if (streamItem.liveStatus === \"waiting\") {\n              return null;\n            }\n            //@ts-expect-error\n            if (streamItem.liveStatus === \"wasLive\") {\n              //@ts-expect-error\n              if (!streamItem.playbackMagnet) {\n                return null;\n              }\n              post.contentItems[streamContentId].type = \"video/embedded\";\n              //@ts-expect-error\n              post.contentItems[streamContentId].magnetURI =\n                //@ts-expect-error\n                streamItem.playbackMagnet;\n            }\n          }\n          const profile =\n            userProfiles[post.authorId] ||\n            Common.createEmptyUser(post.authorId);\n\n          return (\n            <Suspense fallback={<Loader />} key={index}>\n              <Post\n                id={post.id}\n                timestamp={post.date}\n                contentItems={post.contentItems}\n                username={processDisplayName(\n                  profile?.publicKey,\n                  profile?.displayName\n                )}\n                publicKey={post.authorId}\n                openTipModal={toggleTipModal}\n                openUnlockModal={toggleUnlockModal}\n                //@ts-expect-error\n                tipCounter={post.tipCounter || 0}\n                //@ts-expect-error\n                tipValue={post.tipValue || 0}\n                openShareModal={toggleShareModal}\n              />\n            </Suspense>\n          );\n        })}\n      </div>\n      <SendTipModal tipData={tipModalData} toggleOpen={toggleTipModal} />\n      <UnlockModal\n        unlockData={unlockModalData}\n        toggleOpen={toggleUnlockModal}\n      />\n      <ShareModal shareData={shareModalData} toggleOpen={toggleShareModal} />\n      <BottomBar />\n    </div>\n  );\n};\n\nexport default FeedPage;\n"],"sourceRoot":""}