(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[35,43],{625:function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return w}));var r=n(3),a=n.n(r),c=n(5),u=n(0),o=n(13),i=n(23),s=n(649),l=n.n(s),f=function(){var e=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l.a._init){e.next=4;break}return e.next=4,new Promise((function(e,t){l.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),l.a.persist()})).then((function(n){n.persistent?e(n):t(n)}))}));case 4:return e.next=6,l.a.load(t);case 6:return n=e.sent,e.abrupt("return",n.createURL());case 10:return e.prev=10,e.t0=e.catch(0),console.warn(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),d=function(e,t){var n=document.querySelectorAll(t);return n&&n.length&&n.forEach((function(t){t.src||(t.src=e,t.muted=!0,t.autoplay=!1)})),!!(null===n||void 0===n?void 0:n.length)},p=function(e,t){return l.a.save(e,t)},b=function(e){var t=Promise.resolve();return e.forEach((function(e){t=t.then((function(){return e()}))})),t},v={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!1,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},m=(Object.values(v).reduce((function(e,t){return[].concat(Object(i.a)(e),Object(i.a)(t.formats))}),[]),function(e){var t,n;if(!e)return null;var r=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],a=Object.entries(v).filter((function(e){var t=Object(o.a)(e,2);t[0];return t[1].formats.includes(r)})),c=Object(o.a)(a,1)[0];if(c){var i=Object(o.a)(c,2),s=i[0],l=i[1];return Object(u.a)({name:s},l)}return null}),h=null,j=function(){var e=Object(c.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=5;break}return e.next=3,Promise.all([n.e(14),n.e(20)]).then(n.t.bind(null,907,7));case 3:t=e.sent,h=new t.default;case 5:return e.abrupt("return",h);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(e){var t,n,r,a=e.thumbnailFile,c=e.fileType,u=e.item,o=m(a),i="".concat(null!==(t=null===o||void 0===o?void 0:o.element)&&void 0!==t?t:"img",'[data-torrent="').concat(u.magnetURI,'"]'),s='.dynamic-thumbnail[data-torrent="'.concat(u.magnetURI,'"]');a||"video"!==c.element||(null===(n=document.querySelector(i))||void 0===n||n.classList.add("hidden"),null===(r=document.querySelector(s))||void 0===r||r.classList.remove("hidden"))},g=function(e){var t=e.id,n=e.key;return function(e){return"".concat(t,"-").concat(n,"-").concat(e.name)}},x=function(e){var t=e.file,n=e.type,r=e.torrentMode,a=e.torrent,c=n.element,u="".concat(c,'[data-torrent="').concat(a.magnetURI,'"]'),i=document.querySelectorAll(u);console.log("Torrent Elements:",i),i.forEach((function(e){if(!e.classList.contains("hidden")){var c=decodeURIComponent(a.magnetURI.replace(/.*(ws=)/gi,"")),u=n.formats.filter((function(e){return c.toLowerCase().endsWith(".".concat(e.toLowerCase()))})),i=Object(o.a)(u,1)[0];!r&&i?e.setAttribute("src",c):t.renderTo(e,n.options)}}))},y=function(e){var t=e.thumbnailFileNames,n=e.getCacheFileName,r=e.torrentMode;return function(){var e=Object(c.a)(a.a.mark((function e(c){var u,o,i,s,l,p,b,v,h,j,g,y,k;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=c.fileName,i=c.thumbnails,s=c.item,l=c.fileType,p=o.split(".").slice(0,-1).join("."),b="".concat(p,"-thumb"),v=t.indexOf(b),h=i[v],j=h?m(h):null,g="".concat(null!==(u=null===j||void 0===j?void 0:j.element)&&void 0!==u?u:"img",'[data-torrent="').concat(s.magnetURI,'"]'),"video"!==l.element||!h){e.next=17;break}return e.next=10,f(n(h));case 10:if(k=e.sent,null===(y=document.querySelector(g))||void 0===y||y.classList.remove("hidden"),!k){e.next=15;break}return d(k,g),e.abrupt("return");case 15:return x({file:h,type:j,torrentMode:r,torrent:s}),e.abrupt("return");case 17:if("video"!==l.element||h){e.next=20;break}return O({thumbnailFile:h,fileType:l,item:s}),e.abrupt("return");case 20:return e.abrupt("return",{thumbnailFile:h});case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},k=function(){var e=Object(c.a)(a.a.mark((function e(){var t,n,r,u,s=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:[],n=!(s.length>1&&void 0!==s[1])||s[1],e.next=4,Promise.all(t.map(function(){var e=Object(c.a)(a.a.mark((function e(t){var r,u,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.contentItems,u=t.id,i=Object.entries(r).filter((function(e){var t=Object(o.a)(e,2)[1];return v[t.type]}))){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,j();case 6:return s=e.sent,e.abrupt("return",i.map((function(e){var t=Object(o.a)(e,2),r=t[0],i=t[1];return function(){return new Promise((function(e){var t=g({id:u,key:r});s.get(i.magnetURI)?e(!0):s.add(i.magnetURI,function(){var r=Object(c.a)(a.a.mark((function r(u){var o,l,b,h;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e(!0),o=u.files.filter((function(e){var t,n,r=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],a=Object.values(v).filter((function(e){return e.formats.includes(r)}))[0];return!!a&&a.formats.includes(r)})),l=o.filter((function(e){return e.name.match(/-thumb\.([\w\d]){2,4}$/gi)})),b=l.map((function(e){return e.name.replace(/\.([\w\d]){2,4}$/gi,"")})),h=y({getCacheFileName:t,thumbnailFileNames:b,torrentMode:n}),o.map(function(){var e=Object(c.a)(a.a.mark((function e(r){var c,u,o,p,v,j;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b.includes(r.name)){e.next=2;break}return e.abrupt("return");case 2:if(c=m(r)){e.next=5;break}return e.abrupt("return");case 5:return u=t(r),o=c.element,p="".concat(o,'[data-torrent="').concat(i.magnetURI,'"]'),e.next=10,f(u);case 10:if(v=e.sent,h({fileName:r.name,thumbnails:l,fileType:c,item:i}),!v){e.next=17;break}return(j=s.get(i.magnetURI))&&j.destroy(),d(v,p),e.abrupt("return");case 17:x({file:r,type:c,torrentMode:n,torrent:i});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u.on("done",(function(){o.map((function(e){var n=m(e),r=t(e),u=n.element,o="".concat(u,'.torrent-video[data-torrent="').concat(i.magnetURI,'"]');e.getBlob(function(){var e=Object(c.a)(a.a.mark((function e(t,n){var c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return console.warn(t),e.abrupt("return");case 3:return console.log("Caching loaded file...",r,n),e.next=6,p(r,n);case 6:if("false"!==(null===(c=document.querySelector(o))||void 0===c?void 0:c.dataset.played)||(null===c||void 0===c?void 0:c.getAttribute("src"))){e.next=12;break}return e.next=10,f(r);case 10:u=e.sent,d(u,o);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}));case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}))}})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:r=e.sent,u=r.reduce((function(e,t){return[].concat(Object(i.a)(e),Object(i.a)(t))}),[]),b(u);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.magnetURI,e.next=3,j();case 3:if(r=e.sent,!(c=r.get(n))){e.next=8;break}return c.destroy(),e.abrupt("return",!0);case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},674:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=[{user:"tcUUzRkyzXYhIZQbmopiCLREyZ_kQJqQ-C4XesecOm4.GX1Dv-eGcfKuOPobBK9Q-Sc-o697XgVCQzOCfqfimIo",status:"ok",private:!1},{user:"CDfURSDaABun7sbzxt1LvUrTrtgLza_3NrCKrmUWIYU.Ssr3U9JN6cpFI9BZLL-1HLM2vS0ECEt-H4iUXvhkGzU",status:"ok",private:!1},{user:"Fd_7lUhwH7JoHbg6UKnGO9rYsZBOuR1KSbpZz8-Sbcw.fUu68TPuBWl83LBKgAbuiy0r1hMqnUevzyEgqPYu0B4",status:"ok",private:!1}]},763:function(e,t,n){},765:function(e,t,n){e.exports={followed:"Feed_followed__1ZWr5"}},902:function(e,t,n){"use strict";n.r(t);var r=n(13),a=n(1),c=n.n(a),u=n(9),o=n(26),i=(n(625),n(18)),s=n(628),l=n(684),f=n(685),d=n(183),p=n(609),b=(n(763),n(686)),v=n(36),m=n(68),h=n(765),j=n.n(h),O=n(674),g=n(687),x=(n(629),n(4)),y=c.a.lazy((function(){return Promise.all([n.e(1),n.e(3),n.e(2),n.e(34)]).then(n.bind(null,638))})),k=c.a.lazy((function(){return Promise.all([n.e(1),n.e(3),n.e(2),n.e(10),n.e(41)]).then(n.bind(null,691))}));t.default=function(){var e=i.useDispatch(),t=Object(o.g)(),n=i.useSelector((function(e){return e.auth.authenticated})),c=i.useSelector(i.selectFollows),h=i.useSelector(i.selectAllPostsFromFollowedNewestToOldest),w=Object(a.useState)(null),S=Object(r.a)(w,2),U=S[0],I=S[1],C=Object(a.useState)(null),R=Object(r.a)(C,2),N=R[0],F=R[1],L=Object(a.useState)(null),P=Object(r.a)(L,2),K=P[0],M=P[1],D=Object(a.useState)(null),E=Object(r.a)(D,2),T=E[0],q=E[1],z=i.useSelector(i.selectSelfUser).publicKey,B=i.useSelector((function(e){return e.feed.reloadDone}));Object(a.useEffect)((function(){return e(Object(v.p)()),function(){e(Object(v.r)())}}),[e]),Object(a.useEffect)((function(){n||e(Object(v.h)(O.a))}),[n,e]);var A=Object(a.useCallback)((function(e){if(console.log(e),U||!e)return I(null),void q(null);I(e),q(e.publicKey)}),[U]),_=Object(a.useCallback)((function(e){console.log(e),!N&&e||F(null),F(e)}),[N]),Z=Object(a.useCallback)((function(e){console.log(e),!K&&e||M(null),M(e)}),[K]);Object(a.useCallback)((function(){t.push("/auth")}),[t]);return Object(a.useEffect)((function(){var t=c.map((function(t){var n=e(Object(m.b)(t.user)),r=e(Object(v.q)(t.user)),a=e(Object(v.n)(t.user));return function(){n(),r(),a()}}));return function(){t.map((function(e){return e()}))}}),[c,e]),Object(a.useEffect)((function(){h.length>0&&!B&&(e(Object(v.g)()),setTimeout((function(){t.go(0)}),3e3))}),[B,t,e,h.length]),Object(x.jsxs)("div",{className:"page-container feed-page","data-v-1f30ce39":"",children:[Object(x.jsxs)("div",{className:j.a.followed,"data-v-1f30ce39":"",children:[n&&Object(x.jsx)(p.a,{forceAddBtn:!0,height:60,publicKey:z,createsPost:!0,"data-v-1f30ce39":""}),null===c||void 0===c?void 0:c.map((function(e){return Object(x.jsx)(p.a,{height:60,nameAtBottom:!0,publicKey:e.user,"data-v-1f30ce39":""},e.user)}))]}),Object(x.jsxs)("div",{className:"tabs-holder","data-v-1f30ce39":"",children:[Object(x.jsx)("p",{className:"tab active","data-v-1f30ce39":"",children:"Feed"}),Object(x.jsx)("p",{className:"tab","data-v-1f30ce39":"",children:"Saved"}),Object(x.jsx)("p",{className:"tab","data-v-1f30ce39":"",children:"Videos"})]}),Object(x.jsxs)("div",{className:"posts-holder","data-v-1f30ce39":"",children:[0===h.length&&Object(x.jsx)(d.a,{text:"loading posts...","data-v-1f30ce39":""}),h.map((function(e){return u.o(e)?Object(x.jsx)(a.Suspense,{fallback:Object(x.jsx)(d.a,{"data-v-1f30ce39":""}),"data-v-1f30ce39":"",children:Object(x.jsx)(k,{openTipModal:A,openUnlockModal:_,openShareModal:Z,postID:e.originalPostID,sharerPublicKey:e.sharedBy,"data-v-1f30ce39":""})},e.shareID):Object(x.jsx)(a.Suspense,{fallback:Object(x.jsx)(d.a,{"data-v-1f30ce39":""}),"data-v-1f30ce39":"",children:Object(x.jsx)(y,{id:e.id,publicKey:e.authorId,openTipModal:A,openUnlockModal:_,openShareModal:Z,"data-v-1f30ce39":""})},e.id)}))]}),Object(x.jsx)(l.a,{tipData:U,toggleOpen:A,"data-v-1f30ce39":""}),Object(x.jsx)(g.a,{publicKey:T,tipData:U,toggleOpen:A,"data-v-1f30ce39":""}),Object(x.jsx)(b.a,{unlockData:N,toggleOpen:_,"data-v-1f30ce39":""}),Object(x.jsx)(f.a,{shareData:K,toggleOpen:Z,"data-v-1f30ce39":""}),Object(x.jsx)(s.a,{"data-v-1f30ce39":""})]})}}}]);
//# sourceMappingURL=35.35fd8e37.chunk.js.map