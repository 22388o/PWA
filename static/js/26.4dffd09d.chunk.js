(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[26],{488:function(e,t,n){"use strict";var c=n(3),a=n(73),s=n.n(a),r=(n(489),n(7));t.a=function(e){var t=e.pageTitle,n=e.drawerVisible,a=Object(c.useCallback)((function(){window.history.back()}),[]);return Object(r.jsxs)("div",{className:"dialog-nav-container",children:[Object(r.jsx)("div",{className:"dialog-nav-back",onClick:a,children:Object(r.jsx)("i",{className:"icon icon-thin-back"})}),Object(r.jsx)("p",{className:"dialog-nav-title",children:t}),Object(r.jsxs)("div",{className:s()({"dialog-nav-menu-btn":!0,"dialog-nav-hidden":!n}),children:[Object(r.jsx)("div",{className:"dialog-nav-menu-dash"}),Object(r.jsx)("div",{className:"dialog-nav-menu-dash"}),Object(r.jsx)("div",{className:"dialog-nav-menu-dash"})]})]})}},489:function(e,t,n){},530:function(e,t,n){},570:function(e,t,n){"use strict";var c=n(576),a=function(){return!navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i)},s=(n(530),n(7)),r={wizard:{title:"SCAN A",target:"QR CODE",description:"Point your camera at a ShockWizard QR Code"},invoice:{title:"SCAN AN",target:"INVOICE",description:"Point your camera at an LND Invoice"}};t.a=function(e){var t=e.mode,n=void 0===t?"wizard":t,i=e.onScan,o=e.onError,l=e.onClose,u=r[n],b=a()?"user":"environment";return Object(s.jsxs)("div",{className:"qr-code-scanner-container",children:[Object(s.jsx)("div",{className:"qr-scanner-top-section",children:Object(s.jsx)("i",{className:"fas fa-times",onClick:l})}),Object(s.jsx)(c.a,{constraints:{video:{facingMode:{exact:b}}},onScan:i,onError:o}),Object(s.jsx)("div",{className:"qr-scanner-target"}),Object(s.jsxs)("div",{className:"qr-scanner-bottom-section",children:[Object(s.jsxs)("p",{className:"qr-scanner-bottom-title",children:[u.title," ",Object(s.jsx)("span",{className:"qr-scanner-bottom-title-highlight",children:u.target})]}),Object(s.jsx)("p",{className:"qr-scanner-bottom-description",children:u.description}),Object(s.jsx)("div",{className:"qr-scanner-btn",onClick:l,children:"Cancel Scan"})]})]})}},760:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),s=n(5),r=n(17),i=n(3),o=n(21),l=n(720),u=n(488),b=n(150),d=n(570),j=/^(bc(1|r)|[123]|m|n|((t|x)pub)|(tb1))[a-zA-HJ-NP-Z0-9]{25,90}$/,h=/^(ln(tb|bc|bcrt))[0-9][a-z0-9]{180,7089}$/,O=/^[a-f0-9]{66}$/,p=function(e){var t=function(e){var t=e;if(e.includes("bitcoin:")){var n=e.split("bitcoin:");t=Object(r.a)(n,2)[1]}else if(e.includes("lightning:")){var c=e.split("lightning:");t=Object(r.a)(c,2)[1]}else if(e.includes("LIGHTNING:")){var a=e.split("LIGHTNING:");t=Object(r.a)(a,2)[1]}return t}(e),n=function(e){if(e.includes("?amount=")){var t=e.split("?amount="),n=Math.floor(1e8*Number(t[1]));return{address:t[0],amount:n.toString()}}return{address:e,amount:void 0}}(t),c=n.address,a=n.amount;if(function(e){return j.test(e)}(c))return{type:"btc",address:c,amount:a};if(function(e){return h.test(e.toLowerCase())}(t))return{type:"ln",request:t};if(function(e){return O.test(e)}(t))return{type:"keysend",address:t};if(function(e){return e.startsWith("$$__SHOCKWALLET__USER__")}(t))return{type:"pk",pk:t};var s=function(e){var t=/^(http.*[&?]lightning=)?((lnurl)([0-9]{1,}[a-z0-9]+){1})/.exec(e.toLowerCase());return t?t[2]:null}(t);return s?{type:"lnurl",lnurl:s.toUpperCase()}:{type:"unknown"}},x=n(37),v=n(61),m=n(30),g=n(7);t.default=function(){var e=Object(o.g)(),t=Object(x.c)(),n=(Object(x.d)((function(e){return e.node.publicKey})),Object(i.useState)(!1)),c=Object(r.a)(n,2),j=c[0],h=c[1],O=Object(i.useState)(!0),k=Object(r.a)(O,2),f=k[0],C=k[1],w=Object(i.useState)(0),N=Object(r.a)(w,2),y=N[0],q=N[1],S=Object(i.useState)(0),R=Object(r.a)(S,2),L=R[0],A=R[1],E=Object(i.useState)(!1),_=Object(r.a)(E,2),U=_[0],T=_[1],K=Object(i.useState)(""),P=Object(r.a)(K,2),I=P[0],M=P[1],z=Object(i.useState)(null),H=Object(r.a)(z,2),W=H[0],$=H[1],D=Object(i.useState)(!0),B=Object(r.a)(D,2),G=B[0],J=B[1],V=Object(i.useState)(null),Q=Object(r.a)(V,2),F=(Q[0],Q[1]),Z=Object(i.useState)(null),X=Object(r.a)(Z,2),Y=(X[0],X[1]),ee=Object(i.useCallback)((function(){e.push("/overview")}),[e]),te=Object(i.useCallback)((function(e){var t=e.target,n=t.value,c=t.name,a=t.checked;switch(c){case"privateChannel":return void C(a);case"payAmount":return void q(n);case"withdrawAmount":return void A(n);case"hasMemo":return void T(a);case"memo":case"memo":return void M(n);default:return}}),[C,q,A,T,M]),ne=Object(i.useCallback)(function(){var e=Object(s.a)(a.a.mark((function e(t){var n,c,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.prev=1,e.next=4,Object(l.getParams)(t);case 4:(n=e.sent).tag||(c=n,h(!1),Y(c.reason)),s=n,e.t0=s.tag,e.next="channelRequest"===e.t0?10:"withdrawRequest"===e.t0?12:"hostedChannelRequest"===e.t0?14:"login"===e.t0?16:"payRequest"===e.t0?18:20;break;case 10:return console.log("this url is a channel request"),e.abrupt("break",21);case 12:return console.log("this url is a withdrawal request"),e.abrupt("break",21);case 14:return console.log("this url is a hosted channel request"),e.abrupt("break",21);case 16:return console.log("this url is a login "),e.abrupt("break",21);case 18:return console.log("this url is a pay request"),e.abrupt("break",21);case 20:console.log("unknown tag");case 21:$(s),h(!1),e.next=30;break;case 25:e.prev=25,e.t1=e.catch(1),console.log(e.t1),h(!1),Y(e.t1.message||e.t1);case 30:case"end":return e.stop()}}),e,null,[[1,25]])})));return function(t){return e.apply(this,arguments)}}(),[]),ce=Object(i.useCallback)((function(t){console.log("decoding!");var n=p(t);switch(n.type){case"btc":case"ln":case"keysend":return void e.push("/send",{data:n});case"pk":return void e.push("/otherUser/".concat(n.pk));case"lnurl":return void ne(n.lnurl);case"unknown":Y("cant decode"+JSON.stringify(n))}}),[e,Y,ne]),ae=Object(i.useCallback)((function(){J(!1),e.push("/overview")}),[J]),se=Object(i.useCallback)((function(e){console.log(e),e&&e.text&&(ce(e.text),J(!1))}),[ce,J]),re=Object(i.useCallback)(Object(s.a)(a.a.mark((function e(){var t,n,c,s,r,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=W.callback,n=W.k1,e.next=4,v.b.post("/api/lnd/addinvoice",{value:L,memo:I,expiry:1800});case 4:return c=e.sent,s=c.data,r="".concat(t,"?k1=").concat(n,"&pr=").concat(s.payment_request),console.log(r),e.next=10,fetch(r);case 10:return i=e.sent,e.next=13,i.json();case 13:"OK"===(o=e.sent).status?F("Withdraw request sent correctly"):Y(o.reason),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),Y(e.t0.message||e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])}))),[e,W,L,I,F,Y]),ie=Object(i.useCallback)(Object(s.a)(a.a.mark((function e(){var n,c,s,i,o,l,u,b,d,j,h,O,p,x,g,k,C;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=W.uri,c=W.callback,s=W.k1,i=s,"gun"===s&&W.shockPubKey&&(i="$$__SHOCKWALLET__USER__".concat(W.shockPubKey)),o=function(e){return"".concat(e.pub_key,"@").concat(e.address)===n},e.next=7,Object(m.e)()(t);case 7:if(l=e.sent,l.peers.find(o)){e.next=13;break}return u=n.plit("@"),b=Object(r.a)(u,2),d=b[0],j=b[1],e.next=13,Object(m.b)({publicKey:d,host:j});case 13:return e.next=15,v.b.get("/healthz");case 15:return h=e.sent,O=h.data,p=O.identity_pubkey,x=f?1:0,g="".concat(c,"?k1=").concat(i,"&remoteid=").concat(p,"&private=").concat(x),e.next=22,fetch(g);case 22:return k=e.sent,e.next=25,k.json();case 25:"OK"===(C=e.sent).status?F("Channel request sent correctly"):Y(C.reason),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(0),Y(e.t0.message||e.t0);case 32:case"end":return e.stop()}}),e,null,[[0,29]])}))),[e,W,Y]),oe=Object(i.useCallback)(Object(s.a)(a.a.mark((function t(){var n,c,s,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=W.callback,c="".concat(n,"?amount=").concat(1e3*y),console.log(c),t.next=6,fetch(c);case 6:return s=t.sent,t.next=9,s.json();case 9:if("ERROR"!==(r=t.sent).status){t.next=13;break}return Y(r.reason),t.abrupt("return");case 13:e.push("/send",{data:{type:"ln",request:r.pr}}),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),Y(t.t0.message||t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])}))),[e,W,y,Y]),le=Object(i.useMemo)((function(){if(null===W)return null;switch(W.tag){case"channelRequest":return console.log("this url is a channel request"),Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{children:"LNURL Channel Request"}),Object(g.jsxs)("p",{children:["Requesting channel from:",W.uri||"ADDRESS NOT FOUND"]}),Object(g.jsx)("input",{type:"checkbox",name:"privateChannel",checked:f,onChange:te}),Object(g.jsx)("button",{onClick:ie,children:"CONNECT"})]});case"withdrawRequest":return console.log("this url is a withdrawal request"),Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{children:"LNURL Channel Request"}),Object(g.jsxs)("p",{children:[Object(g.jsx)("strong",{children:"Max"}),"Withdrawable: ",Object(g.jsx)("strong",{children:W.maxWithdrawable/1e3})," Satoshi"]}),Object(g.jsx)("input",{type:"number",value:L,name:"withdrawAmount",onChange:te}),Object(g.jsx)("input",{type:"checkbox",name:"hasMemo",checked:U,onChange:te}),U&&Object(g.jsx)("input",{type:"text",value:I,name:"memo",placeholder:"memo",onChange:te}),Object(g.jsx)("button",{onClick:re,children:"RECEIVE"})]});case"hostedChannelRequest":return console.log("this url is a hosted channel request"),Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{children:"LNURL Hosted Channel Request"}),Object(g.jsx)("p",{children:"This Request is not supported"}),Object(g.jsx)("button",{onClick:ee,children:"BACK"})]});case"login":return console.log("this url is a login "),Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{children:"LNURL Auth Request"}),Object(g.jsx)("p",{children:"This Request is not supported"}),Object(g.jsx)("button",{onClick:ee,children:"BACK"})]});case"payRequest":return console.log("this url is a pay request"),Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{children:"LNURL Pay Request"}),Object(g.jsxs)("p",{children:[Object(g.jsx)("strong",{children:"Min"}),"Sendable: ",Object(g.jsx)("strong",{children:W.minSendable/1e3})," Satoshi"]}),Object(g.jsxs)("p",{children:[Object(g.jsx)("strong",{children:"Max"}),"Sendable: ",Object(g.jsx)("strong",{children:W.maxSendable/1e3})," Satoshi"]}),Object(g.jsx)("input",{type:"number",value:y,name:"payAmount",onChange:te}),Object(g.jsx)("button",{onClick:oe,children:"SEND"})]});default:return console.log("unknown tag"),Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{children:"LNURL Unknown Request"}),Object(g.jsx)("button",{onClick:ee,children:"BACK"})]})}}),[W,f,L,U,I,y,te,ee]),ue=Object(i.useCallback)((function(e){Y(e.message||e)}),[Y]);return G?Object(g.jsx)("div",{children:Object(g.jsx)(d.a,{mode:"invoice",onClose:ae,onError:ue,onScan:se})}):Object(g.jsxs)("div",{className:"publish-content-form-container m-1",children:[j?Object(g.jsx)(b.a,{overlay:!0,fullScreen:!0,text:""}):null,Object(g.jsx)(u.a,{drawerVisible:!1,pageTitle:"PUBLISH CONTENT"}),Object(g.jsx)("div",{children:le})]})}}}]);
//# sourceMappingURL=26.4dffd09d.chunk.js.map