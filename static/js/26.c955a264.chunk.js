(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[26],{483:function(e,t,n){"use strict";t.a=n.p+"static/media/bitcoin-lightning.2d73b74b.svg"},527:function(e,t,n){"use strict";var c=n(3),a=c.useLayoutEffect;t.a=function(e){var t=Object(c.useRef)(e);return a((function(){t.current=e})),t}},582:function(e,t,n){},583:function(e,t,n){},701:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),i=n(6),r=n(20),s=n(3),o=n(24),u=n(45),l=n(15),d=n(32),b=n(527),h=function(e,t){"function"!==typeof e?e.current=t:e(t)},p=function(e,t){var n=Object(s.useRef)();return Object(s.useCallback)((function(c){e.current=c,n.current&&h(n.current,null),n.current=t,t&&h(t,c)}),[t])},f={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},j=function(e){Object.keys(f).forEach((function(t){e.style.setProperty(t,f[t],"important")}))},m=null;var v=function(){},g=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width"],O=!!document.documentElement.currentStyle,x=function(e,t){var n=e.cacheMeasurements,c=e.maxRows,a=e.minRows,i=e.onChange,r=void 0===i?v:i,o=e.onHeightChange,u=void 0===o?v:o,h=Object(d.a)(e,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]);var f=void 0!==h.value,x=Object(s.useRef)(null),y=p(x,t),w=Object(s.useRef)(0),N=Object(s.useRef)(),k=function(){var e=x.current,t=n&&N.current?N.current:function(e){var t=window.getComputedStyle(e);if(null===t)return null;var n,c=(n=t,g.reduce((function(e,t){return e[t]=n[t],e}),{})),a=c.boxSizing;return""===a?null:(O&&"border-box"===a&&(c.width=parseFloat(c.width)+parseFloat(c.borderRightWidth)+parseFloat(c.borderLeftWidth)+parseFloat(c.paddingRight)+parseFloat(c.paddingLeft)+"px"),{sizingStyle:c,paddingSize:parseFloat(c.paddingBottom)+parseFloat(c.paddingTop),borderSize:parseFloat(c.borderBottomWidth)+parseFloat(c.borderTopWidth)})}(e);if(t){N.current=t;var i=function(e,t,n,c){void 0===n&&(n=1),void 0===c&&(c=1/0),m||((m=document.createElement("textarea")).setAttribute("tab-index","-1"),m.setAttribute("aria-hidden","true"),j(m)),null===m.parentNode&&document.body.appendChild(m);var a=e.paddingSize,i=e.borderSize,r=e.sizingStyle,s=r.boxSizing;Object.keys(r).forEach((function(e){var t=e;m.style[t]=r[t]})),j(m),m.value=t;var o=function(e,t){var n=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?n+t.borderSize:n-t.paddingSize}(m,e);m.value="x";var u=m.scrollHeight-a,l=u*n;"border-box"===s&&(l=l+a+i),o=Math.max(l,o);var d=u*c;return"border-box"===s&&(d=d+a+i),[o=Math.min(d,o),u]}(t,e.value||e.placeholder||"x",a,c),r=i[0],s=i[1];w.current!==r&&(w.current=r,e.style.setProperty("height",r+"px","important"),u(r,{rowHeight:s}))}};return Object(s.useLayoutEffect)(k),function(e){var t=Object(b.a)(e);Object(s.useLayoutEffect)((function(){var e=function(e){t.current(e)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[])}(k),Object(s.createElement)("textarea",Object(l.a)({},h,{onChange:function(e){f||k(),r(e)},ref:y}))},y=Object(s.forwardRef)(x),w=n(463),N=n(77),k=n.n(N),S=(n(582),n(8)),z=function(e){var t=e.text,n=void 0===t?"":t,c=e.receivedMessage,a=void 0!==c&&c;return Object(S.jsxs)("div",{className:k()({"chat-message":!0,"chat-message-received":a}),children:[a?Object(S.jsx)("div",{className:"chat-message-avatar"}):null,Object(S.jsx)("p",{className:"chat-message-text",children:n})]})},R=n(30),C=n(483),E=(n(583),n(92));t.default=function(){var e=Object(u.b)(),t=Object(o.i)().publicKey,n=Object(s.useState)(""),c=Object(r.a)(n,2),l=c[0],d=c[1],b=Object(s.useCallback)((function(e,t){return e.filter((function(e){return e.pk===t}))[0]}),[]),h=Object(u.c)((function(e){return e.chat.messages[t]})),p=Object(u.c)((function(e){var n=e.chat;return b(n.contacts,t)})),f=Object(u.c)((function(e){var n=e.chat;return b(n.sentRequests,t)})),j=Object(u.c)((function(e){var n=e.chat;return b(n.receivedRequests,t)})),m=Object(u.c)((function(e){return e.node.publicKey})),v=!p&&f,g=!p&&j,O=Object(s.useCallback)((function(e){d(e.target.value)}),[]),x=Object(s.useCallback)((function(){console.log(j),j&&Object(R.c)(j.id)(e)}),[j,e]),N=Object(s.useCallback)((function(n){if("Enter"!==n.key||!n.ctrlKey)return"Enter"===n.key?(n.preventDefault(),e(Object(R.h)({message:l,publicKey:t})),void d("")):void 0;d(l+"\r\n")}),[l,t,e]),k=Object(s.useCallback)((function(){var n=e(Object(R.i)(m,t));return Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:null===(t=e.sent)||void 0===t||t.close();case 4:case"end":return e.stop()}}),e)})))}),[e,m,t]);Object(s.useEffect)((function(){return k()}),[k]);var F=Object(s.useMemo)((function(){return v?Object(E.c)(v.pk,v.displayName):g?Object(E.c)(g.pk,g.displayName):p?Object(E.c)(p.pk,p.displayName):""}),[v,g,p]);return Object(S.jsxs)("div",{className:"page-container chat-page",children:[Object(S.jsx)(w.a,{solid:!0,pageTitle:F,enableBackButton:!0}),Object(S.jsx)("div",{className:"chat-messages-container",children:null===h||void 0===h?void 0:h.map((function(e){return Object(S.jsx)(z,{text:e.body,receivedMessage:!e.outgoing,status:e.status,timestamp:e.timestamp})}))}),g?Object(S.jsxs)("div",{className:"chat-permission-bar",children:[Object(S.jsxs)("p",{className:"chat-permission-bar-title unselectable",children:[F," has sent you a chat request!"]}),Object(S.jsxs)("p",{className:"chat-permission-bar-text",children:["Once you accept the request, you'll be able to chat and send invoices to ",F]}),Object(S.jsxs)("div",{className:"chat-permission-bar-actions unselectable",children:[Object(S.jsx)("div",{className:"chat-permission-bar-action chat-permission-bar-action-accept",onClick:x,children:"Accept"}),Object(S.jsx)("div",{className:"chat-permission-bar-action chat-permission-bar-action-decline",children:"Decline"})]})]}):v?Object(S.jsxs)("div",{className:"chat-permission-bar",children:[Object(S.jsxs)("p",{className:"chat-permission-bar-title",children:["Your request has been sent to ",F," successfully"]}),Object(S.jsxs)("p",{className:"chat-permission-bar-text unselectable",children:["Once ",F," accepts the request, you'll be able to chat with them"]})]}):Object(S.jsx)("div",{className:"chat-bottom-bar",children:Object(S.jsxs)("div",{className:"chat-input-container",children:[Object(S.jsx)("div",{className:"chat-input-btn unselectable",children:Object(S.jsx)("img",{src:C.a,alt:"Menu"})}),Object(S.jsx)(y,{className:"chat-input",type:"text",enterKeyHint:"send",onKeyPress:N,onChange:O,value:l,height:20})]})})]})}}}]);
//# sourceMappingURL=26.c955a264.chunk.js.map