{"version":3,"sources":["common/Post/components/TipRibbon/index.js","common/DialogNav/index.js","common/Post/components/Stream/index.tsx","utils/seed.tsx","images/obs-2.svg","pages/Profile/goLive.tsx"],"names":["TipRibbon","tipCounter","tipValue","zoomed","className","style","opacity","DialogNav","pageTitle","drawerVisible","goBack","useCallback","window","history","back","onClick","classNames","STREAM_STATUS_URI","Stream","id","item","index","postId","hideRibbon","width","playerDOM","useRef","useState","isLive","setIsLive","videoStyle","useEffect","recheckInterval","checkStatus","a","magnetURI","split","seedToken","Http","get","data","player","videojs","current","autoplay","muted","aspectRatio","src","type","play","then","setInterval","clearInterval","cursor","display","ref","preload","controls","autoPlay","EnrollToken","seedUrl","array","Uint8Array","crypto","getRandomValues","token","Array","prototype","map","call","x","toString","slice","join","reqData","seed_token","wallet_token","fetch","method","headers","body","JSON","stringify","status","Error","GoLive","dispatch","useDispatch","useHistory","seedProviderPub","useSelector","content","seedInfo","streamLiveToken","streamUserToken","availableStreamTokens","selectedSource","setSelectedSource","loading","setLoading","streamToken","setStreamToken","userToken","setUserToken","paragraph","setParagraph","error","setError","rtmpUri","setRtmpUri","rtmpApiUri","setRtmpApiUri","useDefault","setUseDefault","enroll","orderData","availableToken","key","Object","hasOwnProperty","element","tokens","console","log","post","amt","to","memo","feeLimit","ackInfo","seedData","orderAck","parse","response","finalSeedUrl","latestUserToken","streamData","obsToken","liveToken","rtmp","replace","addStream","contentItems","push","text","height","isPreview","isPrivate","tags","title","errorMessage","message","copyToken","navigator","clipboard","writeText","copyUri","onInputChange","e","target","value","name","checked","stopStream","removeStream","Loader","overlay","fullScreen","onChange","backgroundColor","color","border","marginBottom","obsLogo","alt","fontSize","padding","justifyContent","substring","length","alignItems","marginLeft","htmlFor"],"mappings":"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","file":"static/js/21.99d47218.chunk.js","sourcesContent":["import React from \"react\";\nimport \"./css/index.css\";\n\nconst TipRibbon = ({ tipCounter, tipValue, zoomed }) =>\n  tipValue > 0 ? (\n    <div className=\"ribbon-container\" style={{ opacity: !zoomed ? 1 : 0 }}>\n      <p className=\"ribbon-title\">Total Tips</p>\n      <p className=\"ribbon-value\">\n        {tipCounter} {tipCounter === 1 ? \"Tip\" : \"Tips\"}\n      </p>\n    </div>\n  ) : null;\n\nexport default TipRibbon;\n","import React, { useCallback } from \"react\";\nimport classNames from \"classnames\";\nimport \"./css/index.css\";\n\nconst DialogNav = ({ pageTitle, drawerVisible }) => {\n  const goBack = useCallback(() => {\n    window.history.back();\n  }, []);\n  return (\n    <div className=\"dialog-nav-container\">\n      <div className=\"dialog-nav-back\" onClick={goBack}>\n        <i className=\"icon icon-thin-back\"></i>\n      </div>\n      <p className=\"dialog-nav-title\">{pageTitle}</p>\n      <div\n        className={classNames({\n          \"dialog-nav-menu-btn\": true,\n          \"dialog-nav-hidden\": !drawerVisible\n        })}\n      >\n        <div className=\"dialog-nav-menu-dash\" />\n        <div className=\"dialog-nav-menu-dash\" />\n        <div className=\"dialog-nav-menu-dash\" />\n      </div>\n    </div>\n  );\n};\n\nexport default DialogNav;\n","import React, {    useRef, useEffect,useState } from \"react\";\nimport TipRibbon from \"../TipRibbon\";\nimport \"./css/index.css\";\nimport videojs from \"video.js\";\nimport Http from \"../../../../utils/Http\";\n\nconst REACT_APP_SL_SEED_URI = \"https://webtorrent.shock.network\"\nconst STREAM_STATUS_URI = `${REACT_APP_SL_SEED_URI}/rtmpapi/api/streams/live`\n\nconst Stream = ({ id, item, index, postId, tipValue, tipCounter, hideRibbon,width }) => {\n  const playerDOM = useRef(null)\n  const [isLive,setIsLive] = useState(false)\n  const videoStyle = { width:\"100%\"}\n  if(width){\n    videoStyle.width = width\n  }\n  useEffect(() => {\n    let recheckInterval = null\n    const checkStatus = async () => {\n      try{\n        //TODO regex (?) `${REACT_APP_SL_RTMP_API_URI}/live/${seedToken}/index.m3u8`\n        const [seedToken] = item.magnetURI.split(\"/live/\")[1].split(\"/index.m3u8\") \n        const res = await Http.get(`${STREAM_STATUS_URI}/${seedToken}`)\n        if(!res.data.isLive){\n          return false\n        }\n        const player = videojs(playerDOM.current, {\n          autoplay: true,\n          muted: true,\n          aspectRatio: \"16:9\",\n          \n        });\n        player.src({\n          src: item.magnetURI,\n          type: \"application/x-mpegURL\"\n        });\n        /*listen for 404s from the player\n        player.tech().on('retryplaylist', () => {\n          console.log('retryplaylist');\n        });*/\n        player.play();\n        return true\n      }catch(err){\n        return false\n      }\n    }\n    checkStatus()\n    .then(isLive => {\n      if(isLive){\n        setIsLive(true)\n        return\n      }\n      recheckInterval = setInterval(async ()=> {\n        const isLive = await checkStatus()\n        if(isLive){\n          setIsLive(true)\n          clearInterval(recheckInterval)\n          return\n        }\n      },10000)\n    })\n    \n    return () => {\n      clearInterval(recheckInterval)\n    }\n    \n  },[item])\n  return (\n    <div className=\"media-container w-100\">\n      <div\n        className=\"video-container w-100\"\n        style={{\n          cursor: \"pointer\",\n          width:\"100%\"\n        }}\n      >\n        {!isLive && <p>The streamer has disconnected.</p>}\n        <div style={isLive ? {width:\"100%\"} : {display:'none',width:\"100%\"}}>\n        <video\n          className=\"video-js vjs-default-skin\"\n          ref={playerDOM}\n          style={videoStyle}\n          preload=\"auto\"\n          controls\n          muted\n          autoPlay\n        />\n        </div>\n        {!hideRibbon && <TipRibbon tipCounter={tipCounter} tipValue={tipValue} zoomed={false} />}\n      </div>\n    </div>\n  );\n};\n\nexport default Stream;\n","export const EnrollToken = async (seedUrl,seedToken) => {\n    const array = new Uint8Array(32);\n    window.crypto.getRandomValues(array);\n    const token = Array.prototype.map.call(array, x => ('00' + x.toString(16)).slice(-2)).join('');\n    const reqData = {\n      seed_token: seedToken,\n      wallet_token: token\n    }\n    const res = await fetch(`${seedUrl}/api/enroll_token`, {\n      method: 'POST',\n      headers: {\n      'Content-Type': 'application/json'\n    },\n      body: JSON.stringify(reqData)\n    })\n    if (res.status !== 200) {\n      throw new Error('torrentSeed service currently not available')\n    }\n    return token\n}","export default __webpack_public_path__ + \"static/media/obs-2.7c61e78e.svg\";","import React, {  useCallback,   useState } from \"react\";\nimport { useSelector,useDispatch } from \"react-redux\";\nimport {addStream,removeStream} from \"../../actions/ContentActions\"\nimport \"./css/index.css\";\nimport Loader from \"../../common/Loader\";\nimport Http from \"../../utils/Http\";\nimport DialogNav from \"../../common/DialogNav\";\nimport obsLogo from \"../../images/obs-2.svg\"\nimport Stream from \"../../common/Post/components/Stream\";\nimport {EnrollToken} from '../../utils/seed'\nimport { useHistory } from \"react-router\";\n\nconst GoLive = () => {\n  const dispatch = useDispatch();\n  const history = useHistory()\n  //@ts-ignore\n  const seedProviderPub = useSelector(({content}) => content.seedProviderPub)\n  //@ts-ignore\n  const {seedUrl,seedToken} = useSelector(({content}) => content.seedInfo)\n  //@ts-ignore\n  const streamLiveToken = useSelector(({content}) => content.streamLiveToken)\n  //@ts-ignore\n  const streamUserToken = useSelector(({content}) => content.streamUserToken)\n  //@ts-ignore\n  const availableStreamTokens = useSelector(({content}) => content.availableStreamTokens)\n  const [selectedSource, setSelectedSource] = useState('obs');\n  const [loading, setLoading] = useState(false);\n  const [streamToken,setStreamToken] = useState(streamLiveToken)\n  const [userToken,setUserToken] = useState(streamUserToken)\n  const [paragraph,setParagraph] = useState(\"Look I'm streaming!\")\n  const [isLive,setIsLive] = useState(true)\n  const [error, setError] = useState<string|null>(null);\n  const [rtmpUri,setRtmpUri] = useState(\"\")\n  const [rtmpApiUri,setRtmpApiUri] = useState(\"\")\n  const [useDefault,setUseDefault] = useState(false)\n  const enroll = useCallback(async () =>{\n    try {\n      setLoading(true)\n      let orderData = null\n      let deleteToken = false\n        let availableToken = null\n        for (const key in availableStreamTokens) {\n          if (Object.prototype.hasOwnProperty.call(availableStreamTokens, key)) {\n            const element = availableStreamTokens[key];\n            if(element[0]){\n              availableToken = {seedUrl:key,tokens:element}\n              break\n            }\n          }\n        }\n      if(seedUrl && seedToken){\n        console.log(\"USING SELF SEED TOKEN\")\n        const token = await EnrollToken(seedUrl,seedToken)\n        orderData = {seedUrl, tokens:[token]}\n      }else if(useDefault){\n        console.log(\"USING DEFAULT TOKEN PROVIDER\")\n        const {data:seedData,status} = await Http.post('/api/lnd/unifiedTrx',{\n          type: 'streamSeed',\n          amt: 100,\n          to:seedProviderPub, \n          memo:'',\n          feeLimit:500,\n          ackInfo:1\n        })\n        if(status !== 200){\n          setError(\"seed token request failed\")\n          setLoading(false)\n        }\n        console.log(seedData)\n        const {orderAck} = seedData\n        orderData = JSON.parse(orderAck.response)\n      } else if(availableToken) {\n        console.log(\"USING AVAILABLE TOKEN\")\n        orderData = availableToken\n        deleteToken = true\n      }\n      const {tokens,seedUrl:finalSeedUrl} = orderData\n      const [latestUserToken] = tokens\n      setUserToken(latestUserToken)\n      const {data:streamData} = await Http.post(\n        `${finalSeedUrl}/api/stream/auth`,\n        { token: latestUserToken }\n      );\n      const {token:obsToken} = streamData.data;\n      console.log(obsToken)\n      const liveToken = `${latestUserToken}?key=${obsToken}`\n      setStreamToken(`${latestUserToken}?key=${obsToken}`)\n      const rtmp = finalSeedUrl.replace('https','rtmp')\n      setRtmpUri(`${rtmp}/live`)\n      setRtmpApiUri(`${finalSeedUrl}/rtmpapi`)\n      addStream(latestUserToken,liveToken)(dispatch)\n      let contentItems = []\n      if(paragraph !== ''){\n        contentItems.push({\n          type: 'text/paragraph',\n          text: paragraph,\n        })\n      }\n      contentItems.push({\n        type:'stream/embedded',\n        width:0,\n        height:0,\n        magnetURI:`${finalSeedUrl}/rtmpapi/live/${latestUserToken}/index.m3u8`,\n        isPreview:false,\n        isPrivate:false,\n        userToken:latestUserToken\n      })\n      const res = await Http.post(`/api/gun/wall`, {\n        tags: [],\n        title: 'Post',\n        contentItems,\n      })\n      if (res.status === 200) {\n        console.log('post created successfully')\n        setLoading(false)\n      } else {\n        setError('invalid response status')\n        setLoading(false)\n      }\n      \n    } catch(err) {\n      console.log(err)\n      setError(err?.errorMessage ?? err?.message)\n      setLoading(false)\n    }\n  },[paragraph,seedProviderPub,availableStreamTokens,seedUrl,seedToken,useDefault,setLoading,setStreamToken,setError,setUserToken,setRtmpUri,setRtmpApiUri,addStream])\n  const copyToken = useCallback(() => {\n    navigator.clipboard.writeText(streamToken);\n  }, [streamToken]);\n  const copyUri = useCallback(() => {\n    navigator.clipboard.writeText(rtmpUri);\n  }, []);\n  const onInputChange = useCallback(e => {\n    const { value, name,checked } = e.target;\n    switch (name) {\n      case \"paragraph\": {\n        setParagraph(value)\n        return;\n      }\n      case \"source\": {\n        setSelectedSource(value)\n        return;\n      }\n      case \"useDefault\":{\n        setUseDefault(checked)\n        return\n      }\n      default:\n        return;\n    }\n  }, [setParagraph,setSelectedSource]);\n  const stopStream = useCallback(()=>{\n    removeStream()(dispatch)\n    history.push(\"/profile\")\n  },[history])\n  return <div className=\"h-100 m-1\">\n    {loading ? (\n      <Loader overlay fullScreen text=\"\" />\n    ) : null}\n    <DialogNav  drawerVisible={false} pageTitle=\"GO LIVE\" />\n    \n    {/*@ts-expect-error */}\n    {isLive && <div ><Stream\n      hideRibbon={true}\n      item={{magnetURI:`${rtmpApiUri}/live/${userToken}/index.m3u8`}}\n    /></div>}\n    <select value={selectedSource} onChange={onInputChange} name=\"source\" id=\"source\" style={{backgroundColor:\"rgba(0,0,0,0)\",color:'white',width:'100%',border:'0',marginBottom:'1em'}}>\n      <option value=\"camera\" style={{backgroundColor:\"rgba(0,0,0,0)\",color:'var(--main-blue)'}}>Camera</option>\n      <option value=\"obs\" style={{backgroundColor:\"rgba(0,0,0,0)\",color:'var(--main-blue)'}}>OBS</option>\n    </select>\n    <div className=\"flex-center m-b-1\">\n      {selectedSource === 'obs' && <img src={obsLogo} style={{width:\"10em\",height:\"10em\"}}alt=\"\"/>}\n      {selectedSource === 'camera' && <i className=\"fas fa-camera\" style={{fontSize:\"10em\"}}></i>}\n    </div>\n    {streamToken ? <div  >\n        {selectedSource === 'obs' && <p className=\"m-b-1\">You are ready to go! setup the stream with OBS and watch it from your profile</p>}\n        <p>Broadcaster:</p>\n        <div style={{border:\"1px solid var(--main-blue)\",padding:\"0.5rem\",display:\"flex\",justifyContent:\"space-between\",marginBottom:\"1rem\"}}>\n          <p >{rtmpUri.substring(0,20)+ (rtmpUri.length >21 ? \"...\" : \"\") }</p>\n          <i className=\"far fa-copy\" onClick={copyUri}></i>\n        </div>\n        <p>Stream Key:</p>\n        <div style={{border:\"1px solid var(--main-blue)\",padding:\"0.5rem\",display:\"flex\",justifyContent:\"space-between\",marginBottom:\"1rem\"}}>\n          <p >{streamToken.substring(0,20)+ (streamToken.length >21 ? \"...\" : \"\")}</p>\n          <i className=\"far fa-copy\" onClick={copyToken}></i>\n        </div>\n        <div className=\"flex-center\">\n          <button onClick={stopStream} className =\"shock-form-button-confirm\">STOP</button>\n        </div>\n      </div>\n      : <div className=\"vertical-flex-center\">\n        <div style={{display:'flex',alignItems:'center',marginLeft:'auto'}}>\n        <label htmlFor=\"useDefault\">Use default seed provider</label>\n        <input type=\"checkbox\" name=\"useDefault\" checked={useDefault} onChange={onInputChange} style={{marginLeft:\"0.2em\"}}  />\n      </div>\n        <input className=\"input-field\" type=\"text\" name=\"paragraph\" id=\"paragraph\" value={paragraph} onChange={onInputChange}/>\n        <button onClick={enroll} className =\"shock-form-button-confirm\">START NOW</button>\n      </div>}\n      {error ? <p className=\"error-container\">{error}</p> : null}\n  </div>\n}\n\nexport default GoLive"],"sourceRoot":""}