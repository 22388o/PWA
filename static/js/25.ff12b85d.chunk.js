(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[25],{441:function(e,t,n){"use strict";var a=n(3),c=n(77),s=n.n(c),r=(n(442),n(8));t.a=function(e){var t=e.pageTitle,n=e.drawerVisible,c=Object(a.useCallback)((function(){window.history.back()}),[]);return Object(r.jsxs)("div",{className:"dialog-nav-container",children:[Object(r.jsx)("div",{className:"dialog-nav-back",onClick:c,children:Object(r.jsx)("i",{className:"icon icon-thin-back"})}),Object(r.jsx)("p",{className:"dialog-nav-title",children:t}),Object(r.jsxs)("div",{className:s()({"dialog-nav-menu-btn":!0,"dialog-nav-hidden":!n}),children:[Object(r.jsx)("div",{className:"dialog-nav-menu-dash"}),Object(r.jsx)("div",{className:"dialog-nav-menu-dash"}),Object(r.jsx)("div",{className:"dialog-nav-menu-dash"})]})]})}},442:function(e,t,n){},454:function(e,t,n){},522:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),c=n.n(a),s=n(6),r=function(){var e=Object(s.a)(c.a.mark((function e(t,n){var a,s,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Uint8Array(32),window.crypto.getRandomValues(a),s=Array.prototype.map.call(a,(function(e){return("00"+e.toString(16)).slice(-2)})).join(""),r={seed_token:n,wallet_token:s},e.next=6,fetch("".concat(t,"/api/enroll_token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 6:if(200===e.sent.status){e.next=9;break}throw new Error("torrentSeed service currently not available");case 9:return e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},695:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),s=n(6),r=n(20),o=n(3),l=n(45),i=(n(454),n(149)),u=n(441),d=n(18),b=n(43),j=n(522),p=n(24),f=n(8);t.default=function(){var e=Object(l.b)(),t=Object(p.g)(),n=Object(l.c)((function(e){return e.content.seedProviderPub})),a=Object(l.c)((function(e){return e.content.seedInfo})),m=a.seedUrl,h=a.seedToken,O=Object(l.c)((function(e){return e.content.availableTokens})),v=Object(o.useState)(null),x=Object(r.a)(v,2),g=x[0],k=x[1],y=Object(o.useState)(!1),w=Object(r.a)(y,2),N=w[0],S=w[1],C=Object(o.useState)([]),T=Object(r.a)(C,2),D=T[0],I=T[1],P=Object(o.useState)(""),A=Object(r.a)(P,2),E=A[0],U=A[1],L=Object(o.useState)(""),F=Object(r.a)(L,2),R=F[0],V=F[1],B=Object(o.useState)("public"),J=Object(r.a)(B,2),W=J[0],_=J[1],G=Object(o.useState)(!1),K=Object(r.a)(G,2),q=(K[0],K[1]),z=Object(o.useRef)(null),H=Object(o.useRef)(null),M=Object(o.useState)(!1),Q=Object(r.a)(M,2),X=Q[0],Y=Q[1],Z=Object(o.useState)([]),$=Object(r.a)(Z,2),ee=$[0],te=$[1],ne=Object(o.useCallback)(function(){var a=Object(s.a)(c.a.mark((function a(s){var o,l,i,u,p,f,v,x,g,y,w,N,C,T,I,P,A,U,L,F,V,B,J,W;return c.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(s.preventDefault(),console.log([E,R,ee]),0!==ee.length){a.next=5;break}return k("no selected files"),a.abrupt("return");case 5:S(!0),a.prev=6,o=null,l=!1,i=null,console.log("useDefault"),console.log(X),a.t0=c.a.keys(O);case 13:if((a.t1=a.t0()).done){a.next=22;break}if(u=a.t1.value,!Object.prototype.hasOwnProperty.call(O,u)){a.next=20;break}if(!(p=O[u])[0]){a.next=20;break}return i={seedUrl:u,tokens:p},a.abrupt("break",22);case 20:a.next=13;break;case 22:if(!m||!h){a.next=32;break}return console.log("USING SELF SEED TOKEN"),a.next=26,Object(j.a)(m,h);case 26:f=a.sent,console.log("token"),console.log(f),o={seedUrl:m,tokens:[f]},a.next=54;break;case 32:if(!X){a.next=45;break}return console.log("USING DEFAULT TOKEN PROVIDER"),a.next=36,d.a.post("/api/lnd/unifiedTrx",{type:"torrentSeed",amt:100,to:n,memo:"",feeLimit:500,ackInfo:1});case 36:v=a.sent,x=v.data,200!==v.status&&(k("seed token request failed"),S(!1)),console.log(x),g=x.orderAck,o=JSON.parse(g.response),a.next=54;break;case 45:if(!i){a.next=51;break}console.log("USING AVAILABLE TOKEN"),o=i,l=!0,a.next=54;break;case 51:return k("provide the token data or use default seed provider"),S(!1),a.abrupt("return");case 54:return w=(y=o).seedUrl,N=y.tokens,C=new FormData,Array.from(ee).forEach((function(e){return C.append("files",e)})),C.append("info","extraInfo"),C.append("comment","comment"),a.next=62,fetch("".concat(w,"/api/put_file"),{method:"POST",headers:{Authorization:"Bearer ".concat(N[0])},body:C});case 62:return T=a.sent,a.next=65,T.json();case 65:if(I=a.sent,console.log(I),!I.error||!I.error.message){a.next=72;break}return"The provided token has already been used"===(P=I.error.message)?(k("An error occurred, please try again"),Object(b.g)(w,N[0])(e)):k(P),S(!1),a.abrupt("return");case 72:return A=I.data.torrent,U=A.magnet,L=Object(r.a)(D,1),F=L[0],console.log(F),V="image/embedded","video"===F.type&&(V="video/embedded"),B={type:V,magnetURI:U,width:0,height:0},a.next=81,Object(b.c)(B)(e);case 81:J=a.sent,console.log("content publish complete"),console.log(J),S(!1),l&&Object(b.g)(w,N[0])(e),t.push("/profile"),a.next=94;break;case 89:a.prev=89,a.t2=a.catch(6),console.log(a.t2),k(null!==(W=null===a.t2||void 0===a.t2?void 0:a.t2.errorMessage)&&void 0!==W?W:null===a.t2||void 0===a.t2?void 0:a.t2.message),S(!1);case 94:case"end":return a.stop()}}),a,null,[[6,89]])})));return function(e){return a.apply(this,arguments)}}(),[E,R,ee,D,O,m,h,X,t,e,k]),ae=Object(o.useCallback)(function(){var e=Object(s.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),U(""),V(""),k(null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[V,U,k]),ce=Object(o.useCallback)((function(e){var t=e.target,n=t.value,a=t.name,c=t.checked;switch(a){case"title":return void U(n);case"description":return void V(n);case"postType":return void _(n);case"createPost":return void console.log("create post");case"useDefault":return Y(c),void console.log(c);default:return}}),[U,V,q,Y]),se=Object(o.useCallback)((function(e){e.preventDefault(),console.log(e.target.files),te(e.target.files);var t=Array.from(e.target.files).map((function(e,t){return console.log("doing file..."),new Promise((function(n){var a=e.type,c=new FileReader;c.onload=function(e){a.startsWith("image/")&&n({type:"image",uri:e.target.result,index:t}),a.startsWith("video/")&&n({type:"video",uri:e.target.result,index:t})},c.readAsDataURL(e)}))}));Promise.allSettled(t).then((function(e){var t=[];e.forEach((function(e){"fulfilled"===e.status&&t.push(e.value)})),console.log(t),I(t)}))}),[te,I]),re=Object(o.useCallback)((function(e){e.preventDefault(),z.current.click()}),[z]),oe=Object(o.useCallback)((function(e){e.preventDefault(),H.current.click()}),[H]);return Object(f.jsxs)("div",{className:"publish-content-form-container m-1",children:[N?Object(f.jsx)(i.a,{overlay:!0,fullScreen:!0,text:""}):null,Object(f.jsx)(u.a,{drawerVisible:!1,pageTitle:"PUBLISH CONTENT"}),Object(f.jsxs)("form",{className:"publish-content-form",onSubmit:ne,onReset:ae,children:[Object(f.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:Object(f.jsxs)("h2",{children:["Say Something",Object(f.jsx)("div",{className:"line"})]})}),Object(f.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(f.jsx)("div",{className:"publish-content-title",children:Object(f.jsx)("label",{htmlFor:"title",children:Object(f.jsx)("strong",{children:"Title"})})}),Object(f.jsxs)("div",{children:[Object(f.jsxs)("strong",{children:["Audience: ",Object(f.jsx)("i",{className:"fas ".concat("public"===W?"fa-globe-europe":"fa-credit-card")})]}),Object(f.jsxs)("select",{name:"postType",id:"postType",onChange:ce,style:{appearance:"none",backgroundColor:"rgba(0,0,0,0)",color:"var(--main-blue)",marginLeft:"0.3rem"},children:[Object(f.jsx)("option",{value:"public",style:{backgroundColor:"rgba(0,0,0,0)",color:"var(--main-blue)"},children:"Public"}),Object(f.jsx)("option",{value:"private",children:"Paywall"})]})]})]}),Object(f.jsx)("input",{type:"text",name:"title",placeholder:"How I monetized my content with ShockWallet",value:E,onChange:ce,className:"input-field"}),Object(f.jsx)("div",{className:"publish-content-title",children:Object(f.jsx)("label",{htmlFor:"contents",children:Object(f.jsx)("strong",{children:"Contents"})})}),Object(f.jsxs)("div",{className:"m-b-1",children:[Object(f.jsx)("input",{type:"file",id:"file",ref:z,style:{display:"none"},accept:"image/*",multiple:!0,onChange:se}),Object(f.jsx)("input",{type:"file",id:"file",ref:H,style:{display:"none"},accept:"video/*",multiple:!0,onChange:se}),Object(f.jsx)("i",{className:"fas fa-images publish-content-icon",onClick:re}),Object(f.jsx)("i",{className:"fas fa-video publish-content-icon",onClick:oe}),Object(f.jsx)("div",{children:D.length>0&&D.map((function(e){return"image"===e.type?Object(f.jsx)("img",{src:e.uri,width:100,className:"m-1"},e.index.toString()):"video"===e.type?Object(f.jsx)("video",{src:e.uri,controls:!0,width:100,className:"m-1"},e.index.toString()):void 0}))})]}),Object(f.jsx)("div",{className:"publish-content-title",children:Object(f.jsx)("label",{htmlFor:"description",children:Object(f.jsx)("strong",{children:"Description"})})}),Object(f.jsx)("textarea",{name:"description",placeholder:"I made a quick video to show you guys how easy it is to run your own social platform on ShockWallet, and start earning Bitcoin",rows:3,value:R,onChange:ce,className:"input-field"}),Object(f.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:"auto"},children:[Object(f.jsx)("label",{htmlFor:"useDefault",children:"Use default seed provider"}),Object(f.jsx)("input",{type:"checkbox",name:"useDefault",checked:X,onChange:ce,style:{marginLeft:"0.2em"}})]}),Object(f.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:"auto"},children:[Object(f.jsx)("label",{htmlFor:"createPost",children:"Create Post/Teaser?"}),Object(f.jsx)("input",{type:"checkbox",name:"createPost",style:{marginLeft:"0.2em"}})]}),g?Object(f.jsx)("p",{className:"error-container",children:g}):null,Object(f.jsxs)("div",{className:"flex-center",children:[Object(f.jsx)("input",{type:"reset",value:"reset",className:"shock-form-button m-1"}),Object(f.jsx)("input",{type:"submit",value:"submit",className:"shock-form-button-confirm m-1"})]})]})]})}}}]);
//# sourceMappingURL=25.ff12b85d.chunk.js.map