(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[30],{583:function(e,t,a){"use strict";var c=a(31),n=a(83),r=a.n(n),s=(a(591),a(4));t.a=function(e){var t=e.label,a=e.name,n=e.onChange,o=e.inputAction,i=e.actionIcon,l=e.value,d=e.inputMode,u=void 0===d?"text":d,b=e.type,p=void 0===b?"text":b,j=e.element,v=void 0===j?"input":j,f=e.small,m=void 0!==f&&f,h=e.disabled;return Object(s.jsxs)("div",{className:r()({group:!0,"group-disabled":h,"group-small":m}),"data-v-e0923d96":"",children:[t?Object(s.jsx)("p",{className:"group-label","data-v-e0923d96":"",children:t}):null,Object(s.jsxs)("div",{className:r()({"group-input-container":!0,"group-input-textarea-container":"textarea"===v}),"data-v-e0923d96":"",children:["textarea"===v?Object(s.jsx)("textarea",{className:"group-input group-input-textarea",name:a,onChange:n,inputMode:u,value:l,disabled:h,"data-v-e0923d96":""}):Object(s.jsx)("input",{className:"group-input",type:p,name:a,onChange:n,inputMode:u,value:l,disabled:h,"data-v-e0923d96":""}),o&&i?Object(s.jsx)("div",{className:"group-input-action",onClick:o,"data-v-e0923d96":"",children:Object(s.jsx)("i",{className:r()(Object(c.a)({"group-input-action-icon":!0,fas:!0},i,!0)),onClick:o,"data-v-e0923d96":""})}):null]})]})}},591:function(e,t,a){},612:function(e,t,a){"use strict";var c=a(2),n=a(4);t.a=function(e){var t=e.color,a=e.length,r=e.type,s=e.width,o=Object(c.useMemo)((function(){return"vertical"===r?{borderLeftStyle:"solid",borderLeftWidth:"".concat(s/2,"px"),borderLeftColor:t,borderRightStyle:"solid",borderRightWidth:"".concat(s/2,"px"),borderRightColor:t,height:a}:"horizontal"===r?{borderTopStyle:"solid",borderTopWidth:s/2,borderTopColor:t,borderBottomStyle:"solid",borderBottomWidth:s/2,borderBottomColor:t,width:a}:{}}),[t,a,r,s]);return Object(n.jsx)("div",{style:o})}},837:function(e,t,a){},838:function(e,t,a){e.exports={"stream-type-btn":"GoLive_stream-type-btn__3sNtJ","stream-type-btn-icon":"GoLive_stream-type-btn-icon__2p9-P","obs-logo":"GoLive_obs-logo__1p3Hh"}},886:function(e,t,a){"use strict";a.r(t);var c=a(3),n=a.n(c),r=a(5),s=a(16),o=a(2),i=a.n(o),l=a(47),d=a(83),u=a.n(d),b=(a(837),a(28)),p=a(176),j=a(17),v=a.p+"static/media/obs-2.7c61e78e.svg",f=a(705),m=a(25),h=a(580),O=a(20),x=a(600),g=a(578),k=a(612),y=a(577),S=a(838),C=a.n(S),N=a(583),w=a(4);t.default=function(){var e=Object(l.b)(),t=Object(m.g)(),a=O.useSelector((function(e){return e.content.seedProviderPub})),c=O.useSelector((function(e){return e.content.seedInfo})),d=c.seedUrl,S=c.seedToken,I=O.useSelector((function(e){return e.content.streamLiveToken})),T=O.useSelector((function(e){return e.content.streamUserToken})),P=O.useSelector((function(e){return e.content.availableTokens})),U=O.useSelector((function(e){return e.content.streamBroadcasterUrl})),L=O.useSelector((function(e){return e.content.streamContentId})),_=O.useSelector((function(e){return e.content.streamPostId})),M=O.useSelector((function(e){return e.userProfiles})),B=Object(o.useState)("obs"),D=Object(s.a)(B,2),R=D[0],z=D[1],F=Object(o.useState)(!1),W=Object(s.a)(F,2),G=W[0],A=W[1],J=Object(o.useState)(I),K=Object(s.a)(J,2),E=K[0],H=K[1],V=Object(o.useState)(T),Y=Object(s.a)(V,2)[1],q=Object(o.useState)("Look I'm streaming!"),Q=Object(s.a)(q,2),X=Q[0],Z=Q[1],$=Object(o.useState)(null),ee=Object(s.a)($,2),te=ee[0],ae=ee[1],ce=Object(o.useState)(null),ne=Object(s.a)(ce,2),re=ne[0],se=ne[1],oe=Object(o.useState)(!1),ie=Object(s.a)(oe,2),le=ie[0],de=ie[1],ue=Object(o.useState)(!1),be=Object(s.a)(ue,2),pe=be[0],je=be[1],ve=Object(o.useState)(!1),fe=Object(s.a)(ve,2),me=fe[0],he=fe[1],Oe=i.a.useCallback(function(){var t=Object(r.a)(n.a.mark((function t(c,r){var o,i,l,u,p,v,m,h,O,x,g,k,y,C,N,w,I,T,U,L,_,M,B,D,R;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,A(!0),t.next=4,Object(f.a)({availableTokens:P,seedProviderPub:a,seedToken:S,seedUrl:d,serviceID:r,servicePrice:c});case 4:return o=t.sent,i=o.seedUrl,l=o.tokens,u=Object(s.a)(l,1),p=u[0],Y(p),t.next=11,j.a.post("".concat(i,"/api/stream/auth"),{token:p});case 11:return v=t.sent,m=v.data,h=m.data.token,console.log(h),O="".concat(p,"?key=").concat(h),H("".concat(p,"?key=").concat(h)),x="".concat(i,"/rtmpapi/live/").concat(p,"/index.m3u8"),g=i.replace("https","rtmp"),k="".concat(g,"/live"),y="".concat(i,"/rtmpapi/api/streams/live/").concat(p),C=[],""!==X&&C.push({type:"text/paragraph",text:X}),N={height:0,isPreview:!1,isPrivate:!1,liveStatus:"waiting",magnetURI:x,playbackMagnet:"",statusUrl:y,type:"stream/embedded",userToken:p,viewersCounter:0,width:0},C.push(N),t.next=27,j.a.post("/api/gun/wall",{tags:[],title:"Post",contentItems:C});case 27:if(200!==(w=t.sent).status){t.next=40;break}return I=w.data,T=I,U=Object(s.a)(T,2),L=U[0],_=U[1],console.log(_.contentItems),M=Object.entries(_.contentItems).find((function(e){var t=Object(s.a)(e,2),a=(t[0],t[1]);return"stream/embedded"===a.type&&a.magnetURI===x})),B=Object(s.a)(M,1),D=B[0],Object(b.d)({seedToken:p,liveToken:O,streamUrl:x,streamPostId:L,streamContentId:D,streamStatusUrl:y,streamBroadcasterUrl:k})(e),t.next=36,j.a.post("/api/listenStream",{postId:L,contentId:D,statusUrl:"".concat(i,"/rtmpapi/api/streams/live/").concat(p)});case 36:console.log("post created successfully"),A(!1),t.next=42;break;case 40:ae("invalid response status"),A(!1);case 42:t.next=49;break;case 44:t.prev=44,t.t0=t.catch(0),console.log(t.t0),ae(null!==(R=null===t.t0||void 0===t.t0?void 0:t.t0.errorMessage)&&void 0!==R?R:null===t.t0||void 0===t.t0?void 0:t.t0.message),A(!1);case 49:case"end":return t.stop()}}),t,null,[[0,44]])})));return function(e,a){return t.apply(this,arguments)}}(),[P,a,S,d,e,X]),xe=Object(o.useCallback)((function(){se(null)}),[se]),ge=Object(o.useCallback)((function(){var e=re.servicePrice,t=re.serviceID;Oe(e,t),se(null)}),[re,Oe,se]),ke=Object(o.useCallback)(function(){var e=Object(r.a)(n.a.mark((function e(t){var c,r,s,o,i,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!le){e.next=3;break}return e.abrupt("return");case 3:de(!0),t.preventDefault(),c=!1,e.t0=n.a.keys(P);case 7:if((e.t1=e.t0()).done){e.next=16;break}if(r=e.t1.value,!Object.prototype.hasOwnProperty.call(P,r)){e.next=14;break}if(!P[r][0]){e.next=14;break}return c=!0,e.abrupt("break",16);case 14:e.next=7;break;case 16:if(s="",M[a]&&(s=M[a].SeedServiceProvided),!(c||d&&S)){e.next=22;break}Oe(),e.next=33;break;case 22:if(!s||!a){e.next=32;break}return e.next=25,j.a.get("/api/gun/otheruser/".concat(a,"/load/offeredServices>").concat(s));case 25:o=e.sent,i=o.data,l=i.data.servicePrice,console.log(i),se({servicePrice:l,serviceID:s}),e.next=33;break;case 32:ae("No way found to publish content");case 33:e.next=38;break;case 35:e.prev=35,e.t2=e.catch(0),ae(e.t2.message);case 38:return e.prev=38,de(!1),e.finish(38);case 41:case"end":return e.stop()}}),e,null,[[0,35,38,41]])})));return function(t){return e.apply(this,arguments)}}(),[le,M,a,d,S,P,Oe]),ye=Object(o.useCallback)((function(){navigator.clipboard.writeText(E),he(!0)}),[E,he]),Se=Object(o.useCallback)((function(){navigator.clipboard.writeText(U),je(!0)}),[U,je]),Ce=Object(o.useCallback)((function(e){var t=e.target,a=t.value;switch(t.name){case"paragraph":return void Z(a);case"source":return void z(a);default:return}}),[Z,z]),Ne=Object(o.useCallback)((function(){j.a.post("/api/stopStream",{postId:_,contentId:L,endUrl:"https://stream.shock.network/api/stream/end",urlForMagnet:"https://stream.shock.network/api/stream/torrent/".concat(T),obsToken:I}),Object(b.i)()(e),console.info(T),t.push("/profile")}),[e,t,L,I,_,T]),we=u()(g.i,g.d,g.c,C.a["stream-type-btn"]);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)(x.a,{pageTitle:"GO LIVE",scrolls:!0,"data-v-c4af1635":"",children:[Object(w.jsxs)("div",{className:u()(g.z,g.D),"data-v-c4af1635":"",children:[Object(w.jsxs)("div",{className:we,onClick:z.bind(null,"camera"),"data-v-c4af1635":"",children:[Object(w.jsx)("i",{className:u()(C.a["stream-type-btn-icon"],"fas","fa-camera"),"data-v-c4af1635":""}),Object(w.jsx)(y.a,{amt:16,"data-v-c4af1635":""}),Object(w.jsx)(k.a,{color:"camera"===R?"#4285b9":"white",length:36,type:"horizontal",width:2,"data-v-c4af1635":""})]}),Object(w.jsxs)("div",{className:we,onClick:z.bind(null,"obs"),"data-v-c4af1635":"",children:[Object(w.jsx)("img",{alt:"",className:C.a["obs-logo"],src:v,"data-v-c4af1635":""}),Object(w.jsx)(y.a,{amt:16,"data-v-c4af1635":""}),Object(w.jsx)(k.a,{color:"obs"===R?"#4285b9":"white",length:36,type:"horizontal",width:2,"data-v-c4af1635":""})]})]}),Object(w.jsx)("div",{className:g.l,"data-v-c4af1635":"",children:te?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{"data-v-c4af1635":"",children:" An error ocurred: "}),Object(w.jsx)("br",{"data-v-c4af1635":""}),Object(w.jsx)("p",{className:"error-container","data-v-c4af1635":"",children:te}),Object(w.jsx)("button",{className:"shock-form-button",onClick:ae.bind(null,null),"data-v-c4af1635":"",children:"Dismiss"})]}):E?Object(w.jsxs)(w.Fragment,{children:["obs"===R&&Object(w.jsx)("p",{className:"m-b-1","data-v-c4af1635":"",children:"You are ready to go! setup the stream with OBS and watch it from your profile"}),Object(w.jsx)("p",{"data-v-c4af1635":"",children:"Broadcaster:"}),Object(w.jsxs)("div",{className:"d-flex flex-align-center","data-v-c4af1635":"",children:[Object(w.jsx)(N.a,{name:"Streamer Url",value:U,disabled:!0,"data-v-c4af1635":""}),Object(w.jsx)("i",{className:pe?"fas fa-check fa-lg m-1":"far fa-copy fa-lg m-1",onClick:Se,"data-v-c4af1635":""})]}),Object(w.jsx)("p",{"data-v-c4af1635":"",children:"Stream Key:"}),Object(w.jsxs)("div",{className:"d-flex flex-align-center","data-v-c4af1635":"",children:[Object(w.jsx)(N.a,{name:"Stream Key",value:E,disabled:!0,"data-v-c4af1635":""}),Object(w.jsx)("i",{className:me?"fas fa-check fa-lg m-1":"far fa-copy fa-lg m-1",onClick:ye,"data-v-c4af1635":""})]}),Object(w.jsx)("div",{className:"flex-center","data-v-c4af1635":"",children:Object(w.jsx)("button",{onClick:Ne,className:"shock-form-button-confirm","data-v-c4af1635":"",children:"STOP"})})]}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("input",{className:"input-field",type:"text",name:"paragraph",id:"paragraph",value:X,onChange:Ce,"data-v-c4af1635":""}),Object(w.jsx)("button",{onClick:ke,className:u()(g.D,"shock-form-button-confirm"),disabled:"camera"===R||le,"data-v-c4af1635":"",children:le?"...":"START NOW"})]})})]}),re&&Object(w.jsxs)(h.a,{modalOpen:re&&!G,toggleModal:xe,contentStyle:{padding:"1rem"},"data-v-c4af1635":"",children:[Object(w.jsxs)("p",{"data-v-c4af1635":"",children:["The service from the default service provider will cost:"," ",Object(w.jsxs)("strong",{"data-v-c4af1635":"",children:[re.servicePrice," sats"]})]}),Object(w.jsxs)("div",{className:g.z,"data-v-c4af1635":"",children:[Object(w.jsx)("button",{className:"shock-form-button m-1",onClick:xe,"data-v-c4af1635":"",children:"Cancel"}),Object(w.jsx)("button",{className:"shock-form-button-confirm m-1",onClick:ge,"data-v-c4af1635":"",children:"Confirm"})]})]}),G?Object(w.jsx)(p.a,{overlay:!0,fullScreen:!0,text:"Creating stream...","data-v-c4af1635":""}):null]})}}}]);
//# sourceMappingURL=30.07f77633.chunk.js.map