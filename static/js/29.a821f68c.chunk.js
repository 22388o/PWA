(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[29],{593:function(e,t,a){"use strict";var c=a(46),n=a(84),r=a.n(n),s=(a(599),a(4));t.a=function(e){var t=e.label,a=e.name,n=e.onChange,o=e.inputAction,i=e.actionIcon,l=e.value,d=e.inputMode,u=void 0===d?"text":d,b=e.type,j=void 0===b?"text":b,p=e.element,f=void 0===p?"input":p,v=e.small,m=void 0!==v&&v,h=e.disabled;return Object(s.jsxs)("div",{className:r()({group:!0,"group-disabled":h,"group-small":m}),"data-v-3cbe38c5":"",children:[t?Object(s.jsx)("p",{className:"group-label","data-v-3cbe38c5":"",children:t}):null,Object(s.jsxs)("div",{className:r()({"group-input-container":!0,"group-input-textarea-container":"textarea"===f}),"data-v-3cbe38c5":"",children:["textarea"===f?Object(s.jsx)("textarea",{className:"group-input group-input-textarea",name:a,onChange:n,inputMode:u,value:l,disabled:h,"data-v-3cbe38c5":""}):Object(s.jsx)("input",{className:"group-input",type:j,name:a,onChange:n,inputMode:u,value:l,disabled:h,"data-v-3cbe38c5":""}),o&&i?Object(s.jsx)("div",{className:"group-input-action",onClick:o,"data-v-3cbe38c5":"",children:Object(s.jsx)("i",{className:r()(Object(c.a)({"group-input-action-icon":!0,fas:!0},i,!0)),onClick:o,"data-v-3cbe38c5":""})}):null]})]})}},599:function(e,t,a){},619:function(e,t,a){"use strict";var c=a(1),n=a(4);t.a=function(e){var t=e.color,a=e.length,r=e.type,s=e.width,o=Object(c.useMemo)((function(){return"vertical"===r?{borderLeftStyle:"solid",borderLeftWidth:"".concat(s/2,"px"),borderLeftColor:t,borderRightStyle:"solid",borderRightWidth:"".concat(s/2,"px"),borderRightColor:t,height:a}:"horizontal"===r?{borderTopStyle:"solid",borderTopWidth:s/2,borderTopColor:t,borderBottomStyle:"solid",borderBottomWidth:s/2,borderBottomColor:t,width:a}:{}}),[t,a,r,s]);return Object(n.jsx)("div",{style:o})}},844:function(e,t,a){},845:function(e,t,a){e.exports={"stream-type-btn":"GoLive_stream-type-btn__3sNtJ","stream-type-btn-icon":"GoLive_stream-type-btn-icon__2p9-P","obs-logo":"GoLive_obs-logo__1p3Hh"}},895:function(e,t,a){"use strict";a.r(t);var c=a(3),n=a.n(c),r=a(6),s=a(19),o=a(1),i=a.n(o),l=a(37),d=a(84),u=a.n(d),b=(a(844),a(30)),j=a(177),p=a(23),f=a.p+"static/media/obs-2.7c61e78e.svg",v=a(713),m=a(25),h=a(590),O=a(20),x=a(608),k=a(589),g=a(619),y=a(591),S=a(845),C=a.n(S),w=a(593),N=a(4);t.default=function(){var e=Object(l.b)(),t=Object(m.g)(),a=O.useSelector((function(e){return e.node.hostIP})),c=O.useSelector((function(e){return e.node.relayId})),d=O.useSelector((function(e){return e.content.seedProviderPub})),S=O.useSelector((function(e){return e.content.seedInfo})),T=S.seedUrl,I=S.seedToken,P=O.useSelector((function(e){return e.content.streamLiveToken})),U=O.useSelector((function(e){return e.content.streamUserToken})),L=O.useSelector((function(e){return e.content.availableTokens})),_=O.useSelector((function(e){return e.content.streamBroadcasterUrl})),M=O.useSelector((function(e){return e.content.streamContentId})),B=O.useSelector((function(e){return e.content.tipOverlayUrl})),D=O.useSelector((function(e){return e.content.streamPostId})),F=O.useSelector((function(e){return e.userProfiles})),R=Object(o.useState)("obs"),z=Object(s.a)(R,2),W=z[0],G=z[1],A=Object(o.useState)(!1),J=Object(s.a)(A,2),E=J[0],K=J[1],H=Object(o.useState)(P),V=Object(s.a)(H,2),Y=V[0],q=V[1],Q=Object(o.useState)(U),X=Object(s.a)(Q,2)[1],Z=Object(o.useState)("Look I'm streaming!"),$=Object(s.a)(Z,2),ee=$[0],te=$[1],ae=Object(o.useState)(null),ce=Object(s.a)(ae,2),ne=ce[0],re=ce[1],se=Object(o.useState)(null),oe=Object(s.a)(se,2),ie=oe[0],le=oe[1],de=Object(o.useState)(!1),ue=Object(s.a)(de,2),be=ue[0],je=ue[1],pe=Object(o.useState)(!1),fe=Object(s.a)(pe,2),ve=fe[0],me=fe[1],he=Object(o.useState)(!1),Oe=Object(s.a)(he,2),xe=Oe[0],ke=Oe[1],ge=Object(o.useState)(!1),ye=Object(s.a)(ge,2),Se=ye[0],Ce=ye[1],we=Object(o.useState)(!0),Ne=Object(s.a)(we,2),Te=Ne[0],Ie=Ne[1],Pe=i.a.useCallback(function(){var t=Object(r.a)(n.a.mark((function t(r,o){var i,l,u,j,f,m,h,O,x,k,g,y,S,C,w,N,P,U,_,M,B,D,F,R,z,W,G,A,J,E;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,K(!0),t.next=4,Object(v.a)({availableTokens:L,seedProviderPub:d,seedToken:I,seedUrl:T,serviceID:o,servicePrice:r});case 4:return i=t.sent,l=i.seedUrl,u=i.tokens,j=Object(s.a)(u,1),f=j[0],X(f),t.next=11,p.a.post("".concat(l,"/api/stream/auth"),{token:f});case 11:return m=t.sent,h=m.data,O=h.data.token,console.log(O),x="".concat(f,"?key=").concat(O),q("".concat(f,"?key=").concat(O)),k="".concat(l,"/rtmpapi/live/").concat(f,"/index.m3u8"),g=l.replace("https","rtmp"),y="".concat(g,"/live"),S="".concat(l,"/rtmpapi/api/streams/live/").concat(f),C="".concat(l.replace("https","wss"),"/websocket"),w=[],""!==ee&&w.push({type:"text/paragraph",text:ee}),N={height:0,isPreview:!1,isPrivate:!1,liveStatus:"waiting",magnetURI:k,playbackMagnet:"",statusUrl:S,type:"stream/embedded",userToken:f,viewersCounter:0,width:0,viewersSocketUrl:C},w.push(N),t.next=28,p.a.post("/api/gun/wall",{tags:[],title:"Post",contentItems:w,enableTipsOverlay:Te});case 28:if(200!==(P=t.sent).status){t.next=43;break}return _=P.data,M=_,B=Object(s.a)(M,3),D=B[0],F=B[1],R=B[2],z="",R&&(W=c?"&x-shock-hybrid-relay-id-x=".concat(c):"",z="".concat(a,"/api/subscribeStream?accessId=").concat(R).concat(W)),console.log(F.contentItems),G=Object.entries(null!==(U=F.contentItems)&&void 0!==U?U:{}).find((function(e){var t=Object(s.a)(e,2),a=(t[0],t[1]);return"stream/embedded"===a.type&&a.magnetURI===k})),A=Object(s.a)(G,1),J=A[0],Object(b.d)({seedToken:f,liveToken:x,streamUrl:k,streamPostId:D,streamContentId:J,streamStatusUrl:S,streamBroadcasterUrl:y,tipOverlayUrl:z})(e),t.next=39,p.a.post("/api/listenStream",{postId:D,contentId:J,statusUrl:"".concat(l,"/rtmpapi/api/streams/live/").concat(f)});case 39:console.log("post created successfully"),K(!1),t.next=45;break;case 43:re("invalid response status"),K(!1);case 45:t.next=52;break;case 47:t.prev=47,t.t0=t.catch(0),console.log(t.t0),re(null!==(E=null===t.t0||void 0===t.t0?void 0:t.t0.errorMessage)&&void 0!==E?E:null===t.t0||void 0===t.t0?void 0:t.t0.message),K(!1);case 52:case"end":return t.stop()}}),t,null,[[0,47]])})));return function(e,a){return t.apply(this,arguments)}}(),[L,d,I,T,Te,e,ee]),Ue=Object(o.useCallback)((function(){le(null)}),[le]),Le=Object(o.useCallback)((function(){var e=ie.servicePrice,t=ie.serviceID;Pe(e,t),le(null)}),[ie,Pe,le]),_e=Object(o.useCallback)(function(){var e=Object(r.a)(n.a.mark((function e(t){var a,c,r,s,o,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!be){e.next=3;break}return e.abrupt("return");case 3:je(!0),t.preventDefault(),a=!1,e.t0=n.a.keys(L);case 7:if((e.t1=e.t0()).done){e.next=16;break}if(c=e.t1.value,!Object.prototype.hasOwnProperty.call(L,c)){e.next=14;break}if(!L[c][0]){e.next=14;break}return a=!0,e.abrupt("break",16);case 14:e.next=7;break;case 16:if(r="",F[d]&&(r=F[d].SeedServiceProvided),!(a||T&&I)){e.next=22;break}Pe(),e.next=33;break;case 22:if(!r||!d){e.next=32;break}return e.next=25,p.a.get("/api/gun/otheruser/".concat(d,"/load/offeredServices>").concat(r));case 25:s=e.sent,o=s.data,i=o.data.servicePrice,console.log(o),le({servicePrice:i,serviceID:r}),e.next=33;break;case 32:re("No way found to publish content");case 33:e.next=38;break;case 35:e.prev=35,e.t2=e.catch(0),re(e.t2.message);case 38:return e.prev=38,je(!1),e.finish(38);case 41:case"end":return e.stop()}}),e,null,[[0,35,38,41]])})));return function(t){return e.apply(this,arguments)}}(),[be,F,d,T,I,L,Pe]),Me=Object(o.useCallback)((function(){navigator.clipboard.writeText(Y),ke(!0)}),[Y,ke]),Be=Object(o.useCallback)((function(){navigator.clipboard.writeText(B),Ce(!0)}),[B,Ce]),De=Object(o.useCallback)((function(){navigator.clipboard.writeText(_),me(!0)}),[_,me]),Fe=Object(o.useCallback)((function(e){var t=e.target,a=t.value;switch(t.name){case"paragraph":return void te(a);case"source":return void G(a);default:return}}),[te,G]),Re=Object(o.useCallback)((function(){Ie(!Te)}),[Te,Ie]),ze=Object(o.useCallback)((function(){p.a.post("/api/stopStream",{postId:D,contentId:M,endUrl:"https://stream.shock.network/api/stream/end",urlForMagnet:"https://stream.shock.network/api/stream/torrent/".concat(U),obsToken:P}),Object(b.i)()(e),console.info(U),t.push("/profile")}),[e,t,M,P,D,U]),We=u()(k.i,k.d,k.c,C.a["stream-type-btn"]);return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(x.a,{pageTitle:"GO LIVE",scrolls:!0,"data-v-c4af1635":"",children:[Object(N.jsxs)("div",{className:u()(k.z,k.D),"data-v-c4af1635":"",children:[Object(N.jsxs)("div",{className:We,onClick:G.bind(null,"camera"),"data-v-c4af1635":"",children:[Object(N.jsx)("i",{className:u()(C.a["stream-type-btn-icon"],"fas","fa-camera"),"data-v-c4af1635":""}),Object(N.jsx)(y.a,{amt:16,"data-v-c4af1635":""}),Object(N.jsx)(g.a,{color:"camera"===W?"#4285b9":"white",length:36,type:"horizontal",width:2,"data-v-c4af1635":""})]}),Object(N.jsxs)("div",{className:We,onClick:G.bind(null,"obs"),"data-v-c4af1635":"",children:[Object(N.jsx)("img",{alt:"",className:C.a["obs-logo"],src:f,"data-v-c4af1635":""}),Object(N.jsx)(y.a,{amt:16,"data-v-c4af1635":""}),Object(N.jsx)(g.a,{color:"obs"===W?"#4285b9":"white",length:36,type:"horizontal",width:2,"data-v-c4af1635":""})]})]}),Object(N.jsx)("div",{className:k.l,"data-v-c4af1635":"",children:ne?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("p",{"data-v-c4af1635":"",children:" An error ocurred: "}),Object(N.jsx)("br",{"data-v-c4af1635":""}),Object(N.jsx)("p",{className:"error-container","data-v-c4af1635":"",children:ne}),Object(N.jsx)("button",{className:"shock-form-button",onClick:re.bind(null,null),"data-v-c4af1635":"",children:"Dismiss"})]}):Y?Object(N.jsxs)(N.Fragment,{children:["obs"===W&&Object(N.jsx)("p",{className:"m-b-1","data-v-c4af1635":"",children:"You are ready to go! setup the stream with OBS and watch it from your profile"}),Object(N.jsx)("p",{"data-v-c4af1635":"",children:"Broadcaster:"}),Object(N.jsxs)("div",{className:"d-flex flex-align-center","data-v-c4af1635":"",children:[Object(N.jsx)(w.a,{name:"Streamer Url",value:_,disabled:!0,"data-v-c4af1635":""}),Object(N.jsx)("i",{className:ve?"fas fa-check fa-lg m-1":"far fa-copy fa-lg m-1",onClick:De,"data-v-c4af1635":""})]}),Object(N.jsx)("p",{"data-v-c4af1635":"",children:"Stream Key:"}),Object(N.jsxs)("div",{className:"d-flex flex-align-center","data-v-c4af1635":"",children:[Object(N.jsx)(w.a,{name:"Stream Key",value:Y,disabled:!0,"data-v-c4af1635":""}),Object(N.jsx)("i",{className:xe?"fas fa-check fa-lg m-1":"far fa-copy fa-lg m-1",onClick:Me,"data-v-c4af1635":""})]}),B&&Object(N.jsx)("p",{"data-v-c4af1635":"",children:"Tips notifications overlay Url:"}),B&&Object(N.jsxs)("div",{className:"d-flex flex-align-center","data-v-c4af1635":"",children:[Object(N.jsx)(w.a,{name:"Overlay Url",value:B,disabled:!0,"data-v-c4af1635":""}),Object(N.jsx)("i",{className:Se?"fas fa-check fa-lg m-1":"far fa-copy fa-lg m-1",onClick:Be,"data-v-c4af1635":""})]}),Object(N.jsx)("div",{className:"flex-center","data-v-c4af1635":"",children:Object(N.jsx)("button",{onClick:ze,className:"shock-form-button-confirm","data-v-c4af1635":"",children:"STOP"})})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("input",{className:"input-field",type:"text",name:"paragraph",id:"paragraph",value:ee,onChange:Fe,"data-v-c4af1635":""}),Object(N.jsxs)("label",{htmlFor:"enable-tips-notifications","data-v-c4af1635":"",children:["Enable Tips notifications overlay"," "]}),Object(N.jsx)("input",{type:"checkbox",name:"enable-tips-notifications",id:"enable-tips-notifications",checked:Te,onClick:Re,"data-v-c4af1635":""}),Object(N.jsx)("button",{onClick:_e,className:u()(k.D,"shock-form-button-confirm"),disabled:"camera"===W||be,"data-v-c4af1635":"",children:be?"...":"START NOW"})]})})]}),ie&&Object(N.jsxs)(h.a,{modalOpen:ie&&!E,toggleModal:Ue,contentStyle:{padding:"1rem"},"data-v-c4af1635":"",children:[Object(N.jsxs)("p",{"data-v-c4af1635":"",children:["The service from the default service provider will cost:"," ",Object(N.jsxs)("strong",{"data-v-c4af1635":"",children:[ie.servicePrice," sats"]})]}),Object(N.jsxs)("div",{className:k.z,"data-v-c4af1635":"",children:[Object(N.jsx)("button",{className:"shock-form-button m-1",onClick:Ue,"data-v-c4af1635":"",children:"Cancel"}),Object(N.jsx)("button",{className:"shock-form-button-confirm m-1",onClick:Le,"data-v-c4af1635":"",children:"Confirm"})]})]}),E?Object(N.jsx)(j.a,{overlay:!0,fullScreen:!0,text:"Creating stream...","data-v-c4af1635":""}):null]})}}}]);
//# sourceMappingURL=29.a821f68c.chunk.js.map