(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[30],{568:function(e,t,a){"use strict";var c=a(26),n=a(80),r=a.n(n),s=(a(576),a(4));t.a=function(e){var t=e.label,a=e.name,n=e.onChange,o=e.inputAction,i=e.actionIcon,l=e.value,d=e.inputMode,u=void 0===d?"text":d,b=e.type,j=void 0===b?"text":b,p=e.element,f=void 0===p?"input":p,v=e.small,m=void 0!==v&&v,h=e.disabled;return Object(s.jsxs)("div",{className:r()({group:!0,"group-disabled":h,"group-small":m}),"data-v-1c969e13":"",children:[t?Object(s.jsx)("p",{className:"group-label","data-v-1c969e13":"",children:t}):null,Object(s.jsxs)("div",{className:r()({"group-input-container":!0,"group-input-textarea-container":"textarea"===f}),"data-v-1c969e13":"",children:["textarea"===f?Object(s.jsx)("textarea",{className:"group-input group-input-textarea",name:a,onChange:n,inputMode:u,value:l,disabled:h,"data-v-1c969e13":""}):Object(s.jsx)("input",{className:"group-input",type:j,name:a,onChange:n,inputMode:u,value:l,disabled:h,"data-v-1c969e13":""}),o&&i?Object(s.jsx)("div",{className:"group-input-action",onClick:o,"data-v-1c969e13":"",children:Object(s.jsx)("i",{className:r()(Object(c.a)({"group-input-action-icon":!0,fas:!0},i,!0)),onClick:o,"data-v-1c969e13":""})}):null]})]})}},576:function(e,t,a){},597:function(e,t,a){"use strict";var c=a(3),n=a(4);t.a=function(e){var t=e.color,a=e.length,r=e.type,s=e.width,o=Object(c.useMemo)((function(){return"vertical"===r?{borderLeftStyle:"solid",borderLeftWidth:"".concat(s/2,"px"),borderLeftColor:t,borderRightStyle:"solid",borderRightWidth:"".concat(s/2,"px"),borderRightColor:t,height:a}:"horizontal"===r?{borderTopStyle:"solid",borderTopWidth:s/2,borderTopColor:t,borderBottomStyle:"solid",borderBottomWidth:s/2,borderBottomColor:t,width:a}:{}}),[t,a,r,s]);return Object(n.jsx)("div",{style:o})}},819:function(e,t,a){},820:function(e,t,a){e.exports={"stream-type-btn":"GoLive_stream-type-btn__3sNtJ","stream-type-btn-icon":"GoLive_stream-type-btn-icon__2p9-P","obs-logo":"GoLive_obs-logo__1p3Hh"}},867:function(e,t,a){"use strict";a.r(t);var c=a(2),n=a.n(c),r=a(5),s=a(12),o=a(3),i=a(42),l=a(80),d=a.n(l),u=(a(819),a(28)),b=a(171),j=a(13),p=a.p+"static/media/obs-2.7c61e78e.svg",f=a(689),v=a(23),m=a(565),h=a(17),O=a(585),x=a(563),g=a(597),k=a(562),S=a(820),y=a.n(S),C=a(568),N=a(4);t.default=function(){var e=Object(i.b)(),t=Object(v.g)(),a=h.useSelector((function(e){return e.content.seedProviderPub})),c=h.useSelector((function(e){return e.content.seedInfo})),l=c.seedUrl,S=c.seedToken,w=h.useSelector((function(e){return e.content.streamLiveToken})),I=h.useSelector((function(e){return e.content.streamUserToken})),T=h.useSelector((function(e){return e.content.availableTokens})),P=h.useSelector((function(e){return e.content.streamBroadcasterUrl})),U=h.useSelector((function(e){return e.content.streamContentId})),L=h.useSelector((function(e){return e.content.streamPostId})),_=(h.useSelector((function(e){return e.content.streamUrl})),h.useSelector((function(e){return e.userProfiles}))),B=Object(o.useState)("obs"),D=Object(s.a)(B,2),M=D[0],R=D[1],z=Object(o.useState)(!1),F=Object(s.a)(z,2),W=F[0],G=F[1],A=Object(o.useState)(w),J=Object(s.a)(A,2),K=J[0],E=J[1],H=Object(o.useState)(I),V=Object(s.a)(H,2)[1],Y=Object(o.useState)("Look I'm streaming!"),q=Object(s.a)(Y,2),Q=q[0],X=q[1],Z=Object(o.useState)(null),$=Object(s.a)(Z,2),ee=$[0],te=$[1],ae=Object(o.useState)(""),ce=Object(s.a)(ae,2),ne=(ce[0],ce[1],Object(o.useState)(null)),re=Object(s.a)(ne,2),se=re[0],oe=re[1],ie=Object(o.useState)(!1),le=Object(s.a)(ie,2),de=le[0],ue=le[1],be=Object(o.useState)(!1),je=Object(s.a)(be,2),pe=je[0],fe=je[1],ve=Object(o.useState)(!1),me=Object(s.a)(ve,2),he=me[0],Oe=me[1],xe=Object(o.useCallback)(function(){var t=Object(r.a)(n.a.mark((function t(c,r){var o,i,d,b,p,v,m,h,O,x,g,k,y,C,N,w,I,P,U,L,_,B,D;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,G(!0),t.next=4,Object(f.a)({availableTokens:T,seedProviderPub:a,seedToken:S,seedUrl:l,serviceID:r,servicePrice:c});case 4:return o=t.sent,i=o.seedUrl,d=o.tokens,b=Object(s.a)(d,1),p=b[0],V(p),t.next=11,j.a.post("".concat(i,"/api/stream/auth"),{token:p});case 11:return v=t.sent,m=v.data,h=m.data.token,console.log(h),O="".concat(p,"?key=").concat(h),E("".concat(p,"?key=").concat(h)),x="".concat(i,"/rtmpapi/live/").concat(p,"/index.m3u8"),g=i.replace("https","rtmp"),k="".concat(g,"/live"),y="".concat(i,"/rtmpapi/api/streams/live/").concat(p),C=[],""!==Q&&C.push({type:"text/paragraph",text:Q}),C.push({type:"stream/embedded",width:0,height:0,magnetURI:x,isPreview:!1,isPrivate:!1,userToken:p,liveStatus:"waiting",statusUrl:y}),t.next=26,j.a.post("/api/gun/wall",{tags:[],title:"Post",contentItems:C});case 26:if(200!==(N=t.sent).status){t.next=39;break}return w=N.data,I=Object(s.a)(w,2),P=I[0],U=I[1],console.log(U.contentItems),L=Object.entries(U.contentItems).find((function(e){var t=Object(s.a)(e,2);t[0];return t[1].magnetURI===x})),_=Object(s.a)(L,1),B=_[0],Object(u.d)({seedToken:p,liveToken:O,streamUrl:x,streamPostId:P,streamContentId:B,streamStatusUrl:y,streamBroadcasterUrl:k})(e),t.next=35,j.a.post("/api/listenStream",{postId:P,contentId:B,statusUrl:"".concat(i,"/rtmpapi/api/streams/live/").concat(p)});case 35:console.log("post created successfully"),G(!1),t.next=41;break;case 39:te("invalid response status"),G(!1);case 41:t.next=48;break;case 43:t.prev=43,t.t0=t.catch(0),console.log(t.t0),te(null!==(D=null===t.t0||void 0===t.t0?void 0:t.t0.errorMessage)&&void 0!==D?D:null===t.t0||void 0===t.t0?void 0:t.t0.message),G(!1);case 48:case"end":return t.stop()}}),t,null,[[0,43]])})));return function(e,a){return t.apply(this,arguments)}}(),[T,a,S,l,e,Q]),ge=Object(o.useCallback)((function(){oe(null)}),[oe]),ke=Object(o.useCallback)((function(){var e=se.servicePrice,t=se.serviceID;xe(e,t),oe(null)}),[se,xe,oe]),Se=Object(o.useCallback)(function(){var e=Object(r.a)(n.a.mark((function e(t){var c,r,s,o,i,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!de){e.next=3;break}return e.abrupt("return");case 3:ue(!0),t.preventDefault(),c=!1,e.t0=n.a.keys(T);case 7:if((e.t1=e.t0()).done){e.next=16;break}if(r=e.t1.value,!Object.prototype.hasOwnProperty.call(T,r)){e.next=14;break}if(!T[r][0]){e.next=14;break}return c=!0,e.abrupt("break",16);case 14:e.next=7;break;case 16:if(s="",_[a]&&(s=_[a].SeedServiceProvided),!(c||l&&S)){e.next=22;break}xe(),e.next=33;break;case 22:if(!s||!a){e.next=32;break}return e.next=25,j.a.get("/api/gun/otheruser/".concat(a,"/load/offeredServices>").concat(s));case 25:o=e.sent,i=o.data,d=i.data.servicePrice,console.log(i),oe({servicePrice:d,serviceID:s}),e.next=33;break;case 32:te("No way found to publish content");case 33:e.next=38;break;case 35:e.prev=35,e.t2=e.catch(0),te(e.t2.message);case 38:return e.prev=38,ue(!1),e.finish(38);case 41:case"end":return e.stop()}}),e,null,[[0,35,38,41]])})));return function(t){return e.apply(this,arguments)}}(),[de,_,a,l,S,T,xe]),ye=Object(o.useCallback)((function(){navigator.clipboard.writeText(K),Oe(!0)}),[K,Oe]),Ce=Object(o.useCallback)((function(){navigator.clipboard.writeText(P),fe(!0)}),[P,fe]),Ne=Object(o.useCallback)((function(e){var t=e.target,a=t.value;switch(t.name){case"paragraph":return void X(a);case"source":return void R(a);default:return}}),[X,R]),we=Object(o.useCallback)((function(){j.a.post("/api/stopStream",{postId:L,contentId:U,endUrl:"https://stream.shock.network/api/stream/end",urlForMagnet:"https://stream.shock.network/api/stream/torrent/".concat(I),obsToken:w}),Object(u.i)()(e),console.info(I),t.push("/profile")}),[e,u.i]),Ie=d()(x.i,x.d,x.c,y.a["stream-type-btn"]);return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(O.a,{pageTitle:"GO LIVE",scrolls:!0,"data-v-c4af1635":"",children:[Object(N.jsxs)("div",{className:d()(x.z,x.D),"data-v-c4af1635":"",children:[Object(N.jsxs)("div",{className:Ie,onClick:R.bind(null,"camera"),"data-v-c4af1635":"",children:[Object(N.jsx)("i",{className:d()(y.a["stream-type-btn-icon"],"fas","fa-camera"),"data-v-c4af1635":""}),Object(N.jsx)(k.a,{amt:16,"data-v-c4af1635":""}),Object(N.jsx)(g.a,{color:"camera"===M?"#4285b9":"white",length:36,type:"horizontal",width:2,"data-v-c4af1635":""})]}),Object(N.jsxs)("div",{className:Ie,onClick:R.bind(null,"obs"),"data-v-c4af1635":"",children:[Object(N.jsx)("img",{alt:"",className:y.a["obs-logo"],src:p,"data-v-c4af1635":""}),Object(N.jsx)(k.a,{amt:16,"data-v-c4af1635":""}),Object(N.jsx)(g.a,{color:"obs"===M?"#4285b9":"white",length:36,type:"horizontal",width:2,"data-v-c4af1635":""})]})]}),Object(N.jsx)("div",{className:x.l,"data-v-c4af1635":"",children:ee?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("p",{"data-v-c4af1635":"",children:" An error ocurred: "}),Object(N.jsx)("br",{"data-v-c4af1635":""}),Object(N.jsx)("p",{className:"error-container","data-v-c4af1635":"",children:ee}),Object(N.jsx)("button",{className:"shock-form-button",onClick:te.bind(null,null),"data-v-c4af1635":"",children:"Dismiss"})]}):K?Object(N.jsxs)(N.Fragment,{children:["obs"===M&&Object(N.jsx)("p",{className:"m-b-1","data-v-c4af1635":"",children:"You are ready to go! setup the stream with OBS and watch it from your profile"}),Object(N.jsx)("p",{"data-v-c4af1635":"",children:"Broadcaster:"}),Object(N.jsxs)("div",{className:"d-flex flex-align-center","data-v-c4af1635":"",children:[Object(N.jsx)(C.a,{name:"Streamer Url",value:P,disabled:!0,"data-v-c4af1635":""}),Object(N.jsx)("i",{className:pe?"fas fa-check fa-lg m-1":"far fa-copy fa-lg m-1",onClick:Ce,"data-v-c4af1635":""})]}),Object(N.jsx)("p",{"data-v-c4af1635":"",children:"Stream Key:"}),Object(N.jsxs)("div",{className:"d-flex flex-align-center","data-v-c4af1635":"",children:[Object(N.jsx)(C.a,{name:"Stream Key",value:K,disabled:!0,"data-v-c4af1635":""}),Object(N.jsx)("i",{className:he?"fas fa-check fa-lg m-1":"far fa-copy fa-lg m-1",onClick:ye,"data-v-c4af1635":""})]}),Object(N.jsx)("div",{className:"flex-center","data-v-c4af1635":"",children:Object(N.jsx)("button",{onClick:we,className:"shock-form-button-confirm","data-v-c4af1635":"",children:"STOP"})})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("input",{className:"input-field",type:"text",name:"paragraph",id:"paragraph",value:Q,onChange:Ne,"data-v-c4af1635":""}),Object(N.jsx)("button",{onClick:Se,className:d()(x.D,"shock-form-button-confirm"),disabled:"camera"===M||de,"data-v-c4af1635":"",children:de?"...":"START NOW"})]})})]}),se&&Object(N.jsxs)(m.a,{modalOpen:se&&!W,toggleModal:ge,contentStyle:{padding:"1rem"},"data-v-c4af1635":"",children:[Object(N.jsxs)("p",{"data-v-c4af1635":"",children:["The service from the default service provider will cost:"," ",Object(N.jsxs)("strong",{"data-v-c4af1635":"",children:[se.servicePrice," sats"]})]}),Object(N.jsxs)("div",{className:x.z,"data-v-c4af1635":"",children:[Object(N.jsx)("button",{className:"shock-form-button m-1",onClick:ge,"data-v-c4af1635":"",children:"Cancel"}),Object(N.jsx)("button",{className:"shock-form-button-confirm m-1",onClick:ke,"data-v-c4af1635":"",children:"Confirm"})]})]}),W?Object(N.jsx)(b.a,{overlay:!0,fullScreen:!0,text:"Creating stream...","data-v-c4af1635":""}):null]})}}}]);
//# sourceMappingURL=30.1f7afae4.chunk.js.map