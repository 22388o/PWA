(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[31],{588:function(e,t,a){},701:function(e,t,a){"use strict";a.r(t);var c=a(2),n=a.n(c),s=a(6),r=a(16),i=a(3),o=a(22),d=a(14),u=a(561),l=a(444),f=a(559),b=a(466),p=a(477),v=a(145),j=(a(588),a(7));t.default=function(){var e=Object(o.h)(),t=Object(o.g)(),a=Object(i.useState)(0),c=Object(r.a)(a,2),m=c[0],O=c[1],x=Object(i.useState)(""),k=Object(r.a)(x,2),y=k[0],h=k[1],g=Object(i.useState)("sats"),w=Object(r.a)(g,2),C=w[0],q=w[1],S=Object(i.useState)(),N=Object(r.a)(S,2),R=N[0],P=N[1],E=Object(i.useState)(""),D=Object(r.a)(E,2),J=D[0],L=D[1],M=Object(i.useState)(!1),A=Object(r.a)(M,2),B=(A[0],A[1]),I=Object(i.useState)(!1),Q=Object(r.a)(I,2),T=Q[0],_=Q[1],z=Object(i.useCallback)((function(e){"amount"===e.target.name&&O(e.target.value),"description"===e.target.name&&h(e.target.value),"unit"===e.target.name&&q(e.target.value)}),[]),F=Object(i.useCallback)(function(){var e=Object(s.a)(n.a.mark((function e(t){var a,c,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("selectContact:",t),B(!0),P(t),!t||"invoice"!==t.type){e.next=12;break}return e.next=6,d.a.post("/api/lnd/decodePayReq",{payReq:t.paymentRequest});case 6:a=e.sent,c=a.data,s=c.decodedRequest,O(s.num_satoshis),q("sats"),h(s.description);case 12:B(!1);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);Object(i.useEffect)((function(){var t=e.state;if(t&&t.data&&t.data.type){var a=t.data;switch(a.type){case"btc":F({type:"btc",address:a.address}),a.amount&&O(a.amount);break;case"ln":F({type:"invoice",paymentRequest:a.request});break;case"keysend":F({type:"keysend",dest:a.address})}e.state={}}}),[e,F,O]);var G=Object(i.useCallback)(Object(s.a)(n.a.mark((function e(){var t,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R){e.next=6;break}return e.next=3,d.a.post("/api/lnd/sendcoins",{addr:R.address,amount:m});case 3:t=e.sent,a=t.data,console.log(a);case 6:case"end":return e.stop()}}),e)}))),[m,R]),H=Object(i.useCallback)(Object(s.a)(n.a.mark((function e(){var t,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R){e.next=6;break}return e.next=3,d.a.post("/api/lnd/sendpayment",{dest:R.dest,payreq:R.paymentRequest,amt:R.paymentRequest?"0":m,feeLimit:.006*m+10,keysend:"keysend"===R.type});case 3:t=e.sent,a=t.data,console.log(a);case 6:case"end":return e.stop()}}),e)}))),[m,R]),K=Object(i.useCallback)(Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R){e.next=5;break}return e.next=3,d.a.post("/api/gun/sendpayment",{recipientPub:R.pk,amount:parseInt(m),feeLimit:.006*m+10,memo:y});case 3:t=e.sent,t.data;case 5:case"end":return e.stop()}}),e)}))),[m,R,y]),U=Object(i.useCallback)(Object(s.a)(n.a.mark((function e(){var a,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,L(""),_(!0),"btc"!==(null===R||void 0===R?void 0:R.type)){e.next=6;break}return e.next=6,G();case 6:if(!["invoice","keysend"].includes(null===R||void 0===R?void 0:R.type)){e.next=9;break}return e.next=9,H();case 9:if("contact"!==(null===R||void 0===R?void 0:R.type)){e.next=12;break}return e.next=12,K();case 12:t.push("/overview"),_(!1),e.next=22;break;case 16:throw e.prev=16,e.t0=e.catch(0),console.error(e.t0),L(null!==(a=null===(c=e.t0.response)||void 0===c?void 0:c.data.errorMessage)&&void 0!==a?a:e.t0.message),_(!1),e.t0;case 22:case"end":return e.stop()}}),e,null,[[0,16]])}))),[R,t,G,K,H]);return Object(j.jsxs)(b.a,{containerClassName:"send-page",title:"SEND","data-v-1fffc4c0":"",children:[Object(j.jsxs)("div",{className:"send-form-container","data-v-1fffc4c0":"",children:[T?Object(j.jsx)(v.a,{fullScreen:!0,overlay:!0,text:"Processing Payment...","data-v-1fffc4c0":""}):null,J?Object(j.jsx)("p",{className:"form-error","data-v-1fffc4c0":"",children:J}):null,R?null:Object(j.jsxs)("div",{className:"scan-qr-btn","data-v-1fffc4c0":"",children:[Object(j.jsx)("i",{className:"scan-qr-icon icon icon-solid-scan","data-v-1fffc4c0":""}),Object(j.jsx)("p",{className:"scan-qr-text","data-v-1fffc4c0":"",children:"Scan QR"})]}),R?Object(j.jsx)(p.a,{selected:!0,contact:R,selectContact:F,"data-v-1fffc4c0":""}):Object(j.jsx)(f.a,{selectContact:F,features:["btc","keysend","contact","invoice"],"data-v-1fffc4c0":""}),Object(j.jsxs)("div",{className:"inputs-group","data-v-1fffc4c0":"",children:[Object(j.jsx)(l.a,{name:"amount",label:"Enter Amount",onChange:z,value:m,disabled:"invoice"===(null===R||void 0===R?void 0:R.type),inputMode:"decimal","data-v-1fffc4c0":""}),Object(j.jsxs)("select",{name:"unit",className:"unit-dropdown",onChange:z,value:C,disabled:"invoice"===(null===R||void 0===R?void 0:R.type),"data-v-1fffc4c0":"",children:[Object(j.jsx)("option",{value:"sats","data-v-1fffc4c0":"",children:"sats"}),Object(j.jsx)("option",{value:"btc","data-v-1fffc4c0":"",children:"BTC"})]})]}),Object(j.jsx)(l.a,{name:"description",label:"Description",element:"textarea",onChange:z,type:"textarea",value:y,disabled:"invoice"===(null===R||void 0===R?void 0:R.type),"data-v-1fffc4c0":""})]}),Object(j.jsx)(u.a,{disabled:!R,onSuccess:U,"data-v-1fffc4c0":""})]})}}}]);
//# sourceMappingURL=31.1fdd4a07.chunk.js.map