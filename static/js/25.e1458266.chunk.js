(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[25],{449:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(3),c=n(74),s=n.n(c),r=n(51),i=(n(450),n(4)),o=73,l={minHeight:o};t.b=function(e){var t=e.pageTitle,n=e.drawerVisible,c=void 0!==n&&n,o=e.onHeight,u=void 0===o?r.a:o,b=Object(a.useCallback)((function(){window.history.back()}),[]),d=Object(a.useCallback)((function(e){if(e)try{u(e.getBoundingClientRect().height)}catch(t){console.log("Error inside onHeight mechanism in DialogNav:"),console.log(t)}}),[u]);return Object(i.jsxs)("div",{className:"dialog-nav-container",ref:d,style:l,"data-v-7b871f0d":"",children:[Object(i.jsx)("div",{className:"dialog-nav-back",onClick:b,"data-v-7b871f0d":"",children:Object(i.jsx)("i",{className:"icon icon-thin-back","data-v-7b871f0d":""})}),Object(i.jsx)("p",{className:"dialog-nav-title","data-v-7b871f0d":"",children:t}),Object(i.jsxs)("div",{className:s()({"dialog-nav-menu-btn":!0,"dialog-nav-hidden":!c}),"data-v-7b871f0d":"",children:[Object(i.jsx)("div",{className:"dialog-nav-menu-dash","data-v-7b871f0d":""}),Object(i.jsx)("div",{className:"dialog-nav-menu-dash","data-v-7b871f0d":""}),Object(i.jsx)("div",{className:"dialog-nav-menu-dash","data-v-7b871f0d":""})]})]})}},450:function(e,t,n){},461:function(e,t,n){},466:function(e,t,n){"use strict";var a=n(472),c=function(){return!navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i)},s=(n(461),n(4)),r={wizard:{title:"SCAN A",target:"QR CODE",description:"Point your camera at a ShockWizard QR Code"},invoice:{title:"SCAN AN",target:"INVOICE",description:"Point your camera at an LND Invoice"}};t.a=function(e){var t=e.mode,n=void 0===t?"wizard":t,i=e.onScan,o=e.onError,l=e.onClose,u=r[n];c();return Object(s.jsxs)("div",{className:"qr-code-scanner-container","data-v-7cb34fbe":"",children:[Object(s.jsx)("div",{className:"qr-scanner-top-section","data-v-7cb34fbe":"",children:Object(s.jsx)("i",{className:"fas fa-times",onClick:l,"data-v-7cb34fbe":""})}),Object(s.jsx)(a.a,{constraints:{video:{}},onScan:i,onError:o,"data-v-7cb34fbe":""}),Object(s.jsx)("div",{className:"qr-scanner-target","data-v-7cb34fbe":""}),Object(s.jsxs)("div",{className:"qr-scanner-bottom-section","data-v-7cb34fbe":"",children:[Object(s.jsxs)("p",{className:"qr-scanner-bottom-title","data-v-7cb34fbe":"",children:[u.title," ",Object(s.jsx)("span",{className:"qr-scanner-bottom-title-highlight","data-v-7cb34fbe":"",children:u.target})]}),Object(s.jsx)("p",{className:"qr-scanner-bottom-description","data-v-7cb34fbe":"",children:u.description}),Object(s.jsx)("div",{className:"qr-scanner-btn",onClick:l,"data-v-7cb34fbe":"",children:"Cancel Scan"})]})]})}},726:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),s=n(6),r=n(12),i=n(3),o=n(22),l=n(683),u=n(449),b=n(146),d=n(466),j=/^(bc(1|r)|[123]|m|n|((t|x)pub)|(tb1))[a-zA-HJ-NP-Z0-9]{25,90}$/,h=/^(ln(tb|bc|bcrt))[0-9][a-z0-9]{180,7089}$/,O=/^[a-f0-9]{66}$/,p=function(e){var t=function(e){var t=e;if(e.includes("bitcoin:")){var n=e.split("bitcoin:");t=Object(r.a)(n,2)[1]}else if(e.includes("lightning:")){var a=e.split("lightning:");t=Object(r.a)(a,2)[1]}else if(e.includes("LIGHTNING:")){var c=e.split("LIGHTNING:");t=Object(r.a)(c,2)[1]}return t}(e),n=function(e){if(e.includes("?amount=")){var t=e.split("?amount="),n=Math.floor(1e8*Number(t[1]));return{address:t[0],amount:n.toString()}}return{address:e,amount:void 0}}(t),a=n.address,c=n.amount;if(function(e){return j.test(e)}(a))return{type:"btc",address:a,amount:c};if(function(e){return h.test(e.toLowerCase())}(t))return{type:"ln",request:t};if(function(e){return O.test(e)}(t))return{type:"keysend",address:t};if(function(e){return e.startsWith("$$__SHOCKWALLET__USER__")}(t))return{type:"pk",pk:t};var s=function(e){var t=/^(http.*[&?]lightning=)?((lnurl)([0-9]{1,}[a-z0-9]+){1})/.exec(e.toLowerCase());return t?t[2]:null}(t);return s?{type:"lnurl",lnurl:s.toUpperCase()}:{type:"unknown"}},v=n(41),x=n(51),f=n(29),m=n(4);t.default=function(){var e=Object(o.g)(),t=Object(v.b)(),n=(Object(v.c)((function(e){return e.node.publicKey})),Object(i.useState)(!1)),a=Object(r.a)(n,2),j=a[0],h=a[1],O=Object(i.useState)(!0),g=Object(r.a)(O,2),k=g[0],C=g[1],w=Object(i.useState)(0),N=Object(r.a)(w,2),y=N[0],q=N[1],S=Object(i.useState)(0),R=Object(r.a)(S,2),L=R[0],E=R[1],A=Object(i.useState)(!1),_=Object(r.a)(A,2),U=_[0],T=_[1],K=Object(i.useState)(""),P=Object(r.a)(K,2),H=P[0],I=P[1],z=Object(i.useState)(null),D=Object(r.a)(z,2),M=D[0],W=D[1],$=Object(i.useState)(!0),B=Object(r.a)($,2),G=B[0],J=B[1],V=Object(i.useState)(null),Q=Object(r.a)(V,2),F=(Q[0],Q[1]),Z=Object(i.useState)(null),X=Object(r.a)(Z,2),Y=(X[0],X[1]),ee=Object(i.useCallback)((function(){e.push("/overview")}),[e]),te=Object(i.useCallback)((function(e){var t=e.target,n=t.value,a=t.name,c=t.checked;switch(a){case"privateChannel":return void C(c);case"payAmount":return void q(n);case"withdrawAmount":return void E(n);case"hasMemo":return void T(c);case"memo":case"memo":return void I(n);default:return}}),[C,q,E,T,I]),ne=Object(i.useCallback)(function(){var e=Object(s.a)(c.a.mark((function e(t){var n,a,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.prev=1,e.next=4,Object(l.getParams)(t);case 4:(n=e.sent).tag||(a=n,h(!1),Y(a.reason)),s=n,e.t0=s.tag,e.next="channelRequest"===e.t0?10:"withdrawRequest"===e.t0?12:"hostedChannelRequest"===e.t0?14:"login"===e.t0?16:"payRequest"===e.t0?18:20;break;case 10:return console.log("this url is a channel request"),e.abrupt("break",21);case 12:return console.log("this url is a withdrawal request"),e.abrupt("break",21);case 14:return console.log("this url is a hosted channel request"),e.abrupt("break",21);case 16:return console.log("this url is a login "),e.abrupt("break",21);case 18:return console.log("this url is a pay request"),e.abrupt("break",21);case 20:console.log("unknown tag");case 21:W(s),h(!1),e.next=30;break;case 25:e.prev=25,e.t1=e.catch(1),console.log(e.t1),h(!1),Y(e.t1.message||e.t1);case 30:case"end":return e.stop()}}),e,null,[[1,25]])})));return function(t){return e.apply(this,arguments)}}(),[]),ae=Object(i.useCallback)((function(t){console.log("decoding!");var n=p(t);switch(n.type){case"btc":case"ln":case"keysend":return void e.push("/send",{data:n});case"pk":return void e.push("/otherUser/".concat(n.pk));case"lnurl":return void ne(n.lnurl);case"unknown":Y("cant decode"+JSON.stringify(n))}}),[e,Y,ne]),ce=Object(i.useCallback)((function(){J(!1),e.push("/overview")}),[J]),se=Object(i.useCallback)((function(e){console.log(e),e&&e.text&&(ae(e.text),J(!1))}),[ae,J]),re=Object(i.useCallback)(Object(s.a)(c.a.mark((function e(){var t,n,a,s,r,i,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=M.callback,n=M.k1,e.next=4,x.b.post("/api/lnd/addinvoice",{value:L,memo:H,expiry:1800});case 4:return a=e.sent,s=a.data,r="".concat(t,"?k1=").concat(n,"&pr=").concat(s.payment_request),console.log(r),e.next=10,fetch(r);case 10:return i=e.sent,e.next=13,i.json();case 13:"OK"===(o=e.sent).status?F("Withdraw request sent correctly"):Y(o.reason),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),Y(e.t0.message||e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])}))),[e,M,L,H,F,Y]),ie=Object(i.useCallback)(Object(s.a)(c.a.mark((function e(){var n,a,s,i,o,l,u,b,d,j,h,O,p,v,m,g,C;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=M.uri,a=M.callback,s=M.k1,i=s,"gun"===s&&M.shockPubKey&&(i="$$__SHOCKWALLET__USER__".concat(M.shockPubKey)),o=function(e){return"".concat(e.pub_key,"@").concat(e.address)===n},e.next=7,Object(f.f)()(t);case 7:if(l=e.sent,l.peers.find(o)){e.next=13;break}return u=n.plit("@"),b=Object(r.a)(u,2),d=b[0],j=b[1],e.next=13,Object(f.c)({publicKey:d,host:j});case 13:return e.next=15,x.b.get("/healthz");case 15:return h=e.sent,O=h.data,p=O.identity_pubkey,v=k?1:0,m="".concat(a,"?k1=").concat(i,"&remoteid=").concat(p,"&private=").concat(v),e.next=22,fetch(m);case 22:return g=e.sent,e.next=25,g.json();case 25:"OK"===(C=e.sent).status?F("Channel request sent correctly"):Y(C.reason),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(0),Y(e.t0.message||e.t0);case 32:case"end":return e.stop()}}),e,null,[[0,29]])}))),[e,M,Y]),oe=Object(i.useCallback)(Object(s.a)(c.a.mark((function t(){var n,a,s,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=M.callback,a="".concat(n,"?amount=").concat(1e3*y),console.log(a),t.next=6,fetch(a);case 6:return s=t.sent,t.next=9,s.json();case 9:if("ERROR"!==(r=t.sent).status){t.next=13;break}return Y(r.reason),t.abrupt("return");case 13:e.push("/send",{data:{type:"ln",request:r.pr}}),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),Y(t.t0.message||t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])}))),[e,M,y,Y]),le=Object(i.useMemo)((function(){if(null===M)return null;switch(M.tag){case"channelRequest":return console.log("this url is a channel request"),Object(m.jsxs)("div",{children:[Object(m.jsx)("h2",{children:"LNURL Channel Request"}),Object(m.jsxs)("p",{children:["Requesting channel from:",M.uri||"ADDRESS NOT FOUND"]}),Object(m.jsx)("input",{type:"checkbox",name:"privateChannel",checked:k,onChange:te}),Object(m.jsx)("button",{onClick:ie,children:"CONNECT"})]});case"withdrawRequest":return console.log("this url is a withdrawal request"),Object(m.jsxs)("div",{children:[Object(m.jsx)("h2",{children:"LNURL Channel Request"}),Object(m.jsxs)("p",{children:[Object(m.jsx)("strong",{children:"Max"}),"Withdrawable:"," ",Object(m.jsx)("strong",{children:M.maxWithdrawable/1e3})," Satoshi"]}),Object(m.jsx)("input",{type:"number",value:L,name:"withdrawAmount",onChange:te}),Object(m.jsx)("input",{type:"checkbox",name:"hasMemo",checked:U,onChange:te}),U&&Object(m.jsx)("input",{type:"text",value:H,name:"memo",placeholder:"memo",onChange:te}),Object(m.jsx)("button",{onClick:re,children:"RECEIVE"})]});case"hostedChannelRequest":return console.log("this url is a hosted channel request"),Object(m.jsxs)("div",{children:[Object(m.jsx)("h2",{children:"LNURL Hosted Channel Request"}),Object(m.jsx)("p",{children:"This Request is not supported"}),Object(m.jsx)("button",{onClick:ee,children:"BACK"})]});case"login":return console.log("this url is a login "),Object(m.jsxs)("div",{children:[Object(m.jsx)("h2",{children:"LNURL Auth Request"}),Object(m.jsx)("p",{children:"This Request is not supported"}),Object(m.jsx)("button",{onClick:ee,children:"BACK"})]});case"payRequest":return console.log("this url is a pay request"),Object(m.jsxs)("div",{children:[Object(m.jsx)("h2",{children:"LNURL Pay Request"}),Object(m.jsxs)("p",{children:[Object(m.jsx)("strong",{children:"Min"}),"Sendable:"," ",Object(m.jsx)("strong",{children:M.minSendable/1e3})," Satoshi"]}),Object(m.jsxs)("p",{children:[Object(m.jsx)("strong",{children:"Max"}),"Sendable:"," ",Object(m.jsx)("strong",{children:M.maxSendable/1e3})," Satoshi"]}),Object(m.jsx)("input",{type:"number",value:y,name:"payAmount",onChange:te}),Object(m.jsx)("button",{onClick:oe,children:"SEND"})]});default:return console.log("unknown tag"),Object(m.jsxs)("div",{children:[Object(m.jsx)("h2",{children:"LNURL Unknown Request"}),Object(m.jsx)("button",{onClick:ee,children:"BACK"})]})}}),[M,k,L,U,H,y,te,ee]),ue=Object(i.useCallback)((function(e){Y(e.message||e)}),[Y]);return G?Object(m.jsx)("div",{children:Object(m.jsx)(d.a,{mode:"invoice",onClose:ce,onError:ue,onScan:se})}):Object(m.jsxs)("div",{className:"publish-content-form-container m-1",children:[j?Object(m.jsx)(b.a,{overlay:!0,fullScreen:!0,text:""}):null,Object(m.jsx)(u.b,{drawerVisible:!1,pageTitle:"PUBLISH CONTENT"}),Object(m.jsx)("div",{children:le})]})}}}]);
//# sourceMappingURL=25.e1458266.chunk.js.map