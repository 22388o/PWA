{"version":3,"sources":["common/MainNav/index.js","pages/MoonPay/index.tsx"],"names":["MainNav","pageTitle","absolute","solid","enableBackButton","onHeight","Utils","dispatch","useDispatch","goBack","useCallback","window","history","back","open","openDrawer","gunPublicKey","useSelector","node","publicKey","divRefCb","el","getBoundingClientRect","height","e","console","log","className","classNames","ref","onClick","MoonPay","useState","src","setSrc","useEffect","Http","post","type","then","res","data","originalUrl","address","fetch","method","headers","body","JSON","stringify","json","urlWithSignature","catch","title","width"],"mappings":"qHAAA,qFAyEeA,IA3DC,SAAC,GAMV,IALLC,EAKI,EALJA,UAKI,IAJJC,gBAII,aAHJC,aAGI,aAFJC,wBAEI,aADJC,gBACI,MADOC,IACP,EACEC,EAAWC,cACXC,EAASC,uBAAY,WACzBC,OAAOC,QAAQC,SACd,IAEGC,EAAOJ,uBAAY,WACvBH,EAASQ,iBACR,CAACR,IAEES,EAAeC,uBAAY,qBAAGC,KAAgBC,aAG9CC,EAAWV,uBACf,SAAAW,GAEE,GAAKA,EACL,IACEhB,EAASgB,EAAGC,wBAAwBC,QACpC,MAAOC,GACPC,QAAQC,IAAR,+CACAD,QAAQC,IAAIF,MAGhB,CAACnB,IAGH,OACE,sBACEsB,UAAWC,IAAW,CACpB,sBAAsB,EACtB,oBAAqB1B,EACrB,iBAAkBC,IAEpB0B,IAAKT,EANP,+BAQGhB,EACC,qBAAKuB,UAAU,gBAAgBG,QAASrB,EAAxC,8BACE,mBAAGkB,UAAU,sBAAb,yBAGF,cAAC,IAAD,CAAaJ,OAAQ,GAAIJ,UAAWH,EAApC,uBAEF,mBAAGW,UAAU,8BAAb,8BAA4C1B,IAC5C,sBAAK0B,UAAU,oBAAoBG,QAAShB,EAA5C,+BACE,qBAAKa,UAAU,qBAAf,uBACA,qBAAKA,UAAU,qBAAf,uBACA,qBAAKA,UAAU,qBAAf,+B,wICjBOI,UA3CC,WAAO,IAAD,EACEC,mBAAS,IADX,mBACbC,EADa,KACRC,EADQ,KA8BpB,OA3BAC,qBAAU,WACRC,IAAKC,KAAK,sBAAuB,CAC/BC,KAAM,UAELC,MAAK,SAAAC,GAAQ,IACJC,EAASD,EAATC,KACFC,EAAW,iDAXP,2CAWO,2CAAyFD,EAAKE,SAC/G,OAAOC,MAbW,uCAac,CAC9BC,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CAAEP,qBAG1BH,MAAK,SAAAC,GAAG,OAAIA,EAAIU,UAChBX,MAAK,SAAAW,GACAA,EAAKC,mBACPjB,EAAOgB,EAAKC,kBACZ1B,QAAQC,IAAI,yBAA2BwB,EAAKC,sBAG/CC,OAAM,SAAA5B,GACLC,QAAQC,IAAI,sCACZD,QAAQC,IAAIF,QAEf,IAED,sBAAKG,UAAU,mBAAf,+BACE,cAAC,IAAD,CAAS1B,UAAU,UAAUG,kBAAkB,EAA/C,uBACA,wBACEiD,MAAM,iBACNC,MAAM,OACN/B,OAAO,OACPU,IAAKA,EAJP","file":"static/js/34.5fc702d4.chunk.js","sourcesContent":["// @ts-check\nimport { useCallback } from \"react\";\n/**\n * @typedef {import('react').RefCallback<HTMLElement>} DivRefCallback\n */\nimport classNames from \"classnames\";\nimport \"./css/index.scoped.css\";\nimport { useDispatch } from \"react-redux\";\n\nimport * as Utils from \"../../utils\";\nimport { openDrawer } from \"../../actions/DrawerActions\";\nimport ShockAvatar from \"../ShockAvatar\";\nimport { useSelector } from \"../../store\";\n\nconst MainNav = ({\n  pageTitle,\n  absolute = false,\n  solid = false,\n  enableBackButton = false,\n  onHeight = Utils.EMPTY_FN\n}) => {\n  const dispatch = useDispatch();\n  const goBack = useCallback(() => {\n    window.history.back();\n  }, []);\n\n  const open = useCallback(() => {\n    dispatch(openDrawer());\n  }, [dispatch]);\n\n  const gunPublicKey = useSelector(({ node }) => node.publicKey);\n\n  /** @type {DivRefCallback} */\n  const divRefCb = useCallback(\n    el => {\n      // https://www.pluralsight.com/tech-blog/getting-size-and-position-of-an-element-in-react/\n      if (!el) return;\n      try {\n        onHeight(el.getBoundingClientRect().height);\n      } catch (e) {\n        console.log(`Error inside onHeight mechanism in MainNav:`);\n        console.log(e);\n      }\n    },\n    [onHeight]\n  );\n\n  return (\n    <div\n      className={classNames({\n        \"main-nav-container\": true,\n        \"main-nav-absolute\": absolute,\n        \"main-nav-solid\": solid\n      })}\n      ref={divRefCb}\n    >\n      {enableBackButton ? (\n        <div className=\"main-nav-back\" onClick={goBack}>\n          <i className=\"icon icon-thin-back\"></i>\n        </div>\n      ) : (\n        <ShockAvatar height={40} publicKey={gunPublicKey} />\n      )}\n      <p className=\"main-nav-title unselectable\">{pageTitle}</p>\n      <div className=\"main-nav-menu-btn\" onClick={open}>\n        <div className=\"main-nav-menu-dash\" />\n        <div className=\"main-nav-menu-dash\" />\n        <div className=\"main-nav-menu-dash\" />\n      </div>\n    </div>\n  );\n};\n\nexport default MainNav;\n","import { useEffect, useState } from \"react\";\nimport MainNav from \"../../common/MainNav\";\nimport \"./css/index.scoped.css\";\nimport Http from \"../../utils/Http\";\nconst signingServiceUrl = \"https://moon-sign.shock.network/sign\";\nconst apiPubKey = \"pk_test_C8jSPDtsKQqXwP7nkScpqZI5tsaOiQPH\";\n\nconst MoonPay = () => {\n  const [src, setSrc] = useState(\"\");\n\n  useEffect(() => {\n    Http.post(\"/api/lnd/newaddress\", {\n      type: \"p2wkh\"\n    })\n      .then(res => {\n        const { data } = res;\n        const originalUrl = `https://buy-staging.moonpay.io/?apiKey=${apiPubKey}&currencyCode=btc&walletAddress=${data.address}`;\n        return fetch(signingServiceUrl, {\n          method: \"post\",\n          headers: {\n            \"Content-type\": \"application/json\"\n          },\n          body: JSON.stringify({ originalUrl })\n        });\n      })\n      .then(res => res.json())\n      .then(json => {\n        if (json.urlWithSignature) {\n          setSrc(json.urlWithSignature);\n          console.log(\"MOONPAY SIGNATURE DONE\" + json.urlWithSignature);\n        }\n      })\n      .catch(e => {\n        console.log(\"Error generating MoonPay signature\");\n        console.log(e);\n      });\n  }, []);\n  return (\n    <div className=\"moonPayContainer\">\n      <MainNav pageTitle=\"MOONPAY\" enableBackButton={true} />\n      <iframe\n        title=\"moonpay-iframe\"\n        width=\"100%\"\n        height=\"100%\"\n        src={src}\n      ></iframe>\n    </div>\n  );\n};\n\nexport default MoonPay;\n"],"sourceRoot":""}