(this["webpackJsonpshocknet-pwa"]=this["webpackJsonpshocknet-pwa"]||[]).push([[21],{438:function(e,t,a){"use strict";a(3),a(449);var n=a(8);t.a=function(e){var t=e.tipCounter,a=e.tipValue,c=e.zoomed;return a>0?Object(n.jsxs)("div",{className:"ribbon-container",style:{opacity:c?0:1},children:[Object(n.jsx)("p",{className:"ribbon-title",children:"Total Tips"}),Object(n.jsxs)("p",{className:"ribbon-value",children:[t," ",1===t?"Tip":"Tips"]})]}):null}},441:function(e,t,a){"use strict";var n=a(3),c=a(77),r=a.n(c),s=(a(442),a(8));t.a=function(e){var t=e.pageTitle,a=e.drawerVisible,c=Object(n.useCallback)((function(){window.history.back()}),[]);return Object(s.jsxs)("div",{className:"dialog-nav-container",children:[Object(s.jsx)("div",{className:"dialog-nav-back",onClick:c,children:Object(s.jsx)("i",{className:"icon icon-thin-back"})}),Object(s.jsx)("p",{className:"dialog-nav-title",children:t}),Object(s.jsxs)("div",{className:r()({"dialog-nav-menu-btn":!0,"dialog-nav-hidden":!a}),children:[Object(s.jsx)("div",{className:"dialog-nav-menu-dash"}),Object(s.jsx)("div",{className:"dialog-nav-menu-dash"}),Object(s.jsx)("div",{className:"dialog-nav-menu-dash"})]})]})}},442:function(e,t,a){},449:function(e,t,a){},454:function(e,t,a){},456:function(e,t,a){"use strict";var n=a(2),c=a.n(n),r=a(6),s=a(20),i=a(3),o=a(438),l=(a(457),a(151)),u=a(18),b=a(8),d="".concat("https://webtorrent.shock.network","/rtmpapi/api/streams/live");t.a=function(e){e.id;var t=e.item,a=(e.index,e.postId,e.tipValue),n=e.tipCounter,j=e.hideRibbon,p=e.width,m=Object(i.useRef)(null),O=Object(i.useState)(!1),h=Object(s.a)(O,2),f=h[0],v=h[1],x={width:"100%"};return p&&(x.width=p),Object(i.useEffect)((function(){var e=null,a=function(){var e=Object(r.a)(c.a.mark((function e(){var a,n,r,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.magnetURI.split("/live/")[1].split("/index.m3u8"),n=Object(s.a)(a,1),r=n[0],e.next=4,u.a.get("".concat(d,"/").concat(r));case 4:if(e.sent.data.isLive){e.next=7;break}return e.abrupt("return",!1);case 7:return(i=Object(l.a)(m.current,{autoplay:!0,muted:!0,aspectRatio:"16:9"})).src({src:t.magnetURI,type:"application/x-mpegURL"}),i.play(),e.abrupt("return",!0);case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return a().then((function(t){t?v(!0):e=setInterval(Object(r.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a();case 2:if(!t.sent){t.next=7;break}return v(!0),clearInterval(e),t.abrupt("return");case 7:case"end":return t.stop()}}),t)}))),1e4)})),function(){clearInterval(e)}}),[t]),Object(b.jsx)("div",{className:"media-container w-100",children:Object(b.jsxs)("div",{className:"video-container w-100",style:{cursor:"pointer",width:"100%"},children:[!f&&Object(b.jsx)("p",{children:"The streamer has disconnected."}),Object(b.jsx)("div",{style:f?{width:"100%"}:{display:"none",width:"100%"},children:Object(b.jsx)("video",{className:"video-js vjs-default-skin",ref:m,style:x,preload:"auto",controls:!0,muted:!0,autoPlay:!0})}),!j&&Object(b.jsx)(o.a,{tipCounter:n,tipValue:a,zoomed:!1})]})})}},457:function(e,t,a){},522:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),c=a.n(n),r=a(6),s=function(){var e=Object(r.a)(c.a.mark((function e(t,a){var n,r,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Uint8Array(32),window.crypto.getRandomValues(n),r=Array.prototype.map.call(n,(function(e){return("00"+e.toString(16)).slice(-2)})).join(""),s={seed_token:a,wallet_token:r},e.next=6,fetch("".concat(t,"/api/enroll_token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});case 6:if(200===e.sent.status){e.next=9;break}throw new Error("torrentSeed service currently not available");case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},707:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a.n(n),r=a(6),s=a(20),i=a(3),o=a(45),l=a(43),u=(a(454),a(149)),b=a(18),d=a(441),j=a.p+"static/media/obs-2.7c61e78e.svg",p=a(456),m=a(522),O=a(24),h=a(8);t.default=function(){var e=Object(o.b)(),t=Object(O.g)(),a=Object(o.c)((function(e){return e.content.seedProviderPub})),n=Object(o.c)((function(e){return e.content.seedInfo})),f=n.seedUrl,v=n.seedToken,x=Object(o.c)((function(e){return e.content.streamLiveToken})),k=Object(o.c)((function(e){return e.content.streamUserToken})),g=Object(o.c)((function(e){return e.content.availableStreamTokens})),y=Object(i.useState)("obs"),w=Object(s.a)(y,2),N=w[0],S=w[1],C=Object(i.useState)(!1),T=Object(s.a)(C,2),I=T[0],U=T[1],R=Object(i.useState)(x),E=Object(s.a)(R,2),L=E[0],P=E[1],V=Object(i.useState)(k),A=Object(s.a)(V,2),B=A[0],D=A[1],G=Object(i.useState)("Look I'm streaming!"),J=Object(s.a)(G,2),K=J[0],z=J[1],F=Object(i.useState)(!0),_=Object(s.a)(F,2),q=_[0],M=(_[1],Object(i.useState)(null)),W=Object(s.a)(M,2),Y=W[0],H=W[1],Q=Object(i.useState)(""),X=Object(s.a)(Q,2),Z=X[0],$=X[1],ee=Object(i.useState)(""),te=Object(s.a)(ee,2),ae=te[0],ne=te[1],ce=Object(i.useState)(!1),re=Object(s.a)(ce,2),se=re[0],ie=re[1],oe=Object(i.useCallback)(Object(r.a)(c.a.mark((function t(){var n,r,i,o,u,d,j,p,O,h,x,k,y,w,N,S,C,T,I,R;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,U(!0),n=null,!1,r=null,t.t0=c.a.keys(g);case 6:if((t.t1=t.t0()).done){t.next=15;break}if(i=t.t1.value,!Object.prototype.hasOwnProperty.call(g,i)){t.next=13;break}if(!(o=g[i])[0]){t.next=13;break}return r={seedUrl:i,tokens:o},t.abrupt("break",15);case 13:t.next=6;break;case 15:if(!f||!v){t.next=23;break}return console.log("USING SELF SEED TOKEN"),t.next=19,Object(m.a)(f,v);case 19:u=t.sent,n={seedUrl:f,tokens:[u]},t.next=37;break;case 23:if(!se){t.next=36;break}return console.log("USING DEFAULT TOKEN PROVIDER"),t.next=27,b.a.post("/api/lnd/unifiedTrx",{type:"streamSeed",amt:100,to:a,memo:"",feeLimit:500,ackInfo:1});case 27:d=t.sent,j=d.data,200!==d.status&&(H("seed token request failed"),U(!1)),console.log(j),p=j.orderAck,n=JSON.parse(p.response),t.next=37;break;case 36:r&&(console.log("USING AVAILABLE TOKEN"),n=r,!0);case 37:return h=(O=n).tokens,x=O.seedUrl,k=Object(s.a)(h,1),y=k[0],D(y),t.next=42,b.a.post("".concat(x,"/api/stream/auth"),{token:y});case 42:return w=t.sent,N=w.data,S=N.data.token,console.log(S),C="".concat(y,"?key=").concat(S),P("".concat(y,"?key=").concat(S)),T=x.replace("https","rtmp"),$("".concat(T,"/live")),ne("".concat(x,"/rtmpapi")),Object(l.d)(y,C)(e),I=[],""!==K&&I.push({type:"text/paragraph",text:K}),I.push({type:"stream/embedded",width:0,height:0,magnetURI:"".concat(x,"/rtmpapi/live/").concat(y,"/index.m3u8"),isPreview:!1,isPrivate:!1,userToken:y}),t.next=57,b.a.post("/api/gun/wall",{tags:[],title:"Post",contentItems:I});case 57:200===t.sent.status?(console.log("post created successfully"),U(!1)):(H("invalid response status"),U(!1)),t.next=66;break;case 61:t.prev=61,t.t2=t.catch(0),console.log(t.t2),H(null!==(R=null===t.t2||void 0===t.t2?void 0:t.t2.errorMessage)&&void 0!==R?R:null===t.t2||void 0===t.t2?void 0:t.t2.message),U(!1);case 66:case"end":return t.stop()}}),t,null,[[0,61]])}))),[K,a,g,f,v,se,U,P,H,D,$,ne,l.d]),le=Object(i.useCallback)((function(){navigator.clipboard.writeText(L)}),[L]),ue=Object(i.useCallback)((function(){navigator.clipboard.writeText(Z)}),[]),be=Object(i.useCallback)((function(e){var t=e.target,a=t.value,n=t.name,c=t.checked;switch(n){case"paragraph":return void z(a);case"source":return void S(a);case"useDefault":return void ie(c);default:return}}),[z,S]),de=Object(i.useCallback)((function(){Object(l.f)()(e),t.push("/profile")}),[t]);return Object(h.jsxs)("div",{className:"h-100 m-1",children:[I?Object(h.jsx)(u.a,{overlay:!0,fullScreen:!0,text:""}):null,Object(h.jsx)(d.a,{drawerVisible:!1,pageTitle:"GO LIVE"}),q&&Object(h.jsx)("div",{children:Object(h.jsx)(p.a,{hideRibbon:!0,item:{magnetURI:"".concat(ae,"/live/").concat(B,"/index.m3u8")}})}),Object(h.jsxs)("select",{value:N,onChange:be,name:"source",id:"source",style:{backgroundColor:"rgba(0,0,0,0)",color:"white",width:"100%",border:"0",marginBottom:"1em"},children:[Object(h.jsx)("option",{value:"camera",style:{backgroundColor:"rgba(0,0,0,0)",color:"var(--main-blue)"},children:"Camera"}),Object(h.jsx)("option",{value:"obs",style:{backgroundColor:"rgba(0,0,0,0)",color:"var(--main-blue)"},children:"OBS"})]}),Object(h.jsxs)("div",{className:"flex-center m-b-1",children:["obs"===N&&Object(h.jsx)("img",{src:j,style:{width:"10em",height:"10em"},alt:""}),"camera"===N&&Object(h.jsx)("i",{className:"fas fa-camera",style:{fontSize:"10em"}})]}),L?Object(h.jsxs)("div",{children:["obs"===N&&Object(h.jsx)("p",{className:"m-b-1",children:"You are ready to go! setup the stream with OBS and watch it from your profile"}),Object(h.jsx)("p",{children:"Broadcaster:"}),Object(h.jsxs)("div",{style:{border:"1px solid var(--main-blue)",padding:"0.5rem",display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:[Object(h.jsx)("p",{children:Z.substring(0,20)+(Z.length>21?"...":"")}),Object(h.jsx)("i",{className:"far fa-copy",onClick:ue})]}),Object(h.jsx)("p",{children:"Stream Key:"}),Object(h.jsxs)("div",{style:{border:"1px solid var(--main-blue)",padding:"0.5rem",display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:[Object(h.jsx)("p",{children:L.substring(0,20)+(L.length>21?"...":"")}),Object(h.jsx)("i",{className:"far fa-copy",onClick:le})]}),Object(h.jsx)("div",{className:"flex-center",children:Object(h.jsx)("button",{onClick:de,className:"shock-form-button-confirm",children:"STOP"})})]}):Object(h.jsxs)("div",{className:"vertical-flex-center",children:[Object(h.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:"auto"},children:[Object(h.jsx)("label",{htmlFor:"useDefault",children:"Use default seed provider"}),Object(h.jsx)("input",{type:"checkbox",name:"useDefault",checked:se,onChange:be,style:{marginLeft:"0.2em"}})]}),Object(h.jsx)("input",{className:"input-field",type:"text",name:"paragraph",id:"paragraph",value:K,onChange:be}),Object(h.jsx)("button",{onClick:oe,className:"shock-form-button-confirm",children:"START NOW"})]}),Y?Object(h.jsx)("p",{className:"error-container",children:Y}):null]})}}}]);
//# sourceMappingURL=21.99d47218.chunk.js.map