{"version":3,"sources":["pages/Request/components/FormStep/index.js","pages/Request/components/InvoiceStep/index.js","pages/Request/index.js"],"names":["FormStep","onInputChange","amount","description","className","InputGroup","name","label","onChange","value","inputMode","element","InvoiceStep","unit","prevStep","dispatch","useDispatch","history","useHistory","useState","paymentRequest","setPaymentRequest","address","setAddress","QRLoading","setQRLoading","loading","setLoading","contact","setContact","setError","lightningMode","setLightningMode","addInvoice","useCallback","a","Http","post","memo","expiry","invoice","data","payment_request","response","errorMessage","generateAddress","type","selectContact","useEffect","toggleLightningMode","copyClipboard","navigator","clipboard","writeText","sendInvoice","sendMessage","publicKey","pk","message","push","Loader","overlay","text","Suggestion","selected","ContactsSearch","features","small","size","fgColor","bgColor","classNames","onClick","toUpperCase","SlidePay","wrapperStyle","padding","marginTop","slideText","onSuccess","RequestPage","setAmount","setDescription","activeStep","setActiveStep","setUnit","e","target","nextStep","MAX_STEPS","renderStep","lastStep","steps","Array","from","length","DialogPageContainer","containerClassName","contentClassName","title","map","step","key"],"mappings":"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","file":"static/js/29.d87a10ae.chunk.js","sourcesContent":["import InputGroup from \"../../../../common/InputGroup\";\n\nconst FormStep = ({ onInputChange, amount, description }) => (\n  <div className=\"request-form-container\">\n    <div className=\"inputs-group\">\n      <InputGroup\n        name=\"amount\"\n        label=\"Enter Amount\"\n        onChange={onInputChange}\n        value={amount}\n        inputMode=\"decimal\"\n      />\n      <select name=\"unit\" className=\"unit-dropdown\" onChange={onInputChange}>\n        <option value=\"sats\">Sats</option>\n        <option value=\"msats\">mSats</option>\n        <option value=\"btc\">BTC</option>\n      </select>\n    </div>\n    <InputGroup\n      name=\"description\"\n      label=\"Description\"\n      element=\"textarea\"\n      onChange={onInputChange}\n      value={description}\n    />\n  </div>\n);\n\nexport default FormStep;\n","import { useCallback, useEffect, useState } from \"react\";\nimport classNames from \"classnames\";\nimport QRCode from \"qrcode.react\";\nimport { useDispatch } from \"react-redux\";\nimport Loader from \"../../../../common/Loader\";\nimport SlidePay from \"../../../../common/SlidePay\";\nimport Http from \"../../../../utils/Http\";\nimport \"./css/index.css\";\nimport Suggestion from \"../../../../common/ContactsSearch/components/Suggestion\";\nimport ContactsSearch from \"../../../../common/ContactsSearch\";\nimport { sendMessage } from \"../../../../actions/ChatActions\";\nimport { useHistory } from \"react-router\";\n\nconst InvoiceStep = ({\n  amount = 0,\n  description = \"N/A\",\n  unit = \"\",\n  prevStep\n}) => {\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const [paymentRequest, setPaymentRequest] = useState(\"\");\n  const [address, setAddress] = useState(\"\");\n  const [QRLoading, setQRLoading] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [contact, setContact] = useState();\n  const [error, setError] = useState(\"\");\n  const [lightningMode, setLightningMode] = useState(false);\n\n  const addInvoice = useCallback(async () => {\n    try {\n      setQRLoading(true);\n      const { data: invoice } = await Http.post(\"/api/lnd/addinvoice\", {\n        value: amount,\n        memo: description,\n        expiry: 100\n      });\n\n      setPaymentRequest(invoice.payment_request);\n    } catch (err) {\n      setError(\n        err?.response?.data.errorMessage ?? \"An unknown error has occurred\"\n      );\n    } finally {\n      setQRLoading(false);\n    }\n  }, [amount, description]);\n\n  const generateAddress = useCallback(async () => {\n    try {\n      setQRLoading(true);\n      const { data } = await Http.post(\"/api/lnd/newaddress\", {\n        type: \"p2wkh\"\n      });\n\n      setAddress(data.address);\n    } catch (err) {\n      setError(\n        err?.response?.data.errorMessage ?? \"An unknown error has occurred\"\n      );\n    } finally {\n      setQRLoading(false);\n    }\n  }, []);\n\n  const selectContact = useCallback(async contact => {\n    setContact(contact);\n  }, []);\n\n  useEffect(() => {\n    if (lightningMode) {\n      addInvoice();\n      return;\n    }\n\n    generateAddress();\n  }, [addInvoice, generateAddress, lightningMode]);\n\n  const toggleLightningMode = useCallback(() => {\n    setLightningMode(!lightningMode);\n  }, [lightningMode]);\n\n  const copyClipboard = useCallback(() => {\n    if (lightningMode) {\n      navigator.clipboard.writeText(paymentRequest);\n      return;\n    }\n\n    navigator.clipboard.writeText(address);\n  }, [lightningMode, paymentRequest, address]);\n\n  const sendInvoice = useCallback(async () => {\n    if (contact) {\n      try {\n        setLoading(true);\n        await sendMessage({\n          publicKey: contact.pk,\n          message: \"$$__SHOCKWALLET__INVOICE__\" + paymentRequest\n        })(dispatch);\n        setLoading(false);\n        history.push(\"/overview\");\n      } catch (err) {\n        setError(\n          err?.response?.data.errorMessage ??\n            err?.message ??\n            \"An unknown error has occurred\"\n        );\n        setLoading(false);\n      }\n    }\n  }, [contact, paymentRequest, history]);\n\n  return (\n    <div className=\"request-form-container\">\n      {loading ? <Loader overlay text=\"Sending Invoice...\" /> : null}\n      {lightningMode ? (\n        contact ? (\n          <Suggestion\n            selected\n            contact={contact}\n            selectContact={selectContact}\n          />\n        ) : (\n          <ContactsSearch\n            selectContact={selectContact}\n            features={[\"contact\"]}\n          />\n        )\n      ) : null}\n      <div className=\"qr-code-container\">\n        <div className=\"qr-code\">\n          {QRLoading ? (\n            <Loader overlay small text=\"\" />\n          ) : (\n            <QRCode\n              value={lightningMode ? paymentRequest : address}\n              size={180}\n              fgColor={lightningMode ? \"#f5a623\" : \"#4285b9\"}\n              bgColor=\"#001220\"\n            />\n          )}\n        </div>\n        <div\n          className={classNames({\n            \"qr-code-mode\": true,\n            \"lightning-active\": lightningMode\n          })}\n          onClick={toggleLightningMode}\n        >\n          <p className=\"qr-code-switch-name qr-code-on-chain-switch\">\n            On-Chain\n          </p>\n          <div className=\"qr-code-switch\">\n            <div className=\"qr-code-switch-handle\" />\n          </div>\n          <p className=\"qr-code-switch-name qr-code-lightning-switch\">\n            Lightning\n          </p>\n        </div>\n      </div>\n      <div className=\"copy-clipboard-btn\" onClick={copyClipboard}>\n        <i className=\"fas fa-copy\"></i>\n        <p className=\"copy-clipboard-btn-text\">Copy to Clipboard</p>\n      </div>\n      <div className=\"invoice-details\">\n        <p className=\"invoice-details-change\" onClick={prevStep}>\n          Change\n        </p>\n        <div className=\"invoice-detail\">\n          <p className=\"invoice-detail-title\">Amount</p>\n          <p className=\"invoice-detail-value\">\n            {amount} {unit.toUpperCase()}\n          </p>\n        </div>\n        <div className=\"invoice-detail\">\n          <p className=\"invoice-detail-title\">Description</p>\n          <p className=\"invoice-detail-value\">{description}</p>\n        </div>\n      </div>\n      {lightningMode && contact ? (\n        <SlidePay\n          wrapperStyle={{\n            padding: 0,\n            marginTop: 23\n          }}\n          slideText=\"SLIDE TO SEND\"\n          onSuccess={sendInvoice}\n        />\n      ) : null}\n    </div>\n  );\n};\n\nexport default InvoiceStep;\n","import React, { useCallback, useState } from \"react\";\nimport classNames from \"classnames\";\nimport DialogPageContainer from \"../../common/DialogPageContainer\";\nimport \"./css/index.css\";\nimport FormStep from \"./components/FormStep\";\nimport InvoiceStep from \"./components/InvoiceStep\";\n\nconst MAX_STEPS = 2;\n\nconst RequestPage = () => {\n  const [amount, setAmount] = useState(0);\n  const [description, setDescription] = useState(\"\");\n  const [activeStep, setActiveStep] = useState(0);\n  const [unit, setUnit] = useState(\"sats\");\n\n  const onInputChange = useCallback(e => {\n    if (e.target.name === \"amount\") {\n      setAmount(e.target.value);\n    }\n\n    if (e.target.name === \"description\") {\n      setDescription(e.target.value);\n    }\n\n    if (e.target.name === \"unit\") {\n      setUnit(e.target.value);\n    }\n  }, []);\n\n  const nextStep = useCallback(() => {\n    if (activeStep < MAX_STEPS - 1) {\n      setActiveStep(activeStep + 1);\n    }\n  }, [activeStep]);\n\n  const prevStep = useCallback(() => {\n    if (activeStep > 0) {\n      setActiveStep(activeStep - 1);\n    }\n  }, [activeStep]);\n\n  const renderStep = useCallback(() => {\n    if (activeStep === 0) {\n      return (\n        <FormStep\n          amount={amount}\n          description={description}\n          onInputChange={onInputChange}\n        />\n      );\n    }\n\n    if (activeStep === 1) {\n      return (\n        <InvoiceStep\n          amount={amount}\n          description={description}\n          unit={unit}\n          prevStep={prevStep}\n        />\n      );\n    }\n  }, [activeStep, amount, description, onInputChange, prevStep, unit]);\n\n  const lastStep = activeStep === MAX_STEPS - 1;\n  const steps = Array.from({ length: MAX_STEPS });\n\n  return (\n    <DialogPageContainer\n      containerClassName=\"request-page\"\n      contentClassName=\"request-page-content\"\n      title=\"REQUEST\"\n    >\n      {renderStep()}\n      <div className=\"request-page-footer\">\n        {!lastStep ? (\n          <div className=\"request-page-controls\">\n            <div className=\"request-page-control\" onClick={nextStep}>\n              Skip\n            </div>\n            <div\n              className=\"request-page-control request-page-next\"\n              onClick={nextStep}\n            >\n              Next\n            </div>\n          </div>\n        ) : null}\n        <div className=\"request-page-indicators\">\n          {steps.map((step, key) => (\n            <div\n              className={classNames({\n                \"request-page-indicator\": true,\n                \"request-page-indicator-active\": key === activeStep\n              })}\n            ></div>\n          ))}\n        </div>\n      </div>\n    </DialogPageContainer>\n  );\n};\n\nexport default RequestPage;\n"],"sourceRoot":""}